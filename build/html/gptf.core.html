<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml" lang="en-gb">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>gptf.core package &#8212; gptf 1.0.0 documentation</title>
    
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="gptf 1.0.0 documentation" href="index.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="gptf-core-package">
<h1>gptf.core package<a class="headerlink" href="#gptf-core-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-gptf.core.densities">
<span id="gptf-core-densities-module"></span><h2>gptf.core.densities module<a class="headerlink" href="#module-gptf.core.densities" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="gptf.core.densities.bernoulli">
<code class="descclassname">gptf.core.densities.</code><code class="descname">bernoulli</code><span class="sig-paren">(</span><em>p</em>, <em>y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/densities.html#bernoulli"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.densities.bernoulli" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="gptf.core.densities.beta">
<code class="descclassname">gptf.core.densities.</code><code class="descname">beta</code><span class="sig-paren">(</span><em>alpha</em>, <em>beta</em>, <em>y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/densities.html#beta"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.densities.beta" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="gptf.core.densities.exponential">
<code class="descclassname">gptf.core.densities.</code><code class="descname">exponential</code><span class="sig-paren">(</span><em>lamb</em>, <em>y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/densities.html#exponential"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.densities.exponential" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="gptf.core.densities.gamma">
<code class="descclassname">gptf.core.densities.</code><code class="descname">gamma</code><span class="sig-paren">(</span><em>shape</em>, <em>scale</em>, <em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/densities.html#gamma"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.densities.gamma" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="gptf.core.densities.gaussian">
<code class="descclassname">gptf.core.densities.</code><code class="descname">gaussian</code><span class="sig-paren">(</span><em>x</em>, <em>mu</em>, <em>var</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/densities.html#gaussian"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.densities.gaussian" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="gptf.core.densities.laplace">
<code class="descclassname">gptf.core.densities.</code><code class="descname">laplace</code><span class="sig-paren">(</span><em>mu</em>, <em>sigma</em>, <em>y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/densities.html#laplace"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.densities.laplace" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="gptf.core.densities.lognormal">
<code class="descclassname">gptf.core.densities.</code><code class="descname">lognormal</code><span class="sig-paren">(</span><em>x</em>, <em>mu</em>, <em>var</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/densities.html#lognormal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.densities.lognormal" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="gptf.core.densities.multivariate_normal">
<code class="descclassname">gptf.core.densities.</code><code class="descname">multivariate_normal</code><span class="sig-paren">(</span><em>x</em>, <em>mu</em>, <em>L</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/densities.html#multivariate_normal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.densities.multivariate_normal" title="Permalink to this definition">¶</a></dt>
<dd><p>L is the Cholesky decomposition of the covariance.</p>
<p>x and mu are either vectors (ndim=1) or matrices. In the matrix case, we
assume independence over the <em>columns</em>: the number of rows must match the
size of L.</p>
</dd></dl>

<dl class="function">
<dt id="gptf.core.densities.poisson">
<code class="descclassname">gptf.core.densities.</code><code class="descname">poisson</code><span class="sig-paren">(</span><em>lamb</em>, <em>y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/densities.html#poisson"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.densities.poisson" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="gptf.core.densities.student_t">
<code class="descclassname">gptf.core.densities.</code><code class="descname">student_t</code><span class="sig-paren">(</span><em>x</em>, <em>mean</em>, <em>scale</em>, <em>deg_free</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/densities.html#student_t"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.densities.student_t" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-gptf.core.kernels">
<span id="gptf-core-kernels-module"></span><h2>gptf.core.kernels module<a class="headerlink" href="#module-gptf.core.kernels" title="Permalink to this headline">¶</a></h2>
<p>Provides kernels.</p>
<dl class="class">
<dt id="gptf.core.kernels.Absolute">
<em class="property">class </em><code class="descclassname">gptf.core.kernels.</code><code class="descname">Absolute</code><span class="sig-paren">(</span><em>kernel</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/kernels.html#Absolute"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.kernels.Absolute" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gptf.core.kernels.Kernel" title="gptf.core.kernels.Kernel"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.kernels.Kernel</span></code></a>, <a class="reference internal" href="#gptf.core.params.ParamAttributes" title="gptf.core.params.ParamAttributes"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.params.ParamAttributes</span></code></a></p>
<p>The absolute value of a kernel.</p>
<dl class="method">
<dt id="gptf.core.kernels.Absolute.K">
<code class="descname">K</code><span class="sig-paren">(</span><em>X</em>, <em>X2=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/kernels.html#Absolute.K"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.kernels.Absolute.K" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds a tensor that computes the covariance function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>X</strong> (<em>tf.Tensor</em>) &#8211; A tensor of shape <span class="math">\(N \times D\)</span>.</li>
<li><strong>X2</strong> (<em>tf.Tensor | None</em>) &#8211; A tensor of shape <span class="math">\(M \times D\)</span>.
If <code class="code docutils literal"><span class="pre">None</span></code>, the second argument will be assumed symmetrical.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The covariance function K(X, X2). Shape
<span class="math">\(N \times M\)</span></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(tf.Tensor)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gptf.core.kernels.Absolute.Kdiag">
<code class="descname">Kdiag</code><span class="sig-paren">(</span><em>X</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/kernels.html#Absolute.Kdiag"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.kernels.Absolute.Kdiag" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds a tensor that computes the diagonal of <code class="code docutils literal"><span class="pre">self.K(X)</span></code></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>X</strong> (<em>tf.Tensor</em>) &#8211; A tensor of shape <span class="math">\(N \times D\)</span>.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The diagonal of <code class="code docutils literal"><span class="pre">self.K(X)</span></code>. Shape <code class="code docutils literal"><span class="pre">N</span></code>.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">(tf.Tensor)</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="gptf.core.kernels.Additive">
<em class="property">class </em><code class="descclassname">gptf.core.kernels.</code><code class="descname">Additive</code><span class="sig-paren">(</span><em>*kernels</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/kernels.html#Additive"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.kernels.Additive" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gptf.core.kernels.Kernel" title="gptf.core.kernels.Kernel"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.kernels.Kernel</span></code></a>, <a class="reference internal" href="#gptf.core.params.ParamList" title="gptf.core.params.ParamList"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.params.ParamList</span></code></a></p>
<p>The addition of mean functions.</p>
<dl class="method">
<dt id="gptf.core.kernels.Additive.K">
<code class="descname">K</code><span class="sig-paren">(</span><em>X</em>, <em>X2=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/kernels.html#Additive.K"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.kernels.Additive.K" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds a tensor that computes the covariance function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>X</strong> (<em>tf.Tensor</em>) &#8211; A tensor of shape <span class="math">\(N \times D\)</span>.</li>
<li><strong>X2</strong> (<em>tf.Tensor | None</em>) &#8211; A tensor of shape <span class="math">\(M \times D\)</span>.
If <code class="code docutils literal"><span class="pre">None</span></code>, the second argument will be assumed symmetrical.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The covariance function K(X, X2). Shape
<span class="math">\(N \times M\)</span></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(tf.Tensor)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gptf.core.kernels.Additive.Kdiag">
<code class="descname">Kdiag</code><span class="sig-paren">(</span><em>X</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/kernels.html#Additive.Kdiag"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.kernels.Additive.Kdiag" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds a tensor that computes the diagonal of <code class="code docutils literal"><span class="pre">self.K(X)</span></code></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>X</strong> (<em>tf.Tensor</em>) &#8211; A tensor of shape <span class="math">\(N \times D\)</span>.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The diagonal of <code class="code docutils literal"><span class="pre">self.K(X)</span></code>. Shape <code class="code docutils literal"><span class="pre">N</span></code>.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">(tf.Tensor)</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="attribute">
<dt id="gptf.core.kernels.Bias">
<code class="descclassname">gptf.core.kernels.</code><code class="descname">Bias</code><a class="headerlink" href="#gptf.core.kernels.Bias" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#gptf.core.kernels.Constant" title="gptf.core.kernels.Constant"><code class="xref py py-class docutils literal"><span class="pre">Constant</span></code></a></p>
</dd></dl>

<dl class="class">
<dt id="gptf.core.kernels.Constant">
<em class="property">class </em><code class="descclassname">gptf.core.kernels.</code><code class="descname">Constant</code><span class="sig-paren">(</span><em>variance=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/kernels.html#Constant"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.kernels.Constant" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gptf.core.kernels.Static" title="gptf.core.kernels.Static"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.kernels.Static</span></code></a></p>
<p>The Constant (a.k.a. Bias) kernel.</p>
<dl class="method">
<dt id="gptf.core.kernels.Constant.K">
<code class="descname">K</code><span class="sig-paren">(</span><em>X</em>, <em>X2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/kernels.html#Constant.K"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.kernels.Constant.K" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="gptf.core.kernels.Cosine">
<em class="property">class </em><code class="descclassname">gptf.core.kernels.</code><code class="descname">Cosine</code><span class="sig-paren">(</span><em>variance=1.0</em>, <em>lengthscales=1.0</em>, <em>ARD=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/kernels.html#Cosine"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.kernels.Cosine" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gptf.core.kernels.Stationary" title="gptf.core.kernels.Stationary"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.kernels.Stationary</span></code></a></p>
<p>The Cosine kernel.</p>
</dd></dl>

<dl class="class">
<dt id="gptf.core.kernels.Divisive">
<em class="property">class </em><code class="descclassname">gptf.core.kernels.</code><code class="descname">Divisive</code><span class="sig-paren">(</span><em>numerator</em>, <em>denominator</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/kernels.html#Divisive"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.kernels.Divisive" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gptf.core.kernels.Kernel" title="gptf.core.kernels.Kernel"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.kernels.Kernel</span></code></a>, <a class="reference internal" href="#gptf.core.params.ParamAttributes" title="gptf.core.params.ParamAttributes"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.params.ParamAttributes</span></code></a></p>
<p>The division of kernels.</p>
<p><code class="code docutils literal"><span class="pre">Divisive(a,</span> <span class="pre">b)(X)</span></code> returns <code class="code docutils literal"><span class="pre">a(X)</span> <span class="pre">/</span> <span class="pre">b(X)</span></code>.</p>
<dl class="method">
<dt id="gptf.core.kernels.Divisive.K">
<code class="descname">K</code><span class="sig-paren">(</span><em>X</em>, <em>X2=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/kernels.html#Divisive.K"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.kernels.Divisive.K" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds a tensor that computes the covariance function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>X</strong> (<em>tf.Tensor</em>) &#8211; A tensor of shape <span class="math">\(N \times D\)</span>.</li>
<li><strong>X2</strong> (<em>tf.Tensor | None</em>) &#8211; A tensor of shape <span class="math">\(M \times D\)</span>.
If <code class="code docutils literal"><span class="pre">None</span></code>, the second argument will be assumed symmetrical.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The covariance function K(X, X2). Shape
<span class="math">\(N \times M\)</span></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(tf.Tensor)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gptf.core.kernels.Divisive.Kdiag">
<code class="descname">Kdiag</code><span class="sig-paren">(</span><em>X</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/kernels.html#Divisive.Kdiag"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.kernels.Divisive.Kdiag" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds a tensor that computes the diagonal of <code class="code docutils literal"><span class="pre">self.K(X)</span></code></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>X</strong> (<em>tf.Tensor</em>) &#8211; A tensor of shape <span class="math">\(N \times D\)</span>.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The diagonal of <code class="code docutils literal"><span class="pre">self.K(X)</span></code>. Shape <code class="code docutils literal"><span class="pre">N</span></code>.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">(tf.Tensor)</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="gptf.core.kernels.Exponential">
<em class="property">class </em><code class="descclassname">gptf.core.kernels.</code><code class="descname">Exponential</code><span class="sig-paren">(</span><em>variance=1.0</em>, <em>lengthscales=1.0</em>, <em>ARD=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/kernels.html#Exponential"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.kernels.Exponential" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gptf.core.kernels.Stationary" title="gptf.core.kernels.Stationary"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.kernels.Stationary</span></code></a></p>
<p>The Exponential kernel.</p>
</dd></dl>

<dl class="class">
<dt id="gptf.core.kernels.Kernel">
<em class="property">class </em><code class="descclassname">gptf.core.kernels.</code><code class="descname">Kernel</code><a class="reference internal" href="_modules/gptf/core/kernels.html#Kernel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.kernels.Kernel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gptf.core.params.Parameterized" title="gptf.core.params.Parameterized"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.params.Parameterized</span></code></a></p>
<p>Base class for kernels.</p>
<p>Inheriting classes must define <code class="code docutils literal"><span class="pre">.K()</span></code>, <code class="code docutils literal"><span class="pre">.Kdiag()</span></code>.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Ones</span><span class="p">(</span><span class="n">Kernel</span><span class="p">,</span> <span class="n">ParamAttributes</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nd">@tf_method</span><span class="p">()</span>
<span class="gp">... </span>    <span class="nd">@overrides</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">K</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">X2</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">if</span> <span class="n">X2</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="gp">... </span>            <span class="n">X2</span> <span class="o">=</span> <span class="n">X</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">tf</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">X</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">tf</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">X2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]),</span>
<span class="gp">... </span>                       <span class="n">dtype</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<span class="gp">... </span>    <span class="nd">@tf_method</span><span class="p">()</span>
<span class="gp">... </span>    <span class="nd">@overrides</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">Kdiag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">tf</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">X</span><span class="p">)[</span><span class="mi">0</span><span class="p">],),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sess</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">InteractiveSession</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">([[</span><span class="mf">1.</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X2</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">([[</span><span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">2.</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Ones</span><span class="p">()</span><span class="o">.</span><span class="n">K</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">X2</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="go">array([[ 1., 1.]])</span>
</pre></div>
</div>
<p>You can do maths with kernels! Addition and subtraction:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">threes</span> <span class="o">=</span> <span class="n">Ones</span><span class="p">()</span> <span class="o">+</span> <span class="n">Ones</span><span class="p">()</span> <span class="o">+</span> <span class="n">Ones</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">threes</span><span class="o">.</span><span class="n">K</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">X2</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="go">array([[ 3., 3.]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">threes</span> <span class="o">-</span> <span class="n">Ones</span><span class="p">())</span><span class="o">.</span><span class="n">K</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">X2</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="go">array([[ 2., 2.]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="o">-</span><span class="n">threes</span><span class="p">)</span><span class="o">.</span><span class="n">K</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">X2</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="go">array([[-3., -3.]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">abs</span><span class="p">(</span><span class="o">-</span><span class="n">threes</span><span class="p">)</span><span class="o">.</span><span class="n">K</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">X2</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="go">array([[ 3.,  3.]])</span>
</pre></div>
</div>
<p>Multiplication and division:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">threes</span> <span class="o">*</span> <span class="n">threes</span><span class="p">)</span><span class="o">.</span><span class="n">K</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">X2</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="go">array([[ 9., 9.]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">Ones</span><span class="p">()</span> <span class="o">/</span> <span class="n">threes</span><span class="p">)</span><span class="o">.</span><span class="n">K</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">X2</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">array([[ 0.333, 0.333]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">threes</span><span class="p">)</span><span class="o">.</span><span class="n">K</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">X2</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>  <span class="c1"># 1 / Kernel works</span>
<span class="go">array([[ 0.333, 0.333]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">threes</span> <span class="o">*</span> <span class="n">threes</span> <span class="o">/</span> <span class="n">threes</span> <span class="o">*</span> <span class="n">threes</span><span class="p">)</span><span class="o">.</span><span class="n">K</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">X2</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="go">array([[ 9., 9.]])</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sess</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<dl class="method">
<dt id="gptf.core.kernels.Kernel.K">
<code class="descname">K</code><span class="sig-paren">(</span><em>X</em>, <em>X2=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/kernels.html#Kernel.K"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.kernels.Kernel.K" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds a tensor that computes the covariance function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>X</strong> (<em>tf.Tensor</em>) &#8211; A tensor of shape <span class="math">\(N \times D\)</span>.</li>
<li><strong>X2</strong> (<em>tf.Tensor | None</em>) &#8211; A tensor of shape <span class="math">\(M \times D\)</span>.
If <code class="code docutils literal"><span class="pre">None</span></code>, the second argument will be assumed symmetrical.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The covariance function K(X, X2). Shape
<span class="math">\(N \times M\)</span></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(tf.Tensor)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gptf.core.kernels.Kernel.Kdiag">
<code class="descname">Kdiag</code><span class="sig-paren">(</span><em>X</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/kernels.html#Kernel.Kdiag"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.kernels.Kernel.Kdiag" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds a tensor that computes the diagonal of <code class="code docutils literal"><span class="pre">self.K(X)</span></code></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>X</strong> (<em>tf.Tensor</em>) &#8211; A tensor of shape <span class="math">\(N \times D\)</span>.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The diagonal of <code class="code docutils literal"><span class="pre">self.K(X)</span></code>. Shape <code class="code docutils literal"><span class="pre">N</span></code>.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">(tf.Tensor)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gptf.core.kernels.Kernel.compute_K">
<code class="descname">compute_K</code><span class="sig-paren">(</span><em>X</em>, <em>Z</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/kernels.html#Kernel.compute_K"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.kernels.Kernel.compute_K" title="Permalink to this definition">¶</a></dt>
<dd><p>An autoflowed version of K(X, Z)</p>
</dd></dl>

<dl class="method">
<dt id="gptf.core.kernels.Kernel.compute_K_symm">
<code class="descname">compute_K_symm</code><span class="sig-paren">(</span><em>X</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/kernels.html#Kernel.compute_K_symm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.kernels.Kernel.compute_K_symm" title="Permalink to this definition">¶</a></dt>
<dd><p>An autoflowed version of K(X)</p>
</dd></dl>

<dl class="method">
<dt id="gptf.core.kernels.Kernel.compute_Kdiag">
<code class="descname">compute_Kdiag</code><span class="sig-paren">(</span><em>X</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/kernels.html#Kernel.compute_Kdiag"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.kernels.Kernel.compute_Kdiag" title="Permalink to this definition">¶</a></dt>
<dd><p>An autoflowed version of Kdiag(X)</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="gptf.core.kernels.Matern12">
<em class="property">class </em><code class="descclassname">gptf.core.kernels.</code><code class="descname">Matern12</code><span class="sig-paren">(</span><em>variance=1.0</em>, <em>lengthscales=1.0</em>, <em>ARD=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/kernels.html#Matern12"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.kernels.Matern12" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gptf.core.kernels.Stationary" title="gptf.core.kernels.Stationary"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.kernels.Stationary</span></code></a></p>
<p>The Matern 1/2 kernel</p>
</dd></dl>

<dl class="class">
<dt id="gptf.core.kernels.Matern32">
<em class="property">class </em><code class="descclassname">gptf.core.kernels.</code><code class="descname">Matern32</code><span class="sig-paren">(</span><em>variance=1.0</em>, <em>lengthscales=1.0</em>, <em>ARD=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/kernels.html#Matern32"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.kernels.Matern32" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gptf.core.kernels.Stationary" title="gptf.core.kernels.Stationary"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.kernels.Stationary</span></code></a></p>
<p>The Matern 3/2 kernel</p>
</dd></dl>

<dl class="class">
<dt id="gptf.core.kernels.Matern52">
<em class="property">class </em><code class="descclassname">gptf.core.kernels.</code><code class="descname">Matern52</code><span class="sig-paren">(</span><em>variance=1.0</em>, <em>lengthscales=1.0</em>, <em>ARD=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/kernels.html#Matern52"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.kernels.Matern52" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gptf.core.kernels.Stationary" title="gptf.core.kernels.Stationary"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.kernels.Stationary</span></code></a></p>
<p>The Matern 5/2 kernel</p>
</dd></dl>

<dl class="class">
<dt id="gptf.core.kernels.Multiplicative">
<em class="property">class </em><code class="descclassname">gptf.core.kernels.</code><code class="descname">Multiplicative</code><span class="sig-paren">(</span><em>*kernels</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/kernels.html#Multiplicative"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.kernels.Multiplicative" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gptf.core.kernels.Kernel" title="gptf.core.kernels.Kernel"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.kernels.Kernel</span></code></a>, <a class="reference internal" href="#gptf.core.params.ParamList" title="gptf.core.params.ParamList"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.params.ParamList</span></code></a></p>
<p>The multiplication of kernels.</p>
<dl class="method">
<dt id="gptf.core.kernels.Multiplicative.K">
<code class="descname">K</code><span class="sig-paren">(</span><em>X</em>, <em>X2=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/kernels.html#Multiplicative.K"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.kernels.Multiplicative.K" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds a tensor that computes the covariance function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>X</strong> (<em>tf.Tensor</em>) &#8211; A tensor of shape <span class="math">\(N \times D\)</span>.</li>
<li><strong>X2</strong> (<em>tf.Tensor | None</em>) &#8211; A tensor of shape <span class="math">\(M \times D\)</span>.
If <code class="code docutils literal"><span class="pre">None</span></code>, the second argument will be assumed symmetrical.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The covariance function K(X, X2). Shape
<span class="math">\(N \times M\)</span></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(tf.Tensor)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gptf.core.kernels.Multiplicative.Kdiag">
<code class="descname">Kdiag</code><span class="sig-paren">(</span><em>X</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/kernels.html#Multiplicative.Kdiag"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.kernels.Multiplicative.Kdiag" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds a tensor that computes the diagonal of <code class="code docutils literal"><span class="pre">self.K(X)</span></code></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>X</strong> (<em>tf.Tensor</em>) &#8211; A tensor of shape <span class="math">\(N \times D\)</span>.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The diagonal of <code class="code docutils literal"><span class="pre">self.K(X)</span></code>. Shape <code class="code docutils literal"><span class="pre">N</span></code>.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">(tf.Tensor)</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="gptf.core.kernels.Negative">
<em class="property">class </em><code class="descclassname">gptf.core.kernels.</code><code class="descname">Negative</code><span class="sig-paren">(</span><em>kernel</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/kernels.html#Negative"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.kernels.Negative" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gptf.core.kernels.Kernel" title="gptf.core.kernels.Kernel"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.kernels.Kernel</span></code></a>, <a class="reference internal" href="#gptf.core.params.ParamAttributes" title="gptf.core.params.ParamAttributes"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.params.ParamAttributes</span></code></a></p>
<p>The negative of a kernel.</p>
<dl class="method">
<dt id="gptf.core.kernels.Negative.K">
<code class="descname">K</code><span class="sig-paren">(</span><em>X</em>, <em>X2=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/kernels.html#Negative.K"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.kernels.Negative.K" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds a tensor that computes the covariance function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>X</strong> (<em>tf.Tensor</em>) &#8211; A tensor of shape <span class="math">\(N \times D\)</span>.</li>
<li><strong>X2</strong> (<em>tf.Tensor | None</em>) &#8211; A tensor of shape <span class="math">\(M \times D\)</span>.
If <code class="code docutils literal"><span class="pre">None</span></code>, the second argument will be assumed symmetrical.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The covariance function K(X, X2). Shape
<span class="math">\(N \times M\)</span></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(tf.Tensor)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gptf.core.kernels.Negative.Kdiag">
<code class="descname">Kdiag</code><span class="sig-paren">(</span><em>X</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/kernels.html#Negative.Kdiag"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.kernels.Negative.Kdiag" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds a tensor that computes the diagonal of <code class="code docutils literal"><span class="pre">self.K(X)</span></code></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>X</strong> (<em>tf.Tensor</em>) &#8211; A tensor of shape <span class="math">\(N \times D\)</span>.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The diagonal of <code class="code docutils literal"><span class="pre">self.K(X)</span></code>. Shape <code class="code docutils literal"><span class="pre">N</span></code>.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">(tf.Tensor)</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="gptf.core.kernels.PartiallyActive">
<em class="property">class </em><code class="descclassname">gptf.core.kernels.</code><code class="descname">PartiallyActive</code><span class="sig-paren">(</span><em>wrapped</em>, <em>active_dims</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/kernels.html#PartiallyActive"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.kernels.PartiallyActive" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gptf.core.kernels.Kernel" title="gptf.core.kernels.Kernel"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.kernels.Kernel</span></code></a>, <a class="reference internal" href="#gptf.core.params.ParamAttributes" title="gptf.core.params.ParamAttributes"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.params.ParamAttributes</span></code></a></p>
<p>A kernel that only uses some of the dimensions of the input.</p>
<dl class="attribute">
<dt id="gptf.core.kernels.PartiallyActive.wrapped">
<code class="descname">wrapped</code><a class="headerlink" href="#gptf.core.kernels.PartiallyActive.wrapped" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Kernel</em> &#8211; The wrapped kernel.</p>
</dd></dl>

<dl class="attribute">
<dt id="gptf.core.kernels.PartiallyActive.active_dims">
<code class="descname">active_dims</code><a class="headerlink" href="#gptf.core.kernels.PartiallyActive.active_dims" title="Permalink to this definition">¶</a></dt>
<dd><p><em>slice | Iterable[int]</em> &#8211; The active dimensions of
the input. Each input to <code class="code docutils literal"><span class="pre">.K()</span> <span class="pre">or</span> <span class="pre">`.Kdiag()</span></code> will be sliced
along its second axis so that only the active dimensions
remain before being passed to <code class="code docutils literal"><span class="pre">.wrapped.K()</span></code> or
<code class="code docutils literal"><span class="pre">.wrapped.Kdiag()</span></code>.</p>
</dd></dl>

<p class="rubric">Examples</p>
<p>First, we define an example kernel that lets us inspect the
arguments passed to <code class="code docutils literal"><span class="pre">.K()</span></code>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Example</span><span class="p">(</span><span class="n">Kernel</span><span class="p">,</span> <span class="n">ParamAttributes</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nd">@tf_method</span><span class="p">()</span>
<span class="gp">... </span>    <span class="nd">@overrides</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">K</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">X2</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="n">X</span><span class="p">,</span> <span class="n">X2</span>
<span class="gp">... </span>    <span class="nd">@tf_method</span><span class="p">()</span>
<span class="gp">... </span>    <span class="nd">@overrides</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">Kdiag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">X2</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">NotImplemented</span>
</pre></div>
</div>
<p>Slices are applied to the second axis of the input.
A slice of <code class="code docutils literal"><span class="pre">:3</span></code> turns <code class="code docutils literal"><span class="pre">X</span></code> into <code class="code docutils literal"><span class="pre">X[:,</span> <span class="pre">:3]</span></code>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">k</span> <span class="o">=</span> <span class="n">PartiallyActive</span><span class="p">(</span><span class="n">Example</span><span class="p">(),</span> <span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>  <span class="c1"># :3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X_k</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">compute_K</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X_k</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(1, 3)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X_k</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">array([ 0., 1., 2.])</span>
</pre></div>
</div>
<p>If active_dims is a sequence of <code class="code docutils literal"><span class="pre">int</span></code>, only dimensions in the
sequence will be passed through.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">k</span><span class="o">.</span><span class="n">active_dims</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X_k</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">compute_K</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X_k</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(1, 3)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X_k</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">array([ 1., 3., 4.])</span>
</pre></div>
</div>
<dl class="method">
<dt id="gptf.core.kernels.PartiallyActive.K">
<code class="descname">K</code><span class="sig-paren">(</span><em>X</em>, <em>X2=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/kernels.html#PartiallyActive.K"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.kernels.PartiallyActive.K" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds a tensor that computes the covariance function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>X</strong> (<em>tf.Tensor</em>) &#8211; A tensor of shape <span class="math">\(N \times D\)</span>.</li>
<li><strong>X2</strong> (<em>tf.Tensor | None</em>) &#8211; A tensor of shape <span class="math">\(M \times D\)</span>.
If <code class="code docutils literal"><span class="pre">None</span></code>, the second argument will be assumed symmetrical.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The covariance function K(X, X2). Shape
<span class="math">\(N \times M\)</span></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(tf.Tensor)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gptf.core.kernels.PartiallyActive.Kdiag">
<code class="descname">Kdiag</code><span class="sig-paren">(</span><em>X</em>, <em>X2=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/kernels.html#PartiallyActive.Kdiag"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.kernels.PartiallyActive.Kdiag" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds a tensor that computes the diagonal of <code class="code docutils literal"><span class="pre">self.K(X)</span></code></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>X</strong> (<em>tf.Tensor</em>) &#8211; A tensor of shape <span class="math">\(N \times D\)</span>.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The diagonal of <code class="code docutils literal"><span class="pre">self.K(X)</span></code>. Shape <code class="code docutils literal"><span class="pre">N</span></code>.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">(tf.Tensor)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">active_dims</code></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="gptf.core.kernels.RBF">
<em class="property">class </em><code class="descclassname">gptf.core.kernels.</code><code class="descname">RBF</code><span class="sig-paren">(</span><em>variance=1.0</em>, <em>lengthscales=1.0</em>, <em>ARD=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/kernels.html#RBF"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.kernels.RBF" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gptf.core.kernels.Stationary" title="gptf.core.kernels.Stationary"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.kernels.Stationary</span></code></a></p>
<p>The Radial Basis Function (RBF) or squared exponential kernel.</p>
</dd></dl>

<dl class="class">
<dt id="gptf.core.kernels.Static">
<em class="property">class </em><code class="descclassname">gptf.core.kernels.</code><code class="descname">Static</code><span class="sig-paren">(</span><em>variance=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/kernels.html#Static"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.kernels.Static" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gptf.core.kernels.Kernel" title="gptf.core.kernels.Kernel"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.kernels.Kernel</span></code></a>, <a class="reference internal" href="#gptf.core.params.ParamAttributes" title="gptf.core.params.ParamAttributes"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.params.ParamAttributes</span></code></a></p>
<p>Base class for static kernels.</p>
<p>Kernels that do not depend on the value of the inputs are static.
The only parameter they require is a variance.</p>
<dl class="attribute">
<dt id="gptf.core.kernels.Static.variance">
<code class="descname">variance</code><a class="headerlink" href="#gptf.core.kernels.Static.variance" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Param</em> &#8211; The variance of the kernel.</p>
</dd></dl>

<dl class="method">
<dt id="gptf.core.kernels.Static.Kdiag">
<code class="descname">Kdiag</code><span class="sig-paren">(</span><em>X</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/kernels.html#Static.Kdiag"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.kernels.Static.Kdiag" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds a tensor that computes the diagonal of <code class="code docutils literal"><span class="pre">self.K(X)</span></code></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>X</strong> (<em>tf.Tensor</em>) &#8211; A tensor of shape <span class="math">\(N \times D\)</span>.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The diagonal of <code class="code docutils literal"><span class="pre">self.K(X)</span></code>. Shape <code class="code docutils literal"><span class="pre">N</span></code>.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">(tf.Tensor)</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="gptf.core.kernels.Stationary">
<em class="property">class </em><code class="descclassname">gptf.core.kernels.</code><code class="descname">Stationary</code><span class="sig-paren">(</span><em>variance=1.0</em>, <em>lengthscales=1.0</em>, <em>ARD=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/kernels.html#Stationary"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.kernels.Stationary" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gptf.core.kernels.Kernel" title="gptf.core.kernels.Kernel"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.kernels.Kernel</span></code></a>, <a class="reference internal" href="#gptf.core.params.ParamAttributes" title="gptf.core.params.ParamAttributes"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.params.ParamAttributes</span></code></a></p>
<p>Base class for stationary kernels.</p>
<p>Inheriting classes must define <code class="code docutils literal"><span class="pre">._trueK()</span></code> instead of <code class="code docutils literal"><span class="pre">.K()</span></code>.</p>
<dl class="docutils">
<dt>Stationary kernels depend only on</dt>
<dd>r = || X - X2 ||</dd>
</dl>
<p>This class handles ARD (Automatic Relevance Determination)
behaviour. If ARD, then the kernal has one length scale per input
dimension. Otherwise, the kernel is isotropic (one length scale).</p>
<dl class="attribute">
<dt id="gptf.core.kernels.Stationary.variance">
<code class="descname">variance</code><a class="headerlink" href="#gptf.core.kernels.Stationary.variance" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Param</em> &#8211; The variance of the kernel.</p>
</dd></dl>

<dl class="attribute">
<dt id="gptf.core.kernels.Stationary.lengthscales">
<code class="descname">lengthscales</code><a class="headerlink" href="#gptf.core.kernels.Stationary.lengthscales" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Param | None</em> &#8211; The length scale parameters of
the kernel. Points are divided by the length scale(s)
before distances are found between them.
Note that if ARD is used, this will be <code class="code docutils literal"><span class="pre">None</span></code> until the
first call to <code class="code docutils literal"><span class="pre">.K()</span></code>.</p>
</dd></dl>

<p class="rubric">Examples</p>
<p>You can use ARD to automatically create one length scale for
each dimension of the input.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">gptf</span> <span class="k">import</span> <span class="n">tfhacks</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Example</span><span class="p">(</span><span class="n">Stationary</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nd">@tf_method</span><span class="p">()</span>
<span class="gp">... </span>    <span class="nd">@overrides</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">_trueK</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">X2</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="gp">... </span>        <span class="n">n</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">X</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="n">tfhacks</span><span class="o">.</span><span class="n">eye</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="n">Example</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>  <span class="c1"># use ARD</span>
</pre></div>
</div>
<p>At first, no length scale parameter is created.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="o">.</span><span class="n">lengthscales</span> <span class="ow">is</span> <span class="kc">None</span>
<span class="go">True</span>
</pre></div>
</div>
<p>When <code class="code docutils literal"><span class="pre">.K()</span></code> is called, the shape of <code class="code docutils literal"><span class="pre">X</span></code> is used to create the
value of <code class="code docutils literal"><span class="pre">.lengthscales</span></code>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">2.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="o">.</span><span class="n">get_session</span><span class="p">()</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">K</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
<span class="go">array([[ 1.]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">lengthscales</span><span class="p">,</span> <span class="n">Param</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="o">.</span><span class="n">lengthscales</span><span class="o">.</span><span class="n">value</span>
<span class="go">array([ 1., 1., 1.])</span>
</pre></div>
</div>
<dl class="method">
<dt id="gptf.core.kernels.Stationary.K">
<code class="descname">K</code><span class="sig-paren">(</span><em>X</em>, <em>X2=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/kernels.html#Stationary.K"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.kernels.Stationary.K" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds a tensor that computes the covariance function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>X</strong> (<em>tf.Tensor</em>) &#8211; A tensor of shape <span class="math">\(N \times D\)</span>.</li>
<li><strong>X2</strong> (<em>tf.Tensor | None</em>) &#8211; A tensor of shape <span class="math">\(M \times D\)</span>.
If <code class="code docutils literal"><span class="pre">None</span></code>, the second argument will be assumed symmetrical.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The covariance function K(X, X2). Shape
<span class="math">\(N \times M\)</span></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(tf.Tensor)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gptf.core.kernels.Stationary.Kdiag">
<code class="descname">Kdiag</code><span class="sig-paren">(</span><em>X</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/kernels.html#Stationary.Kdiag"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.kernels.Stationary.Kdiag" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds a tensor that computes the diagonal of <code class="code docutils literal"><span class="pre">self.K(X)</span></code></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>X</strong> (<em>tf.Tensor</em>) &#8211; A tensor of shape <span class="math">\(N \times D\)</span>.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The diagonal of <code class="code docutils literal"><span class="pre">self.K(X)</span></code>. Shape <code class="code docutils literal"><span class="pre">N</span></code>.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">(tf.Tensor)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gptf.core.kernels.Stationary.euclid_dist">
<code class="descname">euclid_dist</code><span class="sig-paren">(</span><em>X</em>, <em>X2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/kernels.html#Stationary.euclid_dist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.kernels.Stationary.euclid_dist" title="Permalink to this definition">¶</a></dt>
<dd><p>The Euclidean distances between X and X2.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>X</strong> (<em>tf.Tensor</em>) &#8211; A tensor of shape <span class="math">\(N \times D\)</span>.</li>
<li><strong>X2</strong> (<em>Tf.Tensor | None</em>) &#8211; A tensor of shape <span class="math">\(M \times D\)</span>.
If none, assumed to be symmetrical.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A tensor of shape <span class="math">\(N \times M\)</span>, where
<code class="code docutils literal"><span class="pre">self.square_dist(X,</span> <span class="pre">X2)[a,</span> <span class="pre">b]</span></code> is the Euclidean distance
between <code class="code docutils literal"><span class="pre">X[a]</span></code> and <code class="code docutils literal"><span class="pre">X2[b]</span></code>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(tf.Tensor)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gptf.core.kernels.Stationary.square_dist">
<code class="descname">square_dist</code><span class="sig-paren">(</span><em>X</em>, <em>X2=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/kernels.html#Stationary.square_dist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.kernels.Stationary.square_dist" title="Permalink to this definition">¶</a></dt>
<dd><p>The squared distances between X and X2.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>X</strong> (<em>tf.Tensor</em>) &#8211; A tensor of shape <span class="math">\(N \times D\)</span>.</li>
<li><strong>X2</strong> (<em>Tf.Tensor | None</em>) &#8211; A tensor of shape <span class="math">\(M \times D\)</span>.
If none, assumed to be symmetrical.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A tensor of shape <span class="math">\(N \times M\)</span>, where
<code class="code docutils literal"><span class="pre">self.square_dist(X,</span> <span class="pre">X2)[a,</span> <span class="pre">b]</span></code> is the squared distance
between <code class="code docutils literal"><span class="pre">X[a]</span></code> and <code class="code docutils literal"><span class="pre">X2[b]</span></code>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(tf.Tensor)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="gptf.core.kernels.White">
<em class="property">class </em><code class="descclassname">gptf.core.kernels.</code><code class="descname">White</code><span class="sig-paren">(</span><em>variance=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/kernels.html#White"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.kernels.White" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gptf.core.kernels.Static" title="gptf.core.kernels.Static"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.kernels.Static</span></code></a></p>
<p>The White kernel.</p>
<dl class="method">
<dt id="gptf.core.kernels.White.K">
<code class="descname">K</code><span class="sig-paren">(</span><em>X</em>, <em>X2=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/kernels.html#White.K"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.kernels.White.K" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-gptf.core.likelihoods">
<span id="gptf-core-likelihoods-module"></span><h2>gptf.core.likelihoods module<a class="headerlink" href="#module-gptf.core.likelihoods" title="Permalink to this headline">¶</a></h2>
<p>Provides facilities for calculating likelihoods, densities etc.</p>
<dl class="class">
<dt id="gptf.core.likelihoods.Gaussian">
<em class="property">class </em><code class="descclassname">gptf.core.likelihoods.</code><code class="descname">Gaussian</code><span class="sig-paren">(</span><em>variance=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/likelihoods.html#Gaussian"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.likelihoods.Gaussian" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gptf.core.likelihoods.Likelihood" title="gptf.core.likelihoods.Likelihood"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.likelihoods.Likelihood</span></code></a>, <a class="reference internal" href="#gptf.core.params.ParamAttributes" title="gptf.core.params.ParamAttributes"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.params.ParamAttributes</span></code></a></p>
<dl class="method">
<dt id="gptf.core.likelihoods.Gaussian.conditional_mean">
<code class="descname">conditional_mean</code><span class="sig-paren">(</span><em>F</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/likelihoods.html#Gaussian.conditional_mean"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.likelihoods.Gaussian.conditional_mean" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the mean of the data given values of the latent func.</p>
<p>If this object represents <span class="math">\(p(y|f)\)</span>, then this method
computes</p>
<div class="math">
\[\int y p(y|f) dy\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>F</strong> (<em>tf.Tensor</em>) &#8211; Proposed values for the latent function.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The mean of the data given the value of the
latent function.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">(tf.Tensor)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gptf.core.likelihoods.Gaussian.conditional_variance">
<code class="descname">conditional_variance</code><span class="sig-paren">(</span><em>F</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/likelihoods.html#Gaussian.conditional_variance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.likelihoods.Gaussian.conditional_variance" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the variance of the data given values of the latent func.</p>
<p>If this object represents <span class="math">\(p(y|f)\)</span>, then this method
computes</p>
<div class="math">
\[\int y^2 p(y|f) dy - (\int y p(y|f) dy)^2\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>F</strong> (<em>tf.Tensor</em>) &#8211; Proposed values for the latent function.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The variance of the data given the value of the
latent function.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">(tf.Tensor)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gptf.core.likelihoods.Gaussian.logp">
<code class="descname">logp</code><span class="sig-paren">(</span><em>F</em>, <em>Y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/likelihoods.html#Gaussian.logp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.likelihoods.Gaussian.logp" title="Permalink to this definition">¶</a></dt>
<dd><p>The log density of the data given the function values.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>F</strong> (<em>tf.Tensor</em>) &#8211; A set of proposed function values.</li>
<li><strong>Y</strong> (<em>tf.Tensor</em>) &#8211; The data.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The log density of the data; <code class="code docutils literal"><span class="pre">p(Y|F)</span></code>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(tf.Tensor)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gptf.core.likelihoods.Gaussian.predict_density">
<code class="descname">predict_density</code><span class="sig-paren">(</span><em>mu_F</em>, <em>var_F</em>, <em>Y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/likelihoods.html#Gaussian.predict_density"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.likelihoods.Gaussian.predict_density" title="Permalink to this definition">¶</a></dt>
<dd><p>The (log) density of Y given a mean &amp; variance of the f.</p>
</dd></dl>

<dl class="method">
<dt id="gptf.core.likelihoods.Gaussian.predict_mean_and_var">
<code class="descname">predict_mean_and_var</code><span class="sig-paren">(</span><em>mu_F</em>, <em>var_F</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/likelihoods.html#Gaussian.predict_mean_and_var"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.likelihoods.Gaussian.predict_mean_and_var" title="Permalink to this definition">¶</a></dt>
<dd><p>The mean &amp; variance of Y given a mean &amp; variance of the f.</p>
</dd></dl>

<dl class="method">
<dt id="gptf.core.likelihoods.Gaussian.variational_expectations">
<code class="descname">variational_expectations</code><span class="sig-paren">(</span><em>mu_F</em>, <em>var_F</em>, <em>Y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/likelihoods.html#Gaussian.variational_expectations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.likelihoods.Gaussian.variational_expectations" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the expected log density of the data.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="gptf.core.likelihoods.Likelihood">
<em class="property">class </em><code class="descclassname">gptf.core.likelihoods.</code><code class="descname">Likelihood</code><a class="reference internal" href="_modules/gptf/core/likelihoods.html#Likelihood"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.likelihoods.Likelihood" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gptf.core.params.Parameterized" title="gptf.core.params.Parameterized"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.params.Parameterized</span></code></a></p>
<p>Abstract base class for likelihoods.</p>
<p>Inheriting classes must implement <code class="code docutils literal"><span class="pre">.logp()</span></code>, <code class="code docutils literal"><span class="pre">.conditional_mean()</span></code>
and <code class="code docutils literal"><span class="pre">.conditional_variance()</span></code>.</p>
<dl class="method">
<dt id="gptf.core.likelihoods.Likelihood.conditional_mean">
<code class="descname">conditional_mean</code><span class="sig-paren">(</span><em>F</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/likelihoods.html#Likelihood.conditional_mean"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.likelihoods.Likelihood.conditional_mean" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the mean of the data given values of the latent func.</p>
<p>If this object represents <span class="math">\(p(y|f)\)</span>, then this method
computes</p>
<div class="math">
\[\int y p(y|f) dy\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>F</strong> (<em>tf.Tensor</em>) &#8211; Proposed values for the latent function.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The mean of the data given the value of the
latent function.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">(tf.Tensor)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gptf.core.likelihoods.Likelihood.conditional_variance">
<code class="descname">conditional_variance</code><span class="sig-paren">(</span><em>F</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/likelihoods.html#Likelihood.conditional_variance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.likelihoods.Likelihood.conditional_variance" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the variance of the data given values of the latent func.</p>
<p>If this object represents <span class="math">\(p(y|f)\)</span>, then this method
computes</p>
<div class="math">
\[\int y^2 p(y|f) dy - (\int y p(y|f) dy)^2\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>F</strong> (<em>tf.Tensor</em>) &#8211; Proposed values for the latent function.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The variance of the data given the value of the
latent function.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">(tf.Tensor)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gptf.core.likelihoods.Likelihood.logp">
<code class="descname">logp</code><span class="sig-paren">(</span><em>F</em>, <em>Y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/likelihoods.html#Likelihood.logp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.likelihoods.Likelihood.logp" title="Permalink to this definition">¶</a></dt>
<dd><p>The log density of the data given the function values.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>F</strong> (<em>tf.Tensor</em>) &#8211; A set of proposed function values.</li>
<li><strong>Y</strong> (<em>tf.Tensor</em>) &#8211; The data.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The log density of the data; <code class="code docutils literal"><span class="pre">p(Y|F)</span></code>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(tf.Tensor)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gptf.core.likelihoods.Likelihood.predict_density">
<code class="descname">predict_density</code><span class="sig-paren">(</span><em>mu_F</em>, <em>var_F</em>, <em>Y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/likelihoods.html#Likelihood.predict_density"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.likelihoods.Likelihood.predict_density" title="Permalink to this definition">¶</a></dt>
<dd><p>The (log) density of Y given a mean &amp; variance of the latent func.</p>
<p>if <span class="math">\(q(f) = N(mu_F, var_F)\)</span> and this object represents
<span class="math">\(p(y|f)\)</span>,
then this method computes the predictive density</p>
<div class="math">
\[\int p(y=Y|f) q(f) df\]</div>
<p>Here, we implement a Gauss-Hermite quadrature routine, but some
likelihoods (e.g. Gaussian, Poisson) will implement specific cases.</p>
</dd></dl>

<dl class="method">
<dt id="gptf.core.likelihoods.Likelihood.predict_mean_and_var">
<code class="descname">predict_mean_and_var</code><span class="sig-paren">(</span><em>mu_F</em>, <em>var_F</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/likelihoods.html#Likelihood.predict_mean_and_var"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.likelihoods.Likelihood.predict_mean_and_var" title="Permalink to this definition">¶</a></dt>
<dd><p>The mean &amp; variance of Y given a mean &amp; variance of the latent func.</p>
<p>if <span class="math">\(q(f) = N(mu_F, var_F)\)</span> and this object represents
<span class="math">\(p(y|f)\)</span>,
then this method computes the predictive mean</p>
<div class="math">
\[\int\int y p(y|f) q(f) df dy\]</div>
<p>and the predictive variance</p>
<div class="math">
\[\int\int y^2 p(y|f) q(f) df dy
- (\int\int y p(y|f) q(f) df dy)^2\]</div>
<p>Here, we implement a Gauss-Hermite quadrature routine, but some
likelihoods (e.g. Gaussian) will implement specific cases.</p>
</dd></dl>

<dl class="method">
<dt id="gptf.core.likelihoods.Likelihood.variational_expectations">
<code class="descname">variational_expectations</code><span class="sig-paren">(</span><em>mu_F</em>, <em>var_F</em>, <em>Y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/likelihoods.html#Likelihood.variational_expectations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.likelihoods.Likelihood.variational_expectations" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the expected log density of the data.</p>
<p>if <span class="math">\(q(f) = N(mu_F, var_F)\)</span> and this object represents
<span class="math">\(p(y|f)\)</span>,
then this method computes the predictive density</p>
<div class="math">
\[\int (\log p(y|f)) q(f) df\]</div>
<p>Here, we implement a Gauss-Hermite quadrature routine, but some
likelihoods (e.g. Gaussian, Poisson) will implement specific cases.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-gptf.core.meanfunctions">
<span id="gptf-core-meanfunctions-module"></span><h2>gptf.core.meanfunctions module<a class="headerlink" href="#module-gptf.core.meanfunctions" title="Permalink to this headline">¶</a></h2>
<p>Provides mean functions.</p>
<dl class="class">
<dt id="gptf.core.meanfunctions.Absolute">
<em class="property">class </em><code class="descclassname">gptf.core.meanfunctions.</code><code class="descname">Absolute</code><span class="sig-paren">(</span><em>function</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/meanfunctions.html#Absolute"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.meanfunctions.Absolute" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gptf.core.meanfunctions.MeanFunction" title="gptf.core.meanfunctions.MeanFunction"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.meanfunctions.MeanFunction</span></code></a>, <a class="reference internal" href="#gptf.core.params.ParamAttributes" title="gptf.core.params.ParamAttributes"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.params.ParamAttributes</span></code></a></p>
<p>The absolute value of a mean function.</p>
</dd></dl>

<dl class="class">
<dt id="gptf.core.meanfunctions.Additive">
<em class="property">class </em><code class="descclassname">gptf.core.meanfunctions.</code><code class="descname">Additive</code><span class="sig-paren">(</span><em>*functions</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/meanfunctions.html#Additive"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.meanfunctions.Additive" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gptf.core.meanfunctions.MeanFunction" title="gptf.core.meanfunctions.MeanFunction"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.meanfunctions.MeanFunction</span></code></a>, <a class="reference internal" href="#gptf.core.params.ParamList" title="gptf.core.params.ParamList"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.params.ParamList</span></code></a></p>
<p>The addition of mean functions.</p>
</dd></dl>

<dl class="class">
<dt id="gptf.core.meanfunctions.Constant">
<em class="property">class </em><code class="descclassname">gptf.core.meanfunctions.</code><code class="descname">Constant</code><span class="sig-paren">(</span><em>c=array([0])</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/meanfunctions.html#Constant"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.meanfunctions.Constant" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gptf.core.meanfunctions.MeanFunction" title="gptf.core.meanfunctions.MeanFunction"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.meanfunctions.MeanFunction</span></code></a>, <a class="reference internal" href="#gptf.core.params.ParamAttributes" title="gptf.core.params.ParamAttributes"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.params.ParamAttributes</span></code></a></p>
<p>y_i = c,,</p>
</dd></dl>

<dl class="class">
<dt id="gptf.core.meanfunctions.Divisive">
<em class="property">class </em><code class="descclassname">gptf.core.meanfunctions.</code><code class="descname">Divisive</code><span class="sig-paren">(</span><em>numerator</em>, <em>denominator</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/meanfunctions.html#Divisive"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.meanfunctions.Divisive" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gptf.core.meanfunctions.MeanFunction" title="gptf.core.meanfunctions.MeanFunction"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.meanfunctions.MeanFunction</span></code></a>, <a class="reference internal" href="#gptf.core.params.ParamAttributes" title="gptf.core.params.ParamAttributes"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.params.ParamAttributes</span></code></a></p>
<p>The division of mean functions.</p>
<p><code class="code docutils literal"><span class="pre">Divisive(a,</span> <span class="pre">b)(X)</span></code> returns <code class="code docutils literal"><span class="pre">a(X)</span> <span class="pre">/</span> <span class="pre">b(X)</span></code>.</p>
<dl class="method">
<dt id="gptf.core.meanfunctions.Divisive.clone">
<code class="descname">clone</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/meanfunctions.html#Divisive.clone"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.meanfunctions.Divisive.clone" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="gptf.core.meanfunctions.Linear">
<em class="property">class </em><code class="descclassname">gptf.core.meanfunctions.</code><code class="descname">Linear</code><span class="sig-paren">(</span><em>A=array([[ 1.]])</em>, <em>b=array([ 0.])</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/meanfunctions.html#Linear"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.meanfunctions.Linear" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gptf.core.meanfunctions.MeanFunction" title="gptf.core.meanfunctions.MeanFunction"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.meanfunctions.MeanFunction</span></code></a>, <a class="reference internal" href="#gptf.core.params.ParamAttributes" title="gptf.core.params.ParamAttributes"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.params.ParamAttributes</span></code></a></p>
<p>y_i = A x_i + b</p>
</dd></dl>

<dl class="class">
<dt id="gptf.core.meanfunctions.MeanFunction">
<em class="property">class </em><code class="descclassname">gptf.core.meanfunctions.</code><code class="descname">MeanFunction</code><a class="reference internal" href="_modules/gptf/core/meanfunctions.html#MeanFunction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.meanfunctions.MeanFunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gptf.core.params.Parameterized" title="gptf.core.params.Parameterized"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.params.Parameterized</span></code></a></p>
<p>Abstract base class for mean functions.</p>
<p>Inheriting classes must define <code class="code docutils literal"><span class="pre">.__call__()</span></code>.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Ones</span><span class="p">(</span><span class="n">MeanFunction</span><span class="p">,</span> <span class="n">ParamAttributes</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nd">@tf_method</span><span class="p">()</span>
<span class="gp">... </span>    <span class="nd">@overrides</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sess</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">InteractiveSession</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Ones</span><span class="p">()(</span><span class="n">X</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="go">array([ 1.,  1.,  1.,  1.])</span>
</pre></div>
</div>
<p>You can do maths with mean functions! Addition and subtraction:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">threes</span> <span class="o">=</span> <span class="n">Ones</span><span class="p">()</span> <span class="o">+</span> <span class="n">Ones</span><span class="p">()</span> <span class="o">+</span> <span class="n">Ones</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">threes</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="go">array([ 3.,  3.,  3.,  3.])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">threes</span> <span class="o">-</span> <span class="n">Ones</span><span class="p">())(</span><span class="n">X</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="go">array([ 2.,  2.,  2.,  2.])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="o">-</span><span class="n">threes</span><span class="p">)(</span><span class="n">X</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="go">array([-3., -3., -3., -3.])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">abs</span><span class="p">(</span><span class="o">-</span><span class="n">threes</span><span class="p">)(</span><span class="n">X</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="go">array([ 3.,  3.,  3.,  3.])</span>
</pre></div>
</div>
<p>Multiplication and division:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">threes</span> <span class="o">*</span> <span class="n">threes</span><span class="p">)(</span><span class="n">X</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="go">array([ 9., 9., 9., 9.])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">Ones</span><span class="p">()</span> <span class="o">/</span> <span class="n">threes</span><span class="p">)(</span><span class="n">X</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">array([ 0.333, 0.333, 0.333, 0.333])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">threes</span><span class="p">)(</span><span class="n">X</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>  <span class="c1"># this works as a special case</span>
<span class="go">array([ 0.333, 0.333, 0.333, 0.333])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">threes</span> <span class="o">*</span> <span class="n">threes</span> <span class="o">/</span> <span class="n">threes</span> <span class="o">*</span> <span class="n">threes</span><span class="p">)(</span><span class="n">X</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="go">array([ 9., 9., 9., 9.])</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sess</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="gptf.core.meanfunctions.Multiplicative">
<em class="property">class </em><code class="descclassname">gptf.core.meanfunctions.</code><code class="descname">Multiplicative</code><span class="sig-paren">(</span><em>*functions</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/meanfunctions.html#Multiplicative"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.meanfunctions.Multiplicative" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gptf.core.meanfunctions.MeanFunction" title="gptf.core.meanfunctions.MeanFunction"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.meanfunctions.MeanFunction</span></code></a>, <a class="reference internal" href="#gptf.core.params.ParamList" title="gptf.core.params.ParamList"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.params.ParamList</span></code></a></p>
<p>The multiplication of mean functions.</p>
</dd></dl>

<dl class="class">
<dt id="gptf.core.meanfunctions.Negative">
<em class="property">class </em><code class="descclassname">gptf.core.meanfunctions.</code><code class="descname">Negative</code><span class="sig-paren">(</span><em>function</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/meanfunctions.html#Negative"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.meanfunctions.Negative" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gptf.core.meanfunctions.MeanFunction" title="gptf.core.meanfunctions.MeanFunction"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.meanfunctions.MeanFunction</span></code></a>, <a class="reference internal" href="#gptf.core.params.ParamAttributes" title="gptf.core.params.ParamAttributes"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.params.ParamAttributes</span></code></a></p>
<p>The negative of a mean function.</p>
</dd></dl>

<dl class="class">
<dt id="gptf.core.meanfunctions.Zero">
<em class="property">class </em><code class="descclassname">gptf.core.meanfunctions.</code><code class="descname">Zero</code><span class="sig-paren">(</span><em>num_latent_functions=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/meanfunctions.html#Zero"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.meanfunctions.Zero" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gptf.core.meanfunctions.MeanFunction" title="gptf.core.meanfunctions.MeanFunction"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.meanfunctions.MeanFunction</span></code></a>, <a class="reference internal" href="#gptf.core.params.ParamAttributes" title="gptf.core.params.ParamAttributes"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.params.ParamAttributes</span></code></a></p>
</dd></dl>

</div>
<div class="section" id="module-gptf.core.models">
<span id="gptf-core-models-module"></span><h2>gptf.core.models module<a class="headerlink" href="#module-gptf.core.models" title="Permalink to this headline">¶</a></h2>
<p>Provides base classes for models of all kinds.</p>
<dl class="class">
<dt id="gptf.core.models.GPModel">
<em class="property">class </em><code class="descclassname">gptf.core.models.</code><code class="descname">GPModel</code><a class="reference internal" href="_modules/gptf/core/models.html#GPModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.models.GPModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gptf.core.models.Model" title="gptf.core.models.Model"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.models.Model</span></code></a></p>
<p>A base class for Guassian Process models.</p>
<p>A Gaussian process model is a model of the form</p>
<div class="math">
\[ \begin{align}\begin{aligned}θ ~ p(θ)\\f ~ GP(m(x), k(x, x'; θ))\\F = f(X)\\Y|F ~ p(Y|F)\end{aligned}\end{align} \]</div>
<p>Adds functionality to compile various predictions. Inheriting
classes must define <code class="code docutils literal"><span class="pre">.build_predict()</span></code>, which is then used by this
class&#8217;s methods to provide various predictions. The mean and
variance are pushed through the likelihood to obtain the means and
variances of held out data.</p>
<dl class="method">
<dt id="gptf.core.models.GPModel.build_posterior_mean_var">
<code class="descname">build_posterior_mean_var</code><span class="sig-paren">(</span><em>X</em>, <em>Y</em>, <em>test_points</em>, <em>full_cov=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/models.html#GPModel.build_posterior_mean_var"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.models.GPModel.build_posterior_mean_var" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds an op for the mean and variance of the posterior(s).</p>
<p>In the returned tensors, the last index should always be the
latent function index.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>X</strong> (<em>tf.Tensor</em>) &#8211; The training inputs, shape <code class="code docutils literal"><span class="pre">[n,</span> <span class="pre">point_dims]</span></code></li>
<li><strong>Y</strong> (<em>tf.Tensor</em>) &#8211; The training outputs, shape <code class="code docutils literal"><span class="pre">[n,</span> <span class="pre">num_latent]</span></code></li>
<li><strong>test_points</strong> (<em>tf.Tensor</em>) &#8211; The points from the sample
space for which to predict means and variances
of the posterior distribution(s), shape
<code class="code docutils literal"><span class="pre">[m,</span> <span class="pre">point_dims]</span></code>.</li>
<li><strong>full_cov</strong> (<em>bool</em>) &#8211; If <code class="code docutils literal"><span class="pre">False</span></code>, return an array of variances
at the test points. If <code class="code docutils literal"><span class="pre">True</span></code>, return the full
covariance matrix of the posterior distribution.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A tensor that calculates the mean
at the test points with shape <code class="code docutils literal"><span class="pre">[m,</span> <span class="pre">num_latent]</span></code>, a tensor
that calculates either the variances at the test points
(shape <code class="code docutils literal"><span class="pre">[m,</span> <span class="pre">num_latent]</span></code>) or the full covariance matrix
(shape <code class="code docutils literal"><span class="pre">[m,</span> <span class="pre">m,</span> <span class="pre">num_latent]</span></code>).
Both tensors have the same dtype.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(tf.Tensor, tf.Tensor)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gptf.core.models.GPModel.build_prior_mean_var">
<code class="descname">build_prior_mean_var</code><span class="sig-paren">(</span><em>test_points</em>, <em>num_latent</em>, <em>full_cov=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/models.html#GPModel.build_prior_mean_var"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.models.GPModel.build_prior_mean_var" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds an op for the mean and variance of the prior(s).</p>
<p>In the returned tensors, the last index should always be the
latent function index.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>test_points</strong> (<em>tf.Tensor</em>) &#8211; The points from the sample
space for which to predict means and variances
of the prior distribution(s). The shape should be
<code class="code docutils literal"><span class="pre">[m,</span> <span class="pre">point_dims]</span></code>.</li>
<li><strong>num_latent</strong> (<em>tf.int32</em>) &#8211; The number of latent functions of
the GP.</li>
<li><strong>full_cov</strong> (<em>bool</em>) &#8211; If <code class="code docutils literal"><span class="pre">False</span></code>, return an array of variances
at the test points. If <code class="code docutils literal"><span class="pre">True</span></code>, return the full
covariance matrix of the posterior distribution.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A tensor that calculates the mean
at the test points with shape <code class="code docutils literal"><span class="pre">[m,</span> <span class="pre">num_latent]</span></code>, a tensor
that calculates either the variances at the test points
(shape <code class="code docutils literal"><span class="pre">[m,</span> <span class="pre">num_latent]</span></code>) or the full covariance matrix
(shape <code class="code docutils literal"><span class="pre">[m,</span> <span class="pre">m,</span> <span class="pre">num_latent]</span></code>).
Both tensors have the same dtype.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(tf.Tensor, tf.Tensor)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gptf.core.models.GPModel.compute_posterior_mean_cov">
<code class="descname">compute_posterior_mean_cov</code><span class="sig-paren">(</span><em>X</em>, <em>Y</em>, <em>test_points</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/models.html#GPModel.compute_posterior_mean_cov"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.models.GPModel.compute_posterior_mean_cov" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the means and full covariance matrices.</p>
<p>This is just an autoflowed version of
<code class="code docutils literal"><span class="pre">.build_predict(X,</span> <span class="pre">Y,</span> <span class="pre">test_points,</span> <span class="pre">full_cov=True)</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>X</strong> (<em>np.ndarray</em>) &#8211; The training inputs, shape <code class="code docutils literal"><span class="pre">[n,</span> <span class="pre">point_dims]</span></code></li>
<li><strong>Y</strong> (<em>np.ndarray</em>) &#8211; The training outputs, shape <code class="code docutils literal"><span class="pre">[n,</span> <span class="pre">num_latent]</span></code></li>
<li><strong>test_points</strong> (<em>np.ndarray</em>) &#8211; The points from the sample
space for which to predict means and variances
of the posterior distribution(s), shape
<code class="code docutils literal"><span class="pre">[m,</span> <span class="pre">point_dims]</span></code>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The means at the test points
(shape <code class="code docutils literal"><span class="pre">[m,</span> <span class="pre">num_latent]</span></code>), the full covriance
matri(x|ces) for the posterior distribution(s)
(shape <code class="code docutils literal"><span class="pre">[m,</span> <span class="pre">m,</span> <span class="pre">num_latent]</span></code>).</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(np.ndarray, np.ndarray)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gptf.core.models.GPModel.compute_posterior_mean_var">
<code class="descname">compute_posterior_mean_var</code><span class="sig-paren">(</span><em>X</em>, <em>Y</em>, <em>test_points</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/models.html#GPModel.compute_posterior_mean_var"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.models.GPModel.compute_posterior_mean_var" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the means and variances of the posterior(s).</p>
<p>This is just an autoflowed version of
<code class="code docutils literal"><span class="pre">.build_posterior_mean_var(X,</span> <span class="pre">Y,</span> <span class="pre">test_points)</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>X</strong> (<em>np.ndarray</em>) &#8211; The training inputs, shape <code class="code docutils literal"><span class="pre">[n,</span> <span class="pre">point_dims]</span></code></li>
<li><strong>Y</strong> (<em>np.ndarray</em>) &#8211; The training outputs, shape <code class="code docutils literal"><span class="pre">[n,</span> <span class="pre">num_latent]</span></code></li>
<li><strong>test_points</strong> (<em>np.ndarray</em>) &#8211; The points from the sample
space for which to predict means and variances
of the posterior distribution(s), shape
<code class="code docutils literal"><span class="pre">[m,</span> <span class="pre">point_dims]</span></code>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The means at the test points
(shape <code class="code docutils literal"><span class="pre">[m,</span> <span class="pre">num_latent]</span></code>), the variances at the test points
(shape <code class="code docutils literal"><span class="pre">[m,</span> <span class="pre">num_latent]</span></code>).</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(np.ndarray, np.ndarray)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gptf.core.models.GPModel.compute_posterior_samples">
<code class="descname">compute_posterior_samples</code><span class="sig-paren">(</span><em>X</em>, <em>Y</em>, <em>test_points</em>, <em>num_samples</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/models.html#GPModel.compute_posterior_samples"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.models.GPModel.compute_posterior_samples" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes samples from the posterior distribution(s).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>X</strong> (<em>np.ndarray</em>) &#8211; The training inputs, shape <code class="code docutils literal"><span class="pre">[n,</span> <span class="pre">point_dims]</span></code></li>
<li><strong>Y</strong> (<em>np.ndarray</em>) &#8211; The training outputs, shape <code class="code docutils literal"><span class="pre">[n,</span> <span class="pre">num_latent]</span></code></li>
<li><strong>test_points</strong> (<em>np.ndarray</em>) &#8211; The points from the sample
space for which to predict means and variances
of the posterior distribution(s), shape
<code class="code docutils literal"><span class="pre">[m,</span> <span class="pre">point_dims]</span></code>.</li>
<li><strong>num_samples</strong> (<em>int</em>) &#8211; The number of samples to take.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">An array of samples from the posterior
distributions, with shape <code class="code docutils literal"><span class="pre">[num_samples,</span> <span class="pre">m,</span> <span class="pre">num_latent]</span></code></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(np.ndarray)</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>For testing purposes, we create an example model whose
likelihood is always <code class="code docutils literal"><span class="pre">0</span></code> and whose <code class="code docutils literal"><span class="pre">.build_predict()</span></code>
returns mean <code class="code docutils literal"><span class="pre">0</span></code> and variance <code class="code docutils literal"><span class="pre">1</span></code> for every test point,
or an independent covariance matrix.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">overrides</span> <span class="k">import</span> <span class="n">overrides</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">gptf</span> <span class="k">import</span> <span class="n">ParamAttributes</span><span class="p">,</span> <span class="n">tfhacks</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Example</span><span class="p">(</span><span class="n">GPModel</span><span class="p">,</span> <span class="n">ParamAttributes</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dtype</span><span class="p">):</span>
<span class="gp">... </span>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">dtype</span>
<span class="gp">... </span>    <span class="nd">@property</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">dtype</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span>
<span class="gp">... </span>    <span class="nd">@dtype</span><span class="o">.</span><span class="n">setter</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">dtype</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">clear_cache</span><span class="p">()</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span> <span class="o">=</span> <span class="n">value</span>
<span class="gp">... </span>    <span class="nd">@tf_method</span><span class="p">()</span>
<span class="gp">... </span>    <span class="nd">@overrides</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">build_log_likelihood</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">NotImplemented</span>
<span class="gp">... </span>    <span class="nd">@tf_method</span><span class="p">()</span>
<span class="gp">... </span>    <span class="nd">@overrides</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">build_prior_mean_var</span>\
<span class="gp">... </span>            <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">test_points</span><span class="p">,</span> <span class="n">num_latent</span><span class="p">,</span> <span class="n">full_cov</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">NotImplemented</span>
<span class="gp">... </span>    <span class="nd">@tf_method</span><span class="p">()</span>
<span class="gp">... </span>    <span class="nd">@overrides</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">build_posterior_mean_var</span>\
<span class="gp">... </span>            <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">test_points</span><span class="p">,</span> <span class="n">full_cov</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="gp">... </span>        <span class="n">n</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">test_points</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">... </span>        <span class="n">num_latent</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">Y</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">... </span>        <span class="n">mu</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">mu</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_latent</span><span class="p">))</span>
<span class="gp">... </span>        <span class="k">if</span> <span class="n">full_cov</span><span class="p">:</span>
<span class="gp">... </span>            <span class="n">var</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">tfhacks</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">... </span>            <span class="n">var</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_latent</span><span class="p">))</span>
<span class="gp">... </span>        <span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>            <span class="n">var</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<span class="gp">... </span>            <span class="n">var</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_latent</span><span class="p">))</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="n">mu</span><span class="p">,</span> <span class="n">var</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">Example</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">.</span><span class="mi">5</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">.</span><span class="mi">3</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">2.</span><span class="p">],</span> <span class="p">[</span><span class="mf">3.</span><span class="p">]])</span>
</pre></div>
</div>
<p>The shape of the returned array is <code class="code docutils literal"><span class="pre">(a,</span> <span class="pre">b,</span> <span class="pre">c)</span></code>, where <code class="code docutils literal"><span class="pre">a</span></code>
is the number of samples, <code class="code docutils literal"><span class="pre">b</span></code> is the number of test points
and <code class="code docutils literal"><span class="pre">c</span></code> is the number of latent functions.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">samples</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">compute_posterior_samples</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">test_points</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">samples</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(2, 4, 1)</span>
</pre></div>
</div>
<p><code class="code docutils literal"><span class="pre">.compute_posterior_samples()</span></code> respects the dtype of the tensors
returned by <code class="code docutils literal"><span class="pre">.build_predict()</span></code>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">samples</span><span class="o">.</span><span class="n">dtype</span>
<span class="go">dtype(&#39;float64&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">float32</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">samples</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">compute_posterior_samples</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">test_points</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">samples</span><span class="o">.</span><span class="n">dtype</span>
<span class="go">dtype(&#39;float32&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="gptf.core.models.GPModel.compute_prior_mean_cov">
<code class="descname">compute_prior_mean_cov</code><span class="sig-paren">(</span><em>test_points</em>, <em>num_latent</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/models.html#GPModel.compute_prior_mean_cov"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.models.GPModel.compute_prior_mean_cov" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the means and full covariance matrices.</p>
<p>This is just an autoflowed version of
<code class="code docutils literal"><span class="pre">.build_prior_mean_var(test_points,</span> <span class="pre">num_latent,</span> <span class="pre">True)</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>test_points</strong> (<em>np.ndarray</em>) &#8211; The points from the sample
space for which to predict means and variances
of the prior distribution(s). The shape should be
<code class="code docutils literal"><span class="pre">[m,</span> <span class="pre">point_dims]</span></code>.</li>
<li><strong>num_latent</strong> (<em>int</em>) &#8211; The number of latent functions of the GP.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The means at the test points
(shape <code class="code docutils literal"><span class="pre">[m,</span> <span class="pre">num_latent]</span></code>), the full covariance
matri(x|ces) for the prior distribution(s) (shape
<code class="code docutils literal"><span class="pre">[m,</span> <span class="pre">m,</span> <span class="pre">num_latent]</span></code>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(np.ndarray, np.ndarray)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gptf.core.models.GPModel.compute_prior_mean_var">
<code class="descname">compute_prior_mean_var</code><span class="sig-paren">(</span><em>test_points</em>, <em>num_latent</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/models.html#GPModel.compute_prior_mean_var"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.models.GPModel.compute_prior_mean_var" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the means and variances of the prior(s).</p>
<p>This is just an autoflowed version of
<code class="code docutils literal"><span class="pre">.build_prior_mean_var(test_points,</span> <span class="pre">num_latent)</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>test_points</strong> (<em>np.ndarray</em>) &#8211; The points from the sample
space for which to predict means and variances
of the prior distribution(s). The shape should be
<code class="code docutils literal"><span class="pre">[m,</span> <span class="pre">point_dims]</span></code>.</li>
<li><strong>num_latent</strong> (<em>int</em>) &#8211; The number of latent functions of the GP.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">the mean at the test points
(shape <code class="code docutils literal"><span class="pre">[m,</span> <span class="pre">num_latent]</span></code>), the variances at the test
points (shape <code class="code docutils literal"><span class="pre">[m,</span> <span class="pre">num_latent]</span></code>).</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(np.ndarray, np.ndarray)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gptf.core.models.GPModel.compute_prior_samples">
<code class="descname">compute_prior_samples</code><span class="sig-paren">(</span><em>test_points</em>, <em>num_latent</em>, <em>num_samples</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/models.html#GPModel.compute_prior_samples"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.models.GPModel.compute_prior_samples" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes samples from the prior distribution(s).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>test_points</strong> (<em>np.ndarray</em>) &#8211; The points from the sample
space for which to predict means and variances
of the posterior distribution(s), shape
<code class="code docutils literal"><span class="pre">[m,</span> <span class="pre">point_dims]</span></code>.</li>
<li><strong>num_latent</strong> (<em>int</em>) &#8211; The number of latent functions of the GP.</li>
<li><strong>num_samples</strong> (<em>int</em>) &#8211; The number of samples to take.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">An array of samples from the prior
distributions, with shape <code class="code docutils literal"><span class="pre">[num_samples,</span> <span class="pre">m,</span> <span class="pre">num_latent]</span></code></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(np.ndarray)</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>For testing purposes, we create an example model whose
likelihood is always <code class="code docutils literal"><span class="pre">0</span></code> and whose <code class="code docutils literal"><span class="pre">.build_predict()</span></code>
returns mean <code class="code docutils literal"><span class="pre">0</span></code> and variance <code class="code docutils literal"><span class="pre">1</span></code> for every test point,
or an independent covariance matrix.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">overrides</span> <span class="k">import</span> <span class="n">overrides</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">gptf</span> <span class="k">import</span> <span class="n">ParamAttributes</span><span class="p">,</span> <span class="n">tfhacks</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Example</span><span class="p">(</span><span class="n">GPModel</span><span class="p">,</span> <span class="n">ParamAttributes</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dtype</span><span class="p">):</span>
<span class="gp">... </span>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">dtype</span>
<span class="gp">... </span>    <span class="nd">@property</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">dtype</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span>
<span class="gp">... </span>    <span class="nd">@dtype</span><span class="o">.</span><span class="n">setter</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">dtype</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">clear_cache</span><span class="p">()</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span> <span class="o">=</span> <span class="n">value</span>
<span class="gp">... </span>    <span class="nd">@tf_method</span><span class="p">()</span>
<span class="gp">... </span>    <span class="nd">@overrides</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">build_log_likelihood</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">NotImplemented</span>
<span class="gp">... </span>    <span class="nd">@tf_method</span><span class="p">()</span>
<span class="gp">... </span>    <span class="nd">@overrides</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">build_prior_mean_var</span>\
<span class="gp">... </span>            <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">test_points</span><span class="p">,</span> <span class="n">num_latent</span><span class="p">,</span> <span class="n">full_cov</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="gp">... </span>        <span class="n">n</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">test_points</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">... </span>        <span class="n">mu</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">mu</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_latent</span><span class="p">))</span>
<span class="gp">... </span>        <span class="k">if</span> <span class="n">full_cov</span><span class="p">:</span>
<span class="gp">... </span>            <span class="n">var</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">tfhacks</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">... </span>            <span class="n">var</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_latent</span><span class="p">))</span>
<span class="gp">... </span>        <span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>            <span class="n">var</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<span class="gp">... </span>            <span class="n">var</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_latent</span><span class="p">))</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="n">mu</span><span class="p">,</span> <span class="n">var</span>
<span class="gp">... </span>    <span class="nd">@tf_method</span><span class="p">()</span>
<span class="gp">... </span>    <span class="nd">@overrides</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">build_posterior_mean_var</span>\
<span class="gp">... </span>            <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">test_points</span><span class="p">,</span> <span class="n">full_cov</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">NotImplemented</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">Example</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>  <span class="c1"># ignore the likelihood</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">2.</span><span class="p">],</span> <span class="p">[</span><span class="mf">3.</span><span class="p">]])</span>
</pre></div>
</div>
<p>The shape of the returned array is <code class="code docutils literal"><span class="pre">(a,</span> <span class="pre">b,</span> <span class="pre">c)</span></code>, where <code class="code docutils literal"><span class="pre">a</span></code>
is the number of samples, <code class="code docutils literal"><span class="pre">b</span></code> is the number of test points
and <code class="code docutils literal"><span class="pre">c</span></code> is the number of latent functions.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">samples</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">compute_prior_samples</span><span class="p">(</span><span class="n">test_points</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">samples</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(2, 4, 1)</span>
</pre></div>
</div>
<p><code class="code docutils literal"><span class="pre">.compute_prior_samples()</span></code> respects the dtype of the tensors
returned by <code class="code docutils literal"><span class="pre">.build_predict()</span></code>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">samples</span><span class="o">.</span><span class="n">dtype</span>
<span class="go">dtype(&#39;float64&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">float32</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">samples</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">compute_prior_samples</span><span class="p">(</span><span class="n">test_points</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">samples</span><span class="o">.</span><span class="n">dtype</span>
<span class="go">dtype(&#39;float32&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="gptf.core.models.GPModel.predict_density">
<code class="descname">predict_density</code><span class="sig-paren">(</span><em>test_points</em>, <em>test_values</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/models.html#GPModel.predict_density"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.models.GPModel.predict_density" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the (log) density of the test values at the test points.</p>
</dd></dl>

<dl class="method">
<dt id="gptf.core.models.GPModel.predict_y">
<code class="descname">predict_y</code><span class="sig-paren">(</span><em>test_points</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/models.html#GPModel.predict_y"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.models.GPModel.predict_y" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the mean and variance of held-out data.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="gptf.core.models.Model">
<em class="property">class </em><code class="descclassname">gptf.core.models.</code><code class="descname">Model</code><a class="reference internal" href="_modules/gptf/core/models.html#Model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.models.Model" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gptf.core.params.Parameterized" title="gptf.core.params.Parameterized"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.params.Parameterized</span></code></a></p>
<p>Base class for models.</p>
<p>Inheriting classes must define <code class="code docutils literal"><span class="pre">.build_log_likelihood(self)</span></code>.</p>
<p><code class="code docutils literal"><span class="pre">Param</span></code> and <code class="code docutils literal"><span class="pre">Parameterized</span></code> objects that are children of the model
can be used in the tensorflow expression. Children on the model are
defined like so:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">overrides</span> <span class="k">import</span> <span class="n">overrides</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">gptf</span> <span class="k">import</span> <span class="n">Param</span><span class="p">,</span> <span class="n">ParamAttributes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Example</span><span class="p">(</span><span class="n">Model</span><span class="p">,</span> <span class="n">ParamAttributes</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="mf">1.</span><span class="p">)</span>  <span class="c1"># create new Param child</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="nd">@tf_method</span><span class="p">()</span>
<span class="gp">... </span>    <span class="nd">@overrides</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">build_log_likelihood</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="mi">3</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">tensor</span>  <span class="c1"># use Param in expression</span>
</pre></div>
</div>
<p>The <code class="code docutils literal"><span class="pre">.optimize</span></code> method can be used to optimize the parameters of the
model to minimise the likelihood. The loss function (the negative of
the sum of the likelihood and any priors) is cached in the WrappedTF
cache, and lazily recompiled when the cache is cleared, e.g. on
recompile.</p>
<dl class="method">
<dt id="gptf.core.models.Model.build_log_likelihood">
<code class="descname">build_log_likelihood</code><span class="sig-paren">(</span><em>X</em>, <em>Y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/models.html#Model.build_log_likelihood"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.models.Model.build_log_likelihood" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds the log likelihood of the model w.r.t. the data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>X</strong> (<em>tf.Tensor</em>) &#8211; The training inputs.</li>
<li><strong>Y</strong> (<em>tf.Tensor</em>) &#8211; The training outputs.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A tensor that, when run, calculates the log
likelihood of the model.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(tf.Tensor)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gptf.core.models.Model.build_log_prior">
<code class="descname">build_log_prior</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/models.html#Model.build_log_prior"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.models.Model.build_log_prior" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="gptf.core.models.Model.compute_log_likelihood">
<code class="descname">compute_log_likelihood</code><span class="sig-paren">(</span><em>X</em>, <em>Y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/models.html#Model.compute_log_likelihood"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.models.Model.compute_log_likelihood" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the likelihood of the model w.r.t. the data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The log likelihood of the model.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(np.ndarray)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gptf.core.models.Model.compute_log_prior">
<code class="descname">compute_log_prior</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/models.html#Model.compute_log_prior"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.models.Model.compute_log_prior" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="gptf.core.models.Model.optimize">
<code class="descname">optimize</code><span class="sig-paren">(</span><em>X</em>, <em>Y</em>, <em>method='L-BFGS-B'</em>, <em>callback=None</em>, <em>maxiter=1000</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/models.html#Model.optimize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.models.Model.optimize" title="Permalink to this definition">¶</a></dt>
<dd><p>Optimize the model by maximising the log likelihood.</p>
<p>Maximises the sum of the log likelihood given X &amp; Y and any
priors with respect to any free variables.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>X</strong> (<em>np.ndarray | tf.Tensor</em>) &#8211; The training inputs.</li>
<li><strong>Y</strong> (<em>np.ndarray | tf.Tensor</em>) &#8211; The training outputs.</li>
<li><strong>method</strong> (<em>tf.train.Optimizer | str</em>) &#8211; The means by which to
optimise. If <code class="code docutils literal"><span class="pre">method</span></code> is a string, it will be passed as
the <code class="code docutils literal"><span class="pre">method</span></code> argument to the initialiser of
<code class="code docutils literal"><span class="pre">tf.contrib.opt.ScipyOptimizerInterface</span></code>. Else, it
will be treated as an instance of <code class="code docutils literal"><span class="pre">tf.train.Optimizer</span></code>
and its <code class="code docutils literal"><span class="pre">.minimize()</span></code> method will be used as the training
step.</li>
<li><strong>callback</strong> (<em>Callable[[np.ndarray], ...]</em>) &#8211; A function that will
be called at each optimization step with the current value
of the variable vector (a vector constructed by flattening
the free state of each free <code class="code docutils literal"><span class="pre">Param</span></code> and then concatenating
them in the order the <code class="code docutils literal"><span class="pre">Param</span></code>s are returned by <code class="code docutils literal"><span class="pre">.params</span></code>.</li>
<li><strong>maxiter</strong> (<em>int</em>) &#8211; The maximum number of iterations of the optimizer.</li>
<li><strong>**kw</strong> &#8211; Additional keyword arguments are passed through to the
optimizer.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">(scipy.OptimizeResult) The result of the optimisation.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>Let&#8217;s construct a very simple model for demonstration
purposes. It has two (scalar) parameters, <code class="code docutils literal"><span class="pre">.a</span></code> and <code class="code docutils literal"><span class="pre">.b</span></code>,
which are constrained to be positive, and its likelihood is
<code class="code docutils literal"><span class="pre">10</span> <span class="pre">-</span> <span class="pre">a</span> <span class="pre">-</span> <span class="pre">b</span></code>, regardless of X and Y.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numbers</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">overrides</span> <span class="k">import</span> <span class="n">overrides</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">gptf</span> <span class="k">import</span> <span class="n">Param</span><span class="p">,</span> <span class="n">ParamAttributes</span><span class="p">,</span> <span class="n">transforms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Example</span><span class="p">(</span><span class="n">Model</span><span class="p">,</span> <span class="n">ParamAttributes</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">numbers</span><span class="o">.</span><span class="n">Number</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">numbers</span><span class="o">.</span><span class="n">Number</span><span class="p">)</span>
<span class="gp">... </span>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">transforms</span><span class="o">.</span><span class="n">Exp</span><span class="p">(</span><span class="mf">0.</span><span class="p">))</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">transforms</span><span class="o">.</span><span class="n">Exp</span><span class="p">(</span><span class="mf">0.</span><span class="p">))</span>
<span class="gp">... </span>    <span class="nd">@tf_method</span><span class="p">()</span>
<span class="gp">... </span>    <span class="nd">@overrides</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">build_log_likelihood</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="mf">10.</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">tensor</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">tensor</span>
</pre></div>
</div>
<p>We won&#8217;t care about the values of X and Y.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">0.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">0.</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">TensorFlow optimizers</p>
<p>We can optimise the parameters of the model using a TensorFlow
optimizer like so:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">Example</span><span class="p">(</span><span class="mf">3.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">opt</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">GradientDescentOptimizer</span><span class="p">(</span><span class="n">learning_rate</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">opt</span><span class="p">)</span>  <span class="c1"># use None for X, Y</span>
<span class="go">message: &#39;Finished iterations.&#39;</span>
<span class="go">success: True</span>
<span class="go">      x: array([..., ...])</span>
</pre></div>
</div>
<p>After the optimisation, both parameters are optimised
towards 0, but are still positive. The constraints on the
parameters have been respected.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;m.a: </span><span class="si">{:.3f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asscalar</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">value</span><span class="p">)))</span>
<span class="go">m.a: 0.001</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;m.b: </span><span class="si">{:.3f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asscalar</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">value</span><span class="p">)))</span>
<span class="go">m.b: 0.001</span>
</pre></div>
</div>
<p>If we fix a parameter, it is not optimized:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="mf">5.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="mf">1.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">fixed</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">opt</span><span class="p">)</span>
<span class="go">message: &#39;Finished iterations.&#39;</span>
<span class="go">success: True</span>
<span class="go">      x: array([...])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;m.a: </span><span class="si">{:.3f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asscalar</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">value</span><span class="p">)))</span>
<span class="go">m.a: 0.001</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;m.b: </span><span class="si">{:.3f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asscalar</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">value</span><span class="p">)))</span>
<span class="go">m.b: 1.000</span>
</pre></div>
</div>
<p class="rubric">SciPy optimizers</p>
<p>We can optimise the parameters of the model using a SciPy
optimizer by provided a string value for <code class="code docutils literal"><span class="pre">method</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">Example</span><span class="p">(</span><span class="mf">3.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="s1">&#39;L-BFGS-B&#39;</span><span class="p">,</span> <span class="n">disp</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ftol</span><span class="o">=.</span><span class="mi">0001</span><span class="p">)</span>
<span class="go">message: &#39;SciPy optimizer completed successfully.&#39;</span>
<span class="go">success: True</span>
<span class="go">      x: array([..., ...])</span>
</pre></div>
</div>
<p>As for TensorFlow optimizers, after the optimisation both
parameters are optimised towards 0, but are still positive.
The constraints on the parameters have been respected.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;m.a: </span><span class="si">{:.3f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asscalar</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">value</span><span class="p">)))</span>
<span class="go">m.a: 0.000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;m.b: </span><span class="si">{:.3f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asscalar</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">value</span><span class="p">)))</span>
<span class="go">m.b: 0.000</span>
</pre></div>
</div>
<p>If we fix a parameter, it is not optimized:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="mf">5.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="mf">1.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">fixed</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="s1">&#39;L-BFGS-B&#39;</span><span class="p">,</span> <span class="n">disp</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ftol</span><span class="o">=.</span><span class="mi">0001</span><span class="p">)</span>
<span class="go">message: &#39;SciPy optimizer completed successfully.&#39;</span>
<span class="go">success: True</span>
<span class="go">      x: array([...])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;m.a: </span><span class="si">{:.3f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asscalar</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">value</span><span class="p">)))</span>
<span class="go">m.a: 0.000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;m.b: </span><span class="si">{:.3f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asscalar</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">value</span><span class="p">)))</span>
<span class="go">m.b: 1.000</span>
</pre></div>
</div>
<p class="rubric">Miscellaneous</p>
<p>Optimisation still works, even with weird device contexts and
session targets.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># set up a distributed execution environment</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clusterdict</span> <span class="o">=</span> \
<span class="gp">... </span>    <span class="p">{</span> <span class="s1">&#39;worker&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;localhost:2226&#39;</span><span class="p">]</span>
<span class="gp">... </span>    <span class="p">,</span> <span class="s1">&#39;master&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;localhost:2227&#39;</span><span class="p">]</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spec</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">ClusterSpec</span><span class="p">(</span><span class="n">clusterdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">worker</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">Server</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="n">job_name</span><span class="o">=</span><span class="s1">&#39;worker&#39;</span><span class="p">,</span> <span class="n">task_index</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">worker</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">master</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">Server</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="n">job_name</span><span class="o">=</span><span class="s1">&#39;master&#39;</span><span class="p">,</span> <span class="n">task_index</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># change m&#39;s device context</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># we&#39;re about to do weird things with op placement, and we</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># don&#39;t want it in the default graph where it can mess with</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># other doctests, so change m&#39;s tf_graph as well.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">tf_graph</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Graph</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">tf_device</span> <span class="o">=</span> <span class="s1">&#39;/job:worker/task:0&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">tf_session_target</span> <span class="o">=</span> <span class="n">master</span><span class="o">.</span><span class="n">target</span>
</pre></div>
</div>
<p>TensorFlow:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="mf">4.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">opt</span><span class="p">)</span>
<span class="go">message: &#39;Finished iterations.&#39;</span>
<span class="go">success: True</span>
<span class="go">      x: array([...])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;m.a: </span><span class="si">{:.3f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asscalar</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">value</span><span class="p">)))</span>
<span class="go">m.a: 0.001</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;m.b: </span><span class="si">{:.3f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asscalar</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">value</span><span class="p">)))</span>
<span class="go">m.b: 1.000</span>
</pre></div>
</div>
<p>SciPy:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="mf">4.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="s1">&#39;L-BFGS-B&#39;</span><span class="p">,</span> <span class="n">disp</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ftol</span><span class="o">=.</span><span class="mi">0001</span><span class="p">)</span>
<span class="go">message: &#39;SciPy optimizer completed successfully.&#39;</span>
<span class="go">success: True</span>
<span class="go">      x: array([...])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;m.a: </span><span class="si">{:.3f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asscalar</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">value</span><span class="p">)))</span>
<span class="go">m.a: 0.001</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;m.b: </span><span class="si">{:.3f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asscalar</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">value</span><span class="p">)))</span>
<span class="go">m.b: 1.000</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-gptf.core.params">
<span id="gptf-core-params-module"></span><h2>gptf.core.params module<a class="headerlink" href="#module-gptf.core.params" title="Permalink to this headline">¶</a></h2>
<p>Provides classes that deal with the fetching as setting of parameters.</p>
<dl class="exception">
<dt id="gptf.core.params.DTypeChangeError">
<em class="property">exception </em><code class="descclassname">gptf.core.params.</code><code class="descname">DTypeChangeError</code><a class="reference internal" href="_modules/gptf/core/params.html#DTypeChangeError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.params.DTypeChangeError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">Exception</span></code></p>
<p>Raised when the dtype of a Param or DataHolder changes.</p>
</dd></dl>

<dl class="class">
<dt id="gptf.core.params.DataHolder">
<em class="property">class </em><code class="descclassname">gptf.core.params.</code><code class="descname">DataHolder</code><span class="sig-paren">(</span><em>initial_value</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/params.html#DataHolder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.params.DataHolder" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gptf.core.params.ProxyWrappedValue" title="gptf.core.params.ProxyWrappedValue"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.params.ProxyWrappedValue</span></code></a>, <a class="reference internal" href="#gptf.core.trees.Leaf" title="gptf.core.trees.Leaf"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.trees.Leaf</span></code></a></p>
<p>Holds data to be fed into TensorFlow for computation.</p>
<dl class="attribute">
<dt id="gptf.core.params.DataHolder.value">
<code class="descname">value</code><a class="headerlink" href="#gptf.core.params.DataHolder.value" title="Permalink to this definition">¶</a></dt>
<dd><p><em>np.ndarray</em> &#8211; The value of the data.</p>
</dd></dl>

<dl class="attribute">
<dt id="gptf.core.params.DataHolder.tensor">
<code class="descname">tensor</code><a class="headerlink" href="#gptf.core.params.DataHolder.tensor" title="Permalink to this definition">¶</a></dt>
<dd><p><em>tf.placeholder</em> &#8211; A placeholder for the data,
suitable for passing to TensorFlow ops.</p>
</dd></dl>

<dl class="attribute">
<dt id="gptf.core.params.DataHolder.feed_dict">
<code class="descname">feed_dict</code><a class="headerlink" href="#gptf.core.params.DataHolder.feed_dict" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Dict[tf.placeholder, np.array_like]</em> &#8211; A feed dictionary
that feeds the value of the data into the placeholder op.</p>
</dd></dl>

<dl class="attribute">
<dt id="gptf.core.params.DataHolder.on_shape_change">
<code class="descname">on_shape_change</code><a class="headerlink" href="#gptf.core.params.DataHolder.on_shape_change" title="Permalink to this definition">¶</a></dt>
<dd><p><em>&#8216;raise&#8217; | &#8216;pass&#8217; | &#8216;recompile&#8217;</em> &#8211; The action to take
when the shape of the data changes; see the setter for <code class="code docutils literal"><span class="pre">.value</span></code>.</p>
</dd></dl>

<p class="rubric">Examples</p>
<p class="rubric">Getting and setting values</p>
<p>To get and set the value of the data, use the <code class="code docutils literal"><span class="pre">.value</span></code> property:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">DataHolder</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">value</span>
<span class="go">array([1, 2, 3])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">b</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">value</span>
<span class="go">array([4, 5, 6])</span>
</pre></div>
</div>
<p>See the docs for <code class="code docutils literal"><span class="pre">gptf.core.params.WrappedValue</span></code> for more info.</p>
<p>To access the value from TensorFlow, first build an op that relies
on the <code class="code docutils literal"><span class="pre">.tensor</span></code> attribute:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">DataHolder</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">op</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">tensor</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Then evaluate the op in a session, passing in the feed dictionary
to <code class="code docutils literal"><span class="pre">tf.Session.run()</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">d</span><span class="o">.</span><span class="n">get_session</span><span class="p">()</span> <span class="k">as</span> <span class="n">sess</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">feed_dict</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">feed_dict</span><span class="p">)</span>
<span class="go">array([2, 3, 4])</span>
</pre></div>
</div>
<p class="rubric">Copies</p>
<p>You can create a copy of a <code class="code docutils literal"><span class="pre">DataHolder</span></code> using <code class="code docutils literal"><span class="pre">.copy()</span></code>. The
new copy represents the same data, so the value and
various items of state (see below) are the same.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">DataHolder</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">copy</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
<p>Copies have the same value as the original, and updating the
value of the copy updates the value of the original.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">copy</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="p">[</span><span class="mf">5.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">copy</span><span class="o">.</span><span class="n">value</span>
<span class="go">array([ 5., 4., 3.])</span>
</pre></div>
</div>
<p>Copies have the same placeholder.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">tensor</span> <span class="ow">is</span> <span class="n">copy</span><span class="o">.</span><span class="n">tensor</span>
<span class="go">True</span>
</pre></div>
</div>
<p>This means that it, just in the case of <code class="code docutils literal"><span class="pre">Param</span></code>s, it is
<em>very important</em> that every copy of a <code class="code docutils literal"><span class="pre">DataHolder</span></code> has the
same device context and graph, or odd things happen.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">AttributeWrappedTF</span><span class="p">(</span><span class="n">AttributeTree</span><span class="p">,</span> <span class="n">WrappedTF</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">pass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">treedata</span> <span class="o">=</span> <span class="n">DataHolder</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span> <span class="o">=</span> <span class="n">AttributeWrappedTF</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span><span class="o">.</span><span class="n">param</span> <span class="o">=</span> <span class="n">treedata</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span><span class="o">.</span><span class="n">child</span> <span class="o">=</span> <span class="n">AttributeWrappedTF</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span><span class="o">.</span><span class="n">child</span><span class="o">.</span><span class="n">param</span> <span class="o">=</span> <span class="n">treedata</span>  <span class="c1"># creates a copy of the data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span><span class="o">.</span><span class="n">tf_graph</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Graph</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span><span class="o">.</span><span class="n">tf_device</span> <span class="o">=</span> <span class="s1">&#39;/job:spoon/task:0&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span><span class="o">.</span><span class="n">child</span><span class="o">.</span><span class="n">tf_device</span> <span class="o">=</span> <span class="s1">&#39;/job:knife/task:0&#39;</span>
</pre></div>
</div>
<p>In circumstances like the above, where copies have
conflicting parental device contexts, set the device
context explicitly.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">treedata</span><span class="o">.</span><span class="n">tf_device</span> <span class="o">=</span> <span class="s1">&#39;/job:spoon&#39;</span>
</pre></div>
</div>
<p>To create a new dataholder with the same value, pass the value
to <code class="code docutils literal"><span class="pre">DataHolder.__init__()</span></code>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">notacopy</span> <span class="o">=</span> <span class="n">DataHolder</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</pre></div>
</div>
<dl class="attribute">
<dt>
<code class="descname">feed_dict</code></dt>
<dd><p>A dict that feeds the value of the data into its placeholder.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">tensor</code></dt>
<dd><p>The placeholder that the data will be fed into.</p>
</dd></dl>

</dd></dl>

<dl class="exception">
<dt id="gptf.core.params.FixedParameterError">
<em class="property">exception </em><code class="descclassname">gptf.core.params.</code><code class="descname">FixedParameterError</code><a class="reference internal" href="_modules/gptf/core/params.html#FixedParameterError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.params.FixedParameterError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">Exception</span></code></p>
<p>Raised when the free state of a fixed parameter is accessed.</p>
</dd></dl>

<dl class="class">
<dt id="gptf.core.params.Param">
<em class="property">class </em><code class="descclassname">gptf.core.params.</code><code class="descname">Param</code><span class="sig-paren">(</span><em>initial_value</em>, <em>transform=gptf.core.transforms.Identity()</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/params.html#Param"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.params.Param" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gptf.core.params.ProxyWrappedValue" title="gptf.core.params.ProxyWrappedValue"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.params.ProxyWrappedValue</span></code></a>, <a class="reference internal" href="#gptf.core.trees.Leaf" title="gptf.core.trees.Leaf"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.trees.Leaf</span></code></a></p>
<p>A parameter of a model.</p>
<p>Instances have all attributes of <code class="code docutils literal"><span class="pre">WrappedValue</span></code> and the following:</p>
<dl class="attribute">
<dt id="gptf.core.params.Param.value">
<code class="descname">value</code><a class="headerlink" href="#gptf.core.params.Param.value" title="Permalink to this definition">¶</a></dt>
<dd><p><em>np.ndarray</em> &#8211; The value of the parameter.</p>
</dd></dl>

<dl class="attribute">
<dt id="gptf.core.params.Param.tensor">
<code class="descname">tensor</code><a class="headerlink" href="#gptf.core.params.Param.tensor" title="Permalink to this definition">¶</a></dt>
<dd><p><em>tf.Tensor</em> &#8211; A tensor representation of the parameter,
suitable for passing to TensorFlow ops.</p>
</dd></dl>

<dl class="attribute">
<dt id="gptf.core.params.Param.feed_dict">
<code class="descname">feed_dict</code><a class="headerlink" href="#gptf.core.params.Param.feed_dict" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Dict</em> &#8211; Currently an empty dictionary.</p>
</dd></dl>

<dl class="attribute">
<dt id="gptf.core.params.Param.free_state">
<code class="descname">free_state</code><a class="headerlink" href="#gptf.core.params.Param.free_state" title="Permalink to this definition">¶</a></dt>
<dd><p><em>tf.Variable</em> &#8211; The free state form of the parameter, that
can be freely optimised.</p>
</dd></dl>

<dl class="attribute">
<dt id="gptf.core.params.Param.fixed">
<code class="descname">fixed</code><a class="headerlink" href="#gptf.core.params.Param.fixed" title="Permalink to this definition">¶</a></dt>
<dd><p><em>bool</em> &#8211; A flag indicating whether or not the variable is fixed.
Fixed parameters will not be optimised.</p>
</dd></dl>

<dl class="attribute">
<dt id="gptf.core.params.Param.transform">
<code class="descname">transform</code><a class="headerlink" href="#gptf.core.params.Param.transform" title="Permalink to this definition">¶</a></dt>
<dd><p><em>.transforms.Transform</em> &#8211; The transform used to move the
variable into a free state where it can be optimised.</p>
</dd></dl>

<p class="rubric">Examples</p>
<p class="rubric">Getting and setting values</p>
<p>You can get and set the (numpy) value of a <code class="code docutils literal"><span class="pre">Param</span></code> using its
<code class="code docutils literal"><span class="pre">value</span></code> attribute:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">value</span>
<span class="go">array(1.0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">value</span>
<span class="go">array(2.0)</span>
</pre></div>
</div>
<p>A tensor representing the paremeter can be acquired using the
<code class="code docutils literal"><span class="pre">tensor</span></code> attribute.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">tensor</span><span class="p">,</span> <span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">p</span><span class="o">.</span><span class="n">get_session</span><span class="p">()</span> <span class="k">as</span> <span class="n">sess</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">tensor</span><span class="p">))</span>
<span class="go">2.0</span>
</pre></div>
</div>
<p>Behind the scenes, this creates a <code class="code docutils literal"><span class="pre">tf.Variable</span></code>, accessible using the
<code class="code docutils literal"><span class="pre">free_state</span></code> attribute. We can use this variable in a session like so:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">p</span><span class="o">.</span><span class="n">get_session</span><span class="p">()</span> <span class="k">as</span> <span class="n">sess</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;.free_state: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">free_state</span><span class="p">)))</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;.value: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
<span class="gp">... </span>    <span class="c1"># assigning to p.value changes p.free_state</span>
<span class="gp">... </span>    <span class="n">p</span><span class="o">.</span><span class="n">value</span> <span class="o">+=</span> <span class="mf">1.0</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;.free_state: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">free_state</span><span class="p">)))</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;.value: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
<span class="gp">... </span>    <span class="c1"># assigning to p.free_state changes p.value</span>
<span class="gp">... </span>    <span class="n">_</span> <span class="o">=</span> <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">free_state</span><span class="o">.</span><span class="n">assign_add</span><span class="p">(</span><span class="mf">1.0</span><span class="p">))</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;.free_state: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">free_state</span><span class="p">)))</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;.value: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
<span class="go">.free_state: 2.0</span>
<span class="go">.value: 2.0</span>
<span class="go">.free_state: 3.0</span>
<span class="go">.value: 3.0</span>
<span class="go">.free_state: 4.0</span>
<span class="go">.value: 4.0</span>
</pre></div>
</div>
<p>The session returned by <code class="code docutils literal"><span class="pre">p.get_session()</span></code> maintains the value of
<code class="code docutils literal"><span class="pre">p.free_state</span></code> across uses:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">p</span><span class="o">.</span><span class="n">get_session</span><span class="p">()</span> <span class="k">as</span> <span class="n">sess</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">free_state</span><span class="p">))</span>
<span class="go">4.0</span>
</pre></div>
</div>
<p>If we have multiple <code class="code docutils literal"><span class="pre">Param</span></code>s, as long as they are in the same
tree of <code class="code docutils literal"><span class="pre">WrappedTF</span></code>, each <code class="code docutils literal"><span class="pre">Param</span></code>&#8216;s <code class="code docutils literal"><span class="pre">.get_session()</span></code> will return
the same session, and every <code class="code docutils literal"><span class="pre">Param</span></code> in the tree will have its free
state maintained in that session.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">AttributeWrappedTF</span><span class="p">(</span><span class="n">WrappedTF</span><span class="p">,</span> <span class="n">AttributeTree</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">pass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span> <span class="o">=</span> <span class="n">AttributeWrappedTF</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span><span class="o">.</span><span class="n">p</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span><span class="o">.</span><span class="n">q</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">w</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">get_session</span><span class="p">()</span> <span class="k">as</span> <span class="n">sess</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">free_state</span><span class="p">))</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">q</span><span class="o">.</span><span class="n">free_state</span><span class="p">))</span>
<span class="go">1.0</span>
<span class="go">2.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">w</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">get_session</span><span class="p">()</span> <span class="k">as</span> <span class="n">sess</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">free_state</span><span class="p">))</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">q</span><span class="o">.</span><span class="n">free_state</span><span class="p">))</span>
<span class="go">1.0</span>
<span class="go">2.0</span>
</pre></div>
</div>
<p>It is possible to use <code class="code docutils literal"><span class="pre">tf.Session()</span></code> instead of <code class="code docutils literal"><span class="pre">p.get_session()</span></code>.
In that case, we must run <code class="code docutils literal"><span class="pre">p.on_session_birth()</span></code> after the session
has been installed as the default session and <code class="code docutils literal"><span class="pre">p.on_session_death()</span></code>
just before the session closes.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="mf">4.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">tf</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span> <span class="k">as</span> <span class="n">sess</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">p</span><span class="o">.</span><span class="n">on_session_birth</span><span class="p">(</span><span class="n">sess</span><span class="p">)</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;.free_state: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">free_state</span><span class="p">)))</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;.value: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
<span class="gp">... </span>    <span class="c1"># assiging to p.value changes p.free_state</span>
<span class="gp">... </span>    <span class="n">p</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="o">.</span><span class="mi">0</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;.free_state: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">free_state</span><span class="p">)))</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;.value: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
<span class="gp">... </span>    <span class="c1"># assigning to p.free_state does not change p.value</span>
<span class="gp">... </span>    <span class="n">_</span> <span class="o">=</span> <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">free_state</span><span class="o">.</span><span class="n">assign_add</span><span class="p">(</span><span class="mf">1.0</span><span class="p">))</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;.free_state: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">free_state</span><span class="p">)))</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;.value: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
<span class="gp">... </span>    <span class="n">p</span><span class="o">.</span><span class="n">on_session_death</span><span class="p">(</span><span class="n">sess</span><span class="p">)</span>
<span class="go">.free_state: 4.0</span>
<span class="go">.value: 4.0</span>
<span class="go">.free_state: 0.0</span>
<span class="go">.value: 0.0</span>
<span class="go">.free_state: 1.0</span>
<span class="go">.value: 1.0</span>
</pre></div>
</div>
<p>We advise the reader to use <code class="code docutils literal"><span class="pre">p.get_session()</span></code>.</p>
<p>Attempting to set the tensor or free_state paremeters results in an
error:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">tensor</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
    <span class="o">...</span>
<span class="gr">AttributeError</span>: <span class="n">can&#39;t set attribute</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">free_state</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
    <span class="o">...</span>
<span class="gr">AttributeError</span>: <span class="n">can&#39;t set attribute</span>
</pre></div>
</div>
<p class="rubric">Fixing parameters</p>
<p>A parameter can be fixed by setting the <code class="code docutils literal"><span class="pre">.fixed</span></code> attribute to <code class="code docutils literal"><span class="pre">True</span></code>.
A fixed parameter should not be optimised. Attempting to
access the <code class="code docutils literal"><span class="pre">.free_state</span></code> attribute of a fixed parameter will result
in a <code class="code docutils literal"><span class="pre">FixedParameterError</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">fixed</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">free_state</span>
<span class="gt">Traceback (most recent call last):</span>
    <span class="o">...</span>
<span class="gr">gptf.core.params.FixedParameterError</span>: <span class="n">message</span>
</pre></div>
</div>
<p>Ultimately, however, it is the responsibility of the optimiser to
respect this flag. See the <code class="code docutils literal"><span class="pre">Parameterised</span></code> and <code class="code docutils literal"><span class="pre">Model</span></code> classes for
more details.</p>
<p class="rubric">Transforms</p>
<p>Constraints can be applied to a parameter in the form of <code class="code docutils literal"><span class="pre">Transform</span></code>s.
A <code class="code docutils literal"><span class="pre">Transform</span></code> is used to transform the parameter into a free state,
where it can then be optimized. The transform can be set either by
specifying <code class="code docutils literal"><span class="pre">transform</span></code> paramater of the constructor or after creation
using the <code class="code docutils literal"><span class="pre">.transform</span></code> attribute. The default transform is
<code class="code docutils literal"><span class="pre">gptf.transforms.Identity</span></code>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">gptf</span> <span class="k">import</span> <span class="n">transforms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Param</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span>
<span class="go">gptf.core.transforms.Identity()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">transforms</span><span class="o">.</span><span class="n">Exp</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">transform</span>
<span class="go">gptf.core.transforms.Exp(lower=1e-06)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">transform</span> <span class="o">=</span> <span class="n">Identity</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">transform</span>
<span class="go">gptf.core.transforms.Identity()</span>
</pre></div>
</div>
<p>The associated free state can be obtained using the <code class="code docutils literal"><span class="pre">.free_state</span></code>
parameter.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">transforms</span><span class="o">.</span><span class="n">Exp</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">p</span><span class="o">.</span><span class="n">get_session</span><span class="p">()</span> <span class="k">as</span> <span class="n">sess</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:.3e}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">free_state</span><span class="p">)))</span>
<span class="go">1.0</span>
<span class="go">-1.000e-06</span>
</pre></div>
</div>
<p>The free state can then be freely optimised, and <code class="code docutils literal"><span class="pre">p.value</span></code> and
<code class="code docutils literal"><span class="pre">p.tensor</span></code> will remain constrained by the transform.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">transforms</span><span class="o">.</span><span class="n">Exp</span><span class="p">())</span>  <span class="c1"># p.value &gt; 0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">p</span><span class="o">.</span><span class="n">get_session</span><span class="p">()</span> <span class="k">as</span> <span class="n">sess</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">_</span> <span class="o">=</span> <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">free_state</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">))</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">tensor</span><span class="p">))</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">value</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">True</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Tensorflow will take the transform into account when calculating
the derivative of <code class="code docutils literal"><span class="pre">p.tensor</span></code> w.r.t. its free state:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">math</span> <span class="k">import</span> <span class="n">e</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grad_identity</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">gradients</span><span class="p">([</span><span class="n">p</span><span class="o">.</span><span class="n">tensor</span><span class="p">],</span> <span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">free_state</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">p</span><span class="o">.</span><span class="n">get_session</span><span class="p">()</span> <span class="k">as</span> <span class="n">sess</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">grad_identity</span><span class="p">))</span>
<span class="go">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">transform</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Exp</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grad_exp</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">gradients</span><span class="p">([</span><span class="n">p</span><span class="o">.</span><span class="n">tensor</span><span class="p">],</span> <span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">free_state</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">p</span><span class="o">.</span><span class="n">get_session</span><span class="p">()</span> <span class="k">as</span> <span class="n">sess</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:.3f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">grad_exp</span><span class="p">)))</span>
<span class="go">2.718</span>
</pre></div>
</div>
<p class="rubric">Copies</p>
<p>You can create a copy of a <code class="code docutils literal"><span class="pre">Param</span></code> using <code class="code docutils literal"><span class="pre">Param.copy()</span></code>. The
new copy represents the same parameter, so the value and
various items of state (see below) are the same.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">transforms</span><span class="o">.</span><span class="n">Exp</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">copy</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
<p>Copies have the same value as the original, and updating the
value of the copy updates the value of the original.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">copy</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mf">5.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">copy</span><span class="o">.</span><span class="n">value</span>
<span class="go">array(5.0)</span>
</pre></div>
</div>
<p>Copies have the same transform, and setting the transform
of a copy sets the transform of the original.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">copy</span><span class="o">.</span><span class="n">transform</span> <span class="ow">is</span> <span class="n">p</span><span class="o">.</span><span class="n">transform</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">copy</span><span class="o">.</span><span class="n">transform</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Identity</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">transform</span>
<span class="go">gptf.core.transforms.Identity()</span>
</pre></div>
</div>
<p>Copies have the same &#8220;fixed&#8221; flag. Fixing a copy fixes the
original and vice-versa.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">fixed</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">copy</span><span class="o">.</span><span class="n">fixed</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">copy</span><span class="o">.</span><span class="n">fixed</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">fixed</span>
<span class="go">False</span>
</pre></div>
</div>
<p>Copies have the same free state.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">free_state</span> <span class="ow">is</span> <span class="n">copy</span><span class="o">.</span><span class="n">free_state</span>
<span class="go">True</span>
</pre></div>
</div>
<p>This means that it is <em>very important</em> that every copy of of a
<code class="code docutils literal"><span class="pre">Param</span></code> has the same device context and graph, or odd things
happen.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">AttributeWrappedTF</span><span class="p">(</span><span class="n">AttributeTree</span><span class="p">,</span> <span class="n">WrappedTF</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">pass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">treeparam</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span> <span class="o">=</span> <span class="n">AttributeWrappedTF</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span><span class="o">.</span><span class="n">param</span> <span class="o">=</span> <span class="n">treeparam</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span><span class="o">.</span><span class="n">child</span> <span class="o">=</span> <span class="n">AttributeWrappedTF</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span><span class="o">.</span><span class="n">child</span><span class="o">.</span><span class="n">param</span> <span class="o">=</span> <span class="n">treeparam</span>  <span class="c1"># creates a copy of the param</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span><span class="o">.</span><span class="n">tf_graph</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Graph</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span><span class="o">.</span><span class="n">tf_device</span> <span class="o">=</span> <span class="s1">&#39;/job:spoon/task:0&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span><span class="o">.</span><span class="n">child</span><span class="o">.</span><span class="n">tf_device</span> <span class="o">=</span> <span class="s1">&#39;/job:knife/task:0&#39;</span>
</pre></div>
</div>
<p>In the above example, where should we place
<code class="code docutils literal"><span class="pre">treeparam.free_state</span></code>? Should it be on <code class="code docutils literal"><span class="pre">'/job:spoon/task:0'</span></code>
where <code class="code docutils literal"><span class="pre">w.param</span></code> is, or on <code class="code docutils literal"><span class="pre">'/job:knife/task:0'</span></code> where
<code class="code docutils literal"><span class="pre">w.child.param</span></code> is? Currently, there is no system in place
to resolve this. In this situation, one should define the
device context of <code class="code docutils literal"><span class="pre">treeparam</span></code> explicitly:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">treeparam</span><span class="o">.</span><span class="n">tf_device</span> <span class="o">=</span> <span class="s1">&#39;/job:spoon&#39;</span>
</pre></div>
</div>
<p>To create a new param with the same value, pass the value to
<code class="code docutils literal"><span class="pre">Param.__init__()</span></code>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">notacopy</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">p</span><span class="o">.</span><span class="n">transform</span><span class="p">)</span>
</pre></div>
</div>
<dl class="method">
<dt id="gptf.core.params.Param.clear_cache">
<code class="descname">clear_cache</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/params.html#Param.clear_cache"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.params.Param.clear_cache" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the variable value before it is cleared from the cache.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">feed_dict</code></dt>
<dd><p>An empty dictionary.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">fixed</code></dt>
<dd><p>Whether or not the parameter is fixed.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">free_state</code></dt>
<dd><p>Returns a variable that maps to the free state of the parameter.</p>
</dd></dl>

<dl class="attribute">
<dt id="gptf.core.params.Param.initializer">
<code class="descname">initializer</code><a class="headerlink" href="#gptf.core.params.Param.initializer" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialises the internal <code class="code docutils literal"><span class="pre">tf.Variable</span></code> to the correct value.</p>
<p>This op is automatically run for sessions obtained using
<code class="code docutils literal"><span class="pre">.get_session()</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="gptf.core.params.Param.on_session_birth">
<code class="descname">on_session_birth</code><span class="sig-paren">(</span><em>session</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/params.html#Param.on_session_birth"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.params.Param.on_session_birth" title="Permalink to this definition">¶</a></dt>
<dd><p>Called just after a session is created.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>session</strong> (<em>tf.Session</em>) &#8211; The created session.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gptf.core.params.Param.on_session_death">
<code class="descname">on_session_death</code><span class="sig-paren">(</span><em>session</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/params.html#Param.on_session_death"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.params.Param.on_session_death" title="Permalink to this definition">¶</a></dt>
<dd><p>Called just before a session is closed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>session</strong> (<em>tf.Session</em>) &#8211; The dying session.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">tensor</code></dt>
<dd><p>Returns a tensor representing the value of the parameter.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">(tf.Tensor) The forward transform of the parameter applied to its
free state.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">transform</code></dt>
<dd><p>The transform between the free space and value space.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="gptf.core.params.ParamAttributes">
<em class="property">class </em><code class="descclassname">gptf.core.params.</code><code class="descname">ParamAttributes</code><a class="reference internal" href="_modules/gptf/core/params.html#ParamAttributes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.params.ParamAttributes" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gptf.core.params.Parameterized" title="gptf.core.params.Parameterized"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.params.Parameterized</span></code></a>, <a class="reference internal" href="#gptf.core.trees.AttributeTree" title="gptf.core.trees.AttributeTree"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.trees.AttributeTree</span></code></a></p>
<p>Parameters are accessed using attributes.</p>
</dd></dl>

<dl class="class">
<dt id="gptf.core.params.ParamList">
<em class="property">class </em><code class="descclassname">gptf.core.params.</code><code class="descname">ParamList</code><span class="sig-paren">(</span><em>initial_values=()</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/params.html#ParamList"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.params.ParamList" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gptf.core.params.Parameterized" title="gptf.core.params.Parameterized"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.params.Parameterized</span></code></a>, <a class="reference internal" href="#gptf.core.trees.ListTree" title="gptf.core.trees.ListTree"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.trees.ListTree</span></code></a></p>
<p>A list of <code class="code docutils literal"><span class="pre">Param</span></code> or <code class="code docutils literal"><span class="pre">DataHolder</span></code> objects.</p>
<p class="rubric">Examples</p>
<p>You can set the value of children by assigning to their index:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">ParamList</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Param</span><span class="p">(</span><span class="mf">1.</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DataHolder</span><span class="p">(</span><span class="mf">1.</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">3.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Param</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
<span class="go">array(3.0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">5.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">DataHolder</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
<span class="go">array(5.0)</span>
</pre></div>
</div>
<p>You can still overwrite parameters etc with new ones:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">ParamAttributes</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Param</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="gptf.core.params.Parameterised">
<code class="descclassname">gptf.core.params.</code><code class="descname">Parameterised</code><a class="headerlink" href="#gptf.core.params.Parameterised" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#gptf.core.params.Parameterized" title="gptf.core.params.Parameterized"><code class="xref py py-class docutils literal"><span class="pre">Parameterized</span></code></a></p>
</dd></dl>

<dl class="class">
<dt id="gptf.core.params.Parameterized">
<em class="property">class </em><code class="descclassname">gptf.core.params.</code><code class="descname">Parameterized</code><a class="reference internal" href="_modules/gptf/core/params.html#Parameterized"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.params.Parameterized" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gptf.core.wrappedtf.WrappedTF" title="gptf.core.wrappedtf.WrappedTF"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.wrappedtf.WrappedTF</span></code></a></p>
<p>An object that contains parameters and data.</p>
<p>This object is designed to be part of a tree, with <code class="code docutils literal"><span class="pre">Param</span></code>s and
<code class="code docutils literal"><span class="pre">DataHolder</span></code>s at the leaves.</p>
<dl class="attribute">
<dt id="gptf.core.params.Parameterized.fixed">
<code class="descname">fixed</code><a class="headerlink" href="#gptf.core.params.Parameterized.fixed" title="Permalink to this definition">¶</a></dt>
<dd><p><em>bool</em> &#8211; A flag indicating whether or not any child <code class="code docutils literal"><span class="pre">Param</span></code>s
should be fixed. Setting this attribute also sets the <code class="code docutils literal"><span class="pre">.fixed</span></code>
attribute of anything lower in the tree.</p>
</dd></dl>

<dl class="attribute">
<dt id="gptf.core.params.Parameterized.feed_dict">
<code class="descname">feed_dict</code><a class="headerlink" href="#gptf.core.params.Parameterized.feed_dict" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Dict[tf.placeholder, np.array_like]</em> &#8211; A feed dictionary
that feeds the values of DataHolders into their placeholder ops.</p>
</dd></dl>

<dl class="attribute">
<dt id="gptf.core.params.Parameterized.params">
<code class="descname">params</code><a class="headerlink" href="#gptf.core.params.Parameterized.params" title="Permalink to this definition">¶</a></dt>
<dd><p><em>List[Param]</em> &#8211; A list of all the <code class="code docutils literal"><span class="pre">Param</span></code>s lower in the tree,
sorted by their long name.</p>
</dd></dl>

<dl class="attribute">
<dt id="gptf.core.params.Parameterized.data_holders">
<code class="descname">data_holders</code><a class="headerlink" href="#gptf.core.params.Parameterized.data_holders" title="Permalink to this definition">¶</a></dt>
<dd><p><em>List[Param]</em> &#8211; A list of all the <code class="code docutils literal"><span class="pre">DataHolder</span></code>s lower in
the tree, sorted by their long name.</p>
</dd></dl>

<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">gptf</span> <span class="k">import</span> <span class="n">transforms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Parameterized</span><span class="p">(</span><span class="n">Parameterized</span><span class="p">,</span> <span class="n">AttributeTree</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">pass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">Parameterized</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">param</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="mf">1.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">child</span> <span class="o">=</span> <span class="n">Parameterized</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">child</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">Param</span><span class="p">([</span><span class="mf">2.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">],</span> <span class="n">transform</span><span class="o">=</span><span class="n">transforms</span><span class="o">.</span><span class="n">Exp</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">child</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">Param</span><span class="p">([[</span><span class="mf">1.0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">X</span> <span class="o">=</span> <span class="n">DataHolder</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">,</span> <span class="mf">5.</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">Y</span> <span class="o">=</span> <span class="n">DataHolder</span><span class="p">([</span><span class="mf">10.</span><span class="p">,</span> <span class="mf">23.3</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="mf">42.</span><span class="p">,</span> <span class="o">.</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">child</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">DataHolder</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="code docutils literal"><span class="pre">.params</span></code> and <code class="code docutils literal"><span class="pre">.data</span></code> attributes return all instances of their
associated types lower in the tree.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">set</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">params</span><span class="p">)</span> <span class="o">==</span> <span class="p">{</span><span class="n">m</span><span class="o">.</span><span class="n">param</span><span class="p">,</span> <span class="n">m</span><span class="o">.</span><span class="n">child</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">m</span><span class="o">.</span><span class="n">child</span><span class="o">.</span><span class="n">b</span><span class="p">}</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">set</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">data_holders</span><span class="p">)</span> <span class="o">==</span> <span class="p">{</span><span class="n">m</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="n">m</span><span class="o">.</span><span class="n">Y</span><span class="p">,</span> <span class="n">m</span><span class="o">.</span><span class="n">child</span><span class="o">.</span><span class="n">data</span><span class="p">}</span>
<span class="go">True</span>
</pre></div>
</div>
<dl class="attribute">
<dt id="gptf.core.params.Parameterized.ARRAY_DISPLAY_LENGTH">
<code class="descname">ARRAY_DISPLAY_LENGTH</code><em class="property"> = 5</em><a class="headerlink" href="#gptf.core.params.Parameterized.ARRAY_DISPLAY_LENGTH" title="Permalink to this definition">¶</a></dt>
<dd><p>The default array display length.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">data_holders</code></dt>
<dd><p>A sorted list of the <code class="code docutils literal"><span class="pre">DataHolder</span></code>s lower in the tree.</p>
</dd></dl>

<dl class="method">
<dt id="gptf.core.params.Parameterized.data_summary">
<code class="descname">data_summary</code><span class="sig-paren">(</span><em>array_len=5</em>, <em>fmt='fancy'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/params.html#Parameterized.data_summary"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.params.Parameterized.data_summary" title="Permalink to this definition">¶</a></dt>
<dd><p>A string table summarizing the data of <code class="code docutils literal"><span class="pre">self</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>array_len</strong> (<em>int</em>) &#8211; The maximum number of elements to display
of each array value.</li>
<li><strong>fmt</strong> (<em>'fancy', 'plain', 'html'</em>) &#8211; The format for the table.
<code class="code docutils literal"><span class="pre">'fancy'</span></code> returns a table with fancy formatting using box
drawing characters and ANSI terminal escape codes.
<code class="code docutils literal"><span class="pre">'plain'</span></code> returns a table using only ascii characters.
<code class="code docutils literal"><span class="pre">'html'</span></code> returns an html table.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A string containing a table specifying the name,
value, transform and prior of each parameter.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(str)</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Parameterized</span><span class="p">(</span><span class="n">Parameterized</span><span class="p">,</span> <span class="n">AttributeTree</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">pass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">Parameterized</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">fallback_name</span> <span class="o">=</span> <span class="s1">&#39;p&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">child</span> <span class="o">=</span> <span class="n">Parameterized</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">DataHolder</span><span class="p">(</span><span class="mf">1.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">child</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">DataHolder</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">child</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">DataHolder</span><span class="p">([[</span><span class="mf">1.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">data_summary</span><span class="p">(</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;plain&#39;</span><span class="p">))</span>  
<span class="go">name      | value</span>
<span class="go">----------+----------------------</span>
<span class="go">p.child.a | [1.000, 2.000, 3.000]</span>
<span class="go">p.child.b | &lt;np.ndarray&gt;</span>
<span class="go">p.data    | 1.000</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">feed_dict</code></dt>
<dd><p>The union of the <code class="code docutils literal"><span class="pre">.feed_dict</span></code>s of objects lower in the tree.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">fixed</code></dt>
<dd><p>Whether or not params lower in the heirarchy should be fixed.</p>
</dd></dl>

<dl class="method">
<dt id="gptf.core.params.Parameterized.param_summary">
<code class="descname">param_summary</code><span class="sig-paren">(</span><em>array_len=5</em>, <em>fmt='fancy'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/params.html#Parameterized.param_summary"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.params.Parameterized.param_summary" title="Permalink to this definition">¶</a></dt>
<dd><p>A string table summarizing the parameters of <code class="code docutils literal"><span class="pre">self</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>fmt</strong> (<em>'fancy', 'plain', 'html'</em>) &#8211; The format for the table.
<code class="code docutils literal"><span class="pre">'fancy'</span></code> returns a table with fancy formatting using box
drawing characters and ANSI terminal escape codes.
<code class="code docutils literal"><span class="pre">'plain'</span></code> returns a table using only ascii characters.
<code class="code docutils literal"><span class="pre">'html'</span></code> returns an html table.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A string containing a table specifying the name,
value, transform and prior of each parameter.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">(str)</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">gptf</span> <span class="k">import</span> <span class="n">transforms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Parameterized</span><span class="p">(</span><span class="n">Parameterized</span><span class="p">,</span> <span class="n">AttributeTree</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">pass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">Parameterized</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">fallback_name</span> <span class="o">=</span> <span class="s1">&#39;p&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">child</span> <span class="o">=</span> <span class="n">Parameterized</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">param</span> <span class="o">=</span> <span class="n">Param</span><span class="p">(</span><span class="mf">1.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">child</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">Param</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">child</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">Param</span><span class="p">([[</span><span class="mf">1.</span><span class="p">]],</span> <span class="n">transform</span><span class="o">=</span><span class="n">transforms</span><span class="o">.</span><span class="n">Exp</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">param_summary</span><span class="p">(</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;plain&#39;</span><span class="p">))</span>  
<span class="go">name      | value                 | transform | prior</span>
<span class="go">----------+-----------------------+-----------+------</span>
<span class="go">p.child.a | [1.000, 2.000, 3.000] | identity  | nyi</span>
<span class="go">p.child.b | &lt;np.ndarray&gt;          | +ve (Exp) | nyi</span>
<span class="go">p.param   | 1.000                 | identity  | nyi</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">params</code></dt>
<dd><p>A sorted list of the <code class="code docutils literal"><span class="pre">Param</span></code>s lower in the tree.</p>
</dd></dl>

<dl class="method">
<dt id="gptf.core.params.Parameterized.summary">
<code class="descname">summary</code><span class="sig-paren">(</span><em>array_len=5</em>, <em>fmt='fancy'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/params.html#Parameterized.summary"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.params.Parameterized.summary" title="Permalink to this definition">¶</a></dt>
<dd><p>A string table summarizing <code class="code docutils literal"><span class="pre">self</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>array_len</strong> (<em>int</em>) &#8211; The maximum number of elements to display
of each array value.</li>
<li><strong>fmt</strong> (<em>'fancy', 'plain', 'html'</em>) &#8211; The format for the table.
<code class="code docutils literal"><span class="pre">'fancy'</span></code> returns a table with fancy formatting using box
drawing characters and ANSI terminal escape codes.
<code class="code docutils literal"><span class="pre">'plain'</span></code> returns a table using only ascii characters.
<code class="code docutils literal"><span class="pre">'html'</span></code> returns an html table.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A summary of this object&#8217;s parameters and data.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(str)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="gptf.core.params.Proxy">
<em class="property">class </em><code class="descclassname">gptf.core.params.</code><code class="descname">Proxy</code><a class="reference internal" href="_modules/gptf/core/params.html#Proxy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.params.Proxy" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gptf.core.trees.Tree" title="gptf.core.trees.Tree"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.trees.Tree</span></code></a></p>
<p>Places important state in an object shared between copies.</p>
<dl class="class">
<dt id="gptf.core.params.Proxy.Shared">
<em class="property">class </em><code class="descname">Shared</code><a class="reference internal" href="_modules/gptf/core/params.html#Proxy.Shared"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.params.Proxy.Shared" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
</dd></dl>

<dl class="method">
<dt id="gptf.core.params.Proxy.copy">
<code class="descclassname">Proxy.</code><code class="descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/params.html#Proxy.copy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.params.Proxy.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Shallow-copy <code class="code docutils literal"><span class="pre">self</span></code>, shallow-copying any <code class="code docutils literal"><span class="pre">Tree</span></code> children.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="gptf.core.params.ProxyWrappedValue">
<em class="property">class </em><code class="descclassname">gptf.core.params.</code><code class="descname">ProxyWrappedValue</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/params.html#ProxyWrappedValue"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.params.ProxyWrappedValue" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gptf.core.params.WrappedValue" title="gptf.core.params.WrappedValue"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.params.WrappedValue</span></code></a>, <a class="reference internal" href="#gptf.core.params.Proxy" title="gptf.core.params.Proxy"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.params.Proxy</span></code></a></p>
<p>Sync various useful properties between copies.</p>
<p>Shares one cache between all copies, and shares the <code class="code docutils literal"><span class="pre">.tf_device</span></code>,
<code class="code docutils literal"><span class="pre">.tf_graph</span></code>, <code class="code docutils literal"><span class="pre">.tf_session_target</span></code>, <code class="code docutils literal"><span class="pre">.on_shape_change</span></code> and
<code class="code docutils literal"><span class="pre">.on_dtype_change</span></code> parameters.</p>
<dl class="attribute">
<dt id="gptf.core.params.ProxyWrappedValue.cache">
<code class="descname">cache</code><a class="headerlink" href="#gptf.core.params.ProxyWrappedValue.cache" title="Permalink to this definition">¶</a></dt>
<dd><p>Contains cached tensorflow functions etc.</p>
</dd></dl>

<dl class="method">
<dt id="gptf.core.params.ProxyWrappedValue.clear_all_ancestor_caches">
<code class="descname">clear_all_ancestor_caches</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/params.html#ProxyWrappedValue.clear_all_ancestor_caches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.params.ProxyWrappedValue.clear_all_ancestor_caches" title="Permalink to this definition">¶</a></dt>
<dd><p>Clears the caches of the ancestors of all copies.</p>
</dd></dl>

<dl class="attribute">
<dt id="gptf.core.params.ProxyWrappedValue.on_dtype_change">
<code class="descname">on_dtype_change</code><a class="headerlink" href="#gptf.core.params.ProxyWrappedValue.on_dtype_change" title="Permalink to this definition">¶</a></dt>
<dd><p>The action to take when the dtype changes.</p>
</dd></dl>

<dl class="attribute">
<dt id="gptf.core.params.ProxyWrappedValue.on_shape_change">
<code class="descname">on_shape_change</code><a class="headerlink" href="#gptf.core.params.ProxyWrappedValue.on_shape_change" title="Permalink to this definition">¶</a></dt>
<dd><p>The action to take when the value changes.</p>
</dd></dl>

<dl class="attribute">
<dt id="gptf.core.params.ProxyWrappedValue.tf_device">
<code class="descname">tf_device</code><a class="headerlink" href="#gptf.core.params.ProxyWrappedValue.tf_device" title="Permalink to this definition">¶</a></dt>
<dd><p>The device context onto which this object&#8217;s ops should be pinned.</p>
</dd></dl>

<dl class="attribute">
<dt id="gptf.core.params.ProxyWrappedValue.tf_graph">
<code class="descname">tf_graph</code><a class="headerlink" href="#gptf.core.params.ProxyWrappedValue.tf_graph" title="Permalink to this definition">¶</a></dt>
<dd><p>The graph to place ops in.</p>
</dd></dl>

<dl class="attribute">
<dt id="gptf.core.params.ProxyWrappedValue.tf_session_target">
<code class="descname">tf_session_target</code><a class="headerlink" href="#gptf.core.params.ProxyWrappedValue.tf_session_target" title="Permalink to this definition">¶</a></dt>
<dd><p>The target under which sessions should be run.</p>
</dd></dl>

</dd></dl>

<dl class="exception">
<dt id="gptf.core.params.ShapeChangeError">
<em class="property">exception </em><code class="descclassname">gptf.core.params.</code><code class="descname">ShapeChangeError</code><a class="reference internal" href="_modules/gptf/core/params.html#ShapeChangeError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.params.ShapeChangeError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">Exception</span></code></p>
<p>Raised when the shape of a Param or DataHolder changes.</p>
</dd></dl>

<dl class="class">
<dt id="gptf.core.params.WrappedValue">
<em class="property">class </em><code class="descclassname">gptf.core.params.</code><code class="descname">WrappedValue</code><span class="sig-paren">(</span><em>on_shape_change='raise'</em>, <em>on_dtype_change='raise'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/params.html#WrappedValue"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.params.WrappedValue" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gptf.core.wrappedtf.WrappedTF" title="gptf.core.wrappedtf.WrappedTF"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.wrappedtf.WrappedTF</span></code></a></p>
<p>A class with a wrapped NumPy value, accessible through <code class="code docutils literal"><span class="pre">.value</span></code>.</p>
<dl class="attribute">
<dt id="gptf.core.params.WrappedValue.value">
<code class="descname">value</code><a class="headerlink" href="#gptf.core.params.WrappedValue.value" title="Permalink to this definition">¶</a></dt>
<dd><p><em>np.ndarray</em> &#8211; The value of the parameter.</p>
</dd></dl>

<dl class="attribute">
<dt id="gptf.core.params.WrappedValue.on_shape_change">
<code class="descname">on_shape_change</code><a class="headerlink" href="#gptf.core.params.WrappedValue.on_shape_change" title="Permalink to this definition">¶</a></dt>
<dd><p><em>&#8216;raise&#8217; | &#8216;pass&#8217; | &#8216;recompile&#8217;</em> &#8211; The action to take
when the shape of the data changes; see the setter for <code class="code docutils literal"><span class="pre">.value</span></code>.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">on_shape_change</code></dt>
<dd><p><em>&#8216;raise&#8217; | &#8216;pass&#8217; | &#8216;recompile&#8217;</em> &#8211; The action to take
when the shape of the data changes; see the setter for <code class="code docutils literal"><span class="pre">.value</span></code>.</p>
</dd></dl>

<dl class="attribute">
<dt id="gptf.core.params.WrappedValue.on_dtype_change">
<code class="descname">on_dtype_change</code><a class="headerlink" href="#gptf.core.params.WrappedValue.on_dtype_change" title="Permalink to this definition">¶</a></dt>
<dd><p>The action to take when the dtype changes.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">on_shape_change</code></dt>
<dd><p>The action to take when the value changes.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">value</code></dt>
<dd><p>The (NumPy) value of the object.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="gptf.core.params.autoflow">
<code class="descclassname">gptf.core.params.</code><code class="descname">autoflow</code><span class="sig-paren">(</span><em>*placeholder_specs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/params.html#autoflow"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.params.autoflow" title="Permalink to this definition">¶</a></dt>
<dd><p>Wraps up a TensorFlow method so that it takes NumPy and gives NumPy.</p>
<p>When an autoflowed method is called, we construct placeholders to
represent the passed arguments, apply <code class="code docutils literal"><span class="pre">tf_method</span></code>
to the wrapped method and evaluate it on the placeholders to produce
a TensorFlow op. We then evaluate the op in a session, passing in the
appropriate feed dictionaries, and return the resulting NumPy array.</p>
<p>We also cache the op, so that multiple calls to the function construct
the op only once. This cache is cleared when device contexts change,
when transforms on <code class="code docutils literal"><span class="pre">Param</span></code>s change, and any number of other similar
circumstances.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>*placeholder_specs</strong> &#8211; some tuples that specify how the placeholders
for the arguments of the decorated method should be
constructed. Each tuple will be used as the arguments to a
call to <code class="code docutils literal"><span class="pre">tf.placeholder()</span></code>. The first tuple will be used to
construct the placeholder for the first argument of the
decorated function, the second for the second, and so on.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A decorator that autoflows the decorated method.</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>The decorator syntax looks like this:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">MyClass</span><span class="p">(</span><span class="n">Parameterized</span><span class="p">,</span> <span class="n">AttributeTree</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nd">@autoflow</span><span class="p">((</span><span class="n">tf</span><span class="o">.</span><span class="n">float64</span><span class="p">,),</span> <span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">float64</span><span class="p">,))</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">tf_add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="nd">@autoflow</span><span class="p">((</span><span class="n">tf</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="kc">None</span><span class="p">]))</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">tf_reduce_sum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">reduce_sum</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Now we can leverage the mighty power of tensorflow without ever
having to get our hands dirty:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">MyClass</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">tf_add</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="go">14.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">4.</span><span class="p">,</span> <span class="mf">5.</span><span class="p">,</span> <span class="mf">6.</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">tf_add</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="go">array([ 5., 7., 9.])</span>
</pre></div>
</div>
<p><code class="code docutils literal"><span class="pre">MyClass.tf_reduce_sum</span></code> will only allow arguments that match the
shape <code class="code docutils literal"><span class="pre">[1,</span> <span class="pre">None]</span></code>; that is, rank 2 tensors whose first dimension
is <code class="code docutils literal"><span class="pre">5</span></code>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># shape is (3, 2), compatible with [3, None]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">tf_reduce_sum</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">],</span> <span class="p">[</span><span class="mf">2.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">],</span> <span class="p">[</span><span class="mf">3.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">]])</span>
<span class="go">array([ 3., 5., 7.])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># shape is (2, 1), not compatible with [3, None]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">tf_reduce_sum</span><span class="p">([[</span><span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">2.</span><span class="p">]])</span>
<span class="gt">Traceback (most recent call last):</span>
    <span class="o">...</span>
<span class="gr">ValueError</span>: <span class="n">Cannot feed value of shape (2, 1)...</span>
</pre></div>
</div>
<p>Autoflowed methods still work if the device context changes:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># set up a distributed execution environment</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clusterdict</span> <span class="o">=</span> \
<span class="gp">... </span>    <span class="p">{</span> <span class="s1">&#39;worker&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;localhost:2224&#39;</span><span class="p">]</span>
<span class="gp">... </span>    <span class="p">,</span> <span class="s1">&#39;master&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;localhost:2225&#39;</span><span class="p">]</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spec</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">ClusterSpec</span><span class="p">(</span><span class="n">clusterdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">worker</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">Server</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="n">job_name</span><span class="o">=</span><span class="s1">&#39;worker&#39;</span><span class="p">,</span> <span class="n">task_index</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">worker</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">master</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">Server</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="n">job_name</span><span class="o">=</span><span class="s1">&#39;master&#39;</span><span class="p">,</span> <span class="n">task_index</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># change m&#39;s device context</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># we&#39;re about to do weird things with op placement, and we</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># don&#39;t want it in the default graph where it can mess with</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># other doctests, so change m&#39;s tf_graph as well.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">tf_graph</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Graph</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">tf_device</span> <span class="o">=</span> <span class="s1">&#39;/job:worker/task:0&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">tf_session_target</span> <span class="o">=</span> <span class="n">master</span><span class="o">.</span><span class="n">target</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># autoflow</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">tf_add</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">5.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">tf_reduce_sum</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">],</span> <span class="p">[</span><span class="mf">4.</span><span class="p">,</span> <span class="mf">5.</span><span class="p">,</span> <span class="mf">6.</span><span class="p">],</span> <span class="p">[</span><span class="mf">7.</span><span class="p">,</span> <span class="mf">8.</span><span class="p">,</span> <span class="mf">9.</span><span class="p">]])</span>
<span class="go">array([  6., 15., 24.])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="gptf.core.params.no_gc">
<code class="descclassname">gptf.core.params.</code><code class="descname">no_gc</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/params.html#no_gc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.params.no_gc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="gptf.core.params.share_properties">
<code class="descclassname">gptf.core.params.</code><code class="descname">share_properties</code><span class="sig-paren">(</span><em>*properties</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/params.html#share_properties"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.params.share_properties" title="Permalink to this definition">¶</a></dt>
<dd><p>Shares properties of a <code class="code docutils literal"><span class="pre">Proxy</span></code> subclass between all copies.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>*properties</strong> (<em>Tuple[str]</em>) &#8211; The (string) names of the properties
to override.</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>Here we set up an example class with a property and an
inheriting class that overrides that property.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nd">@share_properties</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">... </span><span class="k">class</span> <span class="nc">Example</span><span class="p">(</span><span class="n">Proxy</span><span class="p">,</span> <span class="n">Leaf</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nd">@property</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">a</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;getter called&#39;</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_a</span>
<span class="gp">... </span>    <span class="nd">@a</span><span class="o">.</span><span class="n">setter</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">a</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;setter called&#39;</span><span class="p">)</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">_a</span> <span class="o">=</span> <span class="n">value</span>
<span class="gp">... </span>    <span class="nd">@a</span><span class="o">.</span><span class="n">deleter</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">a</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;deleter called&#39;</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_a</span>
</pre></div>
</div>
<p>The inheriting class shares the property between the copies
using the property&#8217;s getter/setter/deleter methods.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="n">Example</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">copies</span> <span class="o">=</span> <span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="mi">1</span>
<span class="go">setter called</span>
<span class="go">setter called</span>
<span class="go">setter called</span>
<span class="go">setter called</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">all</span><span class="p">(</span><span class="n">copy</span><span class="o">.</span><span class="n">a</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">copy</span> <span class="ow">in</span> <span class="n">copies</span><span class="p">)</span>
<span class="go">getter called</span>
<span class="go">getter called</span>
<span class="go">getter called</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">del</span> <span class="n">e</span><span class="o">.</span><span class="n">a</span>
<span class="go">deleter called</span>
<span class="go">deleter called</span>
<span class="go">deleter called</span>
<span class="go">deleter called</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-gptf.core.tfhacks">
<span id="gptf-core-tfhacks-module"></span><h2>gptf.core.tfhacks module<a class="headerlink" href="#module-gptf.core.tfhacks" title="Permalink to this headline">¶</a></h2>
<p>A collection of hacks for TensorFlow.</p>
<p>Hopefully, as TensorFlow matures as a library, more of these can be removed.</p>
<dl class="function">
<dt id="gptf.core.tfhacks.eye">
<code class="descclassname">gptf.core.tfhacks.</code><code class="descname">eye</code><span class="sig-paren">(</span><em>shape</em>, <em>dtype=tf.float64</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/tfhacks.html#eye"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.tfhacks.eye" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs an eye matrix of the requested shape.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>shape</strong> (<em>int | (int, int</em>) &#8211; The shape to construct. If <code class="code docutils literal"><span class="pre">int</span></code>, a square
matrix with <code class="code docutils literal"><span class="pre">shape</span></code> rows and <code class="code docutils literal"><span class="pre">shape</span></code> columns will be constructed.
Else, a matrix with <code class="code docutils literal"><span class="pre">shape[0]</span></code> rows and <code class="code docutils literal"><span class="pre">shape[1]</span></code> columns will
be constructed.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A matrix with the requested shape and 1s on the diagonal.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">(tf.Tensor)</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-gptf.core.transforms">
<span id="gptf-core-transforms-module"></span><h2>gptf.core.transforms module<a class="headerlink" href="#module-gptf.core.transforms" title="Permalink to this headline">¶</a></h2>
<p>Provides a number of transforms that can be used to constrain <code class="code docutils literal"><span class="pre">Param</span></code>s.</p>
<dl class="class">
<dt id="gptf.core.transforms.Exp">
<em class="property">class </em><code class="descclassname">gptf.core.transforms.</code><code class="descname">Exp</code><span class="sig-paren">(</span><em>lower=1e-06</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/transforms.html#Exp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.transforms.Exp" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gptf.core.transforms.Transform" title="gptf.core.transforms.Transform"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.transforms.Transform</span></code></a></p>
<p>An exponential transform.</p>
<p>value = exp(free_state) + lower</p>
<dl class="method">
<dt id="gptf.core.transforms.Exp.np_backward">
<code class="descname">np_backward</code><span class="sig-paren">(</span><em>y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/transforms.html#Exp.np_backward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.transforms.Exp.np_backward" title="Permalink to this definition">¶</a></dt>
<dd><p>Map from the variable to the free space using NumPy.</p>
</dd></dl>

<dl class="method">
<dt id="gptf.core.transforms.Exp.tf_forward">
<code class="descname">tf_forward</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/transforms.html#Exp.tf_forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.transforms.Exp.tf_forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Map from the free space to the variable space using TensorFlow.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="gptf.core.transforms.Identity">
<em class="property">class </em><code class="descclassname">gptf.core.transforms.</code><code class="descname">Identity</code><a class="reference internal" href="_modules/gptf/core/transforms.html#Identity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.transforms.Identity" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gptf.core.transforms.Transform" title="gptf.core.transforms.Transform"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.transforms.Transform</span></code></a></p>
<dl class="staticmethod">
<dt id="gptf.core.transforms.Identity.np_backward">
<em class="property">static </em><code class="descname">np_backward</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/transforms.html#Identity.np_backward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.transforms.Identity.np_backward" title="Permalink to this definition">¶</a></dt>
<dd><p>Map from the variable to the free space using NumPy.</p>
</dd></dl>

<dl class="staticmethod">
<dt id="gptf.core.transforms.Identity.tf_forward">
<em class="property">static </em><code class="descname">tf_forward</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/transforms.html#Identity.tf_forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.transforms.Identity.tf_forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Map from the free space to the variable space using TensorFlow.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="gptf.core.transforms.Transform">
<em class="property">class </em><code class="descclassname">gptf.core.transforms.</code><code class="descname">Transform</code><a class="reference internal" href="_modules/gptf/core/transforms.html#Transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.transforms.Transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>A transform, used to constrain the optimisation of a <code class="code docutils literal"><span class="pre">Param</span></code>.</p>
<p>NB: Unless otherwise stated, attributes of transforms are read-only
and should be treated as such. If you wish to change the transform
of a <code class="code docutils literal"><span class="pre">Param</span></code>, assign a <em>new</em> <code class="code docutils literal"><span class="pre">Transform</span></code> to its <code class="code docutils literal"><span class="pre">.transform</span></code> attribute.</p>
<dl class="method">
<dt id="gptf.core.transforms.Transform.np_backward">
<code class="descname">np_backward</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/transforms.html#Transform.np_backward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.transforms.Transform.np_backward" title="Permalink to this definition">¶</a></dt>
<dd><p>Map from the variable to the free space using NumPy.</p>
</dd></dl>

<dl class="method">
<dt id="gptf.core.transforms.Transform.tf_forward">
<code class="descname">tf_forward</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/transforms.html#Transform.tf_forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.transforms.Transform.tf_forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Map from the free space to the variable space using TensorFlow.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-gptf.core.trees">
<span id="gptf-core-trees-module"></span><h2>gptf.core.trees module<a class="headerlink" href="#module-gptf.core.trees" title="Permalink to this headline">¶</a></h2>
<p>Provides the <code class="code docutils literal"><span class="pre">Tree</span></code> class for creating trees of objects.</p>
<dl class="class">
<dt id="gptf.core.trees.AttributeTree">
<em class="property">class </em><code class="descclassname">gptf.core.trees.</code><code class="descname">AttributeTree</code><a class="reference internal" href="_modules/gptf/core/trees.html#AttributeTree"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.trees.AttributeTree" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gptf.core.trees.Tree" title="gptf.core.trees.Tree"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.trees.Tree</span></code></a></p>
<p>A tree that uses attributes to assign/track children.</p>
<p>A tree can be constructed by simply assigning <code class="code docutils literal"><span class="pre">Tree</span></code>s to the
attributes of an <code class="code docutils literal"><span class="pre">AttributeTree</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">AttributeTree</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># doctest does not run these tests in __main__, so we give p</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># a sensible fallback name</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">fallback_name</span> <span class="o">=</span> <span class="s1">&#39;root&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">child_a</span> <span class="o">=</span> <span class="n">AttributeTree</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">child_b</span> <span class="o">=</span> <span class="n">AttributeTree</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">child_b</span><span class="o">.</span><span class="n">leaf</span> <span class="o">=</span> <span class="n">AttributeTree</span><span class="p">()</span>
</pre></div>
</div>
<p>The <code class="code docutils literal"><span class="pre">long_name()</span></code> method may then be used to get the full path of an
object within the tree.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">child_a</span><span class="o">.</span><span class="n">long_name</span><span class="p">)</span>
<span class="go">root.child_a</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">child_b</span><span class="o">.</span><span class="n">leaf</span><span class="o">.</span><span class="n">long_name</span><span class="p">)</span>
<span class="go">root.child_b.leaf</span>
</pre></div>
</div>
<p>Objects in the tree must be unique. No object may be its own ancestor
or sibling. Attempts to add a <code class="code docutils literal"><span class="pre">Tree</span></code> attribute that would result in
such a graph instead result in that <code class="code docutils literal"><span class="pre">Tree</span></code> being shallow-copied.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">AttributeTree</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">attribute</span> <span class="o">=</span> <span class="nb">object</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">child</span> <span class="o">=</span> <span class="n">p</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">child</span> <span class="ow">is</span> <span class="n">p</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">child</span><span class="o">.</span><span class="n">attribute</span> <span class="ow">is</span> <span class="n">p</span><span class="o">.</span><span class="n">attribute</span>  <span class="c1"># true for non-Tree attributes</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">AttributeTree</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">num</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">child_a</span> <span class="o">=</span> <span class="n">q</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">child_a</span> <span class="ow">is</span> <span class="n">q</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">child_b</span> <span class="o">=</span> <span class="n">q</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">child_b</span> <span class="ow">is</span> <span class="n">q</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">child_b</span><span class="o">.</span><span class="n">num</span>
<span class="go">1</span>
</pre></div>
</div>
<dl class="attribute">
<dt id="gptf.core.trees.AttributeTree.fallback_name">
<code class="descname">fallback_name</code><a class="headerlink" href="#gptf.core.trees.AttributeTree.fallback_name" title="Permalink to this definition">¶</a></dt>
<dd><p><em>str</em> &#8211; The name that this object has when it is the
highest object in the tree and does not have a unique global
alias. Defaults to &#8220;unnamed&#8221;.</p>
</dd></dl>

<dl class="attribute">
<dt id="gptf.core.trees.AttributeTree.children">
<code class="descname">children</code><a class="headerlink" href="#gptf.core.trees.AttributeTree.children" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the children of this object at the time of calling.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">(tuple) The current children of the object.</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">AttributeTree</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">AttributeTree</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="n">AttributeTree</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">child</span> <span class="o">=</span> <span class="n">q</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">other_child</span> <span class="o">=</span> <span class="n">r</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">children</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="ow">in</span> <span class="n">p</span><span class="o">.</span><span class="n">children</span> <span class="ow">and</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">p</span><span class="o">.</span><span class="n">children</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="gptf.core.trees.AttributeTree.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/trees.html#AttributeTree.copy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.trees.AttributeTree.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Shallowly copies self, deeply copying any Tree children.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">AttributeTree</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="nb">object</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">child</span> <span class="o">=</span> <span class="n">AttributeTree</span><span class="p">()</span>
</pre></div>
</div>
<p>Shallow copy returns an entirely new tree, but non-tree
attributes are shallowly copied (as references).</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">copy</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">copy</span> <span class="ow">is</span> <span class="n">t</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">copy</span><span class="o">.</span><span class="n">child</span> <span class="ow">is</span> <span class="n">t</span><span class="o">.</span><span class="n">child</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">copy</span><span class="o">.</span><span class="n">child</span><span class="o">.</span><span class="n">parent</span> <span class="ow">is</span> <span class="n">copy</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">copy</span><span class="o">.</span><span class="n">a</span> <span class="ow">is</span> <span class="n">t</span><span class="o">.</span><span class="n">a</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The parent of the new copy is <code class="code docutils literal"><span class="pre">None</span></code>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">child</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span> <span class="ow">is</span> <span class="kc">None</span>
<span class="go">True</span>
</pre></div>
</div>
<p>This behaviour is inherited correctly:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Example</span><span class="p">(</span><span class="n">AttributeTree</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">pass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="n">Example</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="o">.</span><span class="n">child</span> <span class="o">=</span> <span class="n">Example</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="nb">object</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">copy</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">copy</span><span class="p">,</span> <span class="n">Example</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">copy</span><span class="o">.</span><span class="n">child</span><span class="p">,</span> <span class="n">Example</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">copy</span> <span class="ow">is</span> <span class="n">e</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">copy</span><span class="o">.</span><span class="n">child</span> <span class="ow">is</span> <span class="n">e</span><span class="o">.</span><span class="n">child</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">copy</span><span class="o">.</span><span class="n">a</span> <span class="ow">is</span> <span class="n">e</span><span class="o">.</span><span class="n">a</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="gptf.core.trees.AttributeTree.name_of">
<code class="descname">name_of</code><span class="sig-paren">(</span><em>value</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/trees.html#AttributeTree.name_of"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.trees.AttributeTree.name_of" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the name of <code class="code docutils literal"><span class="pre">value</span></code>.</p>
<p>Searches <code class="code docutils literal"><span class="pre">self.__dict__</span></code> for a reference to <code class="code docutils literal"><span class="pre">value</span></code> and returns it.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">A name by which <code class="code docutils literal"><span class="pre">value</span></code> can be accessed from <code class="code docutils literal"><span class="pre">self</span></code>. If
<code class="code docutils literal"><span class="pre">self</span></code> is accessible by some variable <code class="code docutils literal"><span class="pre">p</span></code>, then
<code class="code docutils literal"><span class="pre">eval(&quot;p&quot;</span> <span class="pre">+</span> <span class="pre">p.name_of(value))</span></code> must return <code class="code docutils literal"><span class="pre">value</span></code>, assuming
<code class="code docutils literal"><span class="pre">p.name_of()</span></code> doesn&#8217;t raise.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(str)</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><a class="reference internal" href="#gptf.core.trees.BadParentError" title="gptf.core.trees.BadParentError"><code class="xref py py-exc docutils literal"><span class="pre">BadParentError</span></code></a> &#8211; If <code class="code docutils literal"><span class="pre">value</span></code> is not a child of <code class="code docutils literal"><span class="pre">self</span></code>.</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">AttributeTree</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">AttributeTree</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">child</span> <span class="o">=</span> <span class="n">q</span>
</pre></div>
</div>
<p>If <code class="code docutils literal"><span class="pre">q</span></code> is a child of <code class="code docutils literal"><span class="pre">p</span></code>, we return the name of <code class="code docutils literal"><span class="pre">q</span></code> in the
<code class="code docutils literal"><span class="pre">p</span></code>&#8216;s <code class="code docutils literal"><span class="pre">.__dict__</span></code>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">name_of</span><span class="p">(</span><span class="n">q</span><span class="p">))</span>
<span class="go">.child</span>
</pre></div>
</div>
<p>We are contractually obliged to return a string that when appended
to <code class="code docutils literal"><span class="pre">'p'</span></code> evaluates to <code class="code docutils literal"><span class="pre">q</span></code>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">eval</span><span class="p">(</span><span class="s1">&#39;p&#39;</span> <span class="o">+</span> <span class="n">p</span><span class="o">.</span><span class="n">name_of</span><span class="p">(</span><span class="n">q</span><span class="p">))</span> <span class="ow">is</span> <span class="n">q</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="exception">
<dt id="gptf.core.trees.BadParentError">
<em class="property">exception </em><code class="descclassname">gptf.core.trees.</code><code class="descname">BadParentError</code><a class="reference internal" href="_modules/gptf/core/trees.html#BadParentError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.trees.BadParentError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">Exception</span></code></p>
<p>Raised when a parent does not have a reference to a requested child.</p>
</dd></dl>

<dl class="class">
<dt id="gptf.core.trees.BreadthFirstTreeIterator">
<em class="property">class </em><code class="descclassname">gptf.core.trees.</code><code class="descname">BreadthFirstTreeIterator</code><span class="sig-paren">(</span><em>tree</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/trees.html#BreadthFirstTreeIterator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.trees.BreadthFirstTreeIterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Walks the tree, breadth first.</p>
</dd></dl>

<dl class="class">
<dt id="gptf.core.trees.Leaf">
<em class="property">class </em><code class="descclassname">gptf.core.trees.</code><code class="descname">Leaf</code><a class="reference internal" href="_modules/gptf/core/trees.html#Leaf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.trees.Leaf" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gptf.core.trees.Tree" title="gptf.core.trees.Tree"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.trees.Tree</span></code></a></p>
<p>A <code class="code docutils literal"><span class="pre">Tree</span></code> that cannot have any children.</p>
<p class="rubric">Examples</p>
<p>A <code class="code docutils literal"><span class="pre">Leaf</span></code> will not automatically add children on attribute assignment:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="n">Leaf</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">child</span> <span class="o">=</span> <span class="n">AttributeTree</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">children</span>
<span class="go">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">child</span><span class="o">.</span><span class="n">parent</span> <span class="ow">is</span> <span class="kc">None</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Leaves still know who their parent is and what their name is:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">AttributeTree</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">fallback_name</span> <span class="o">=</span> <span class="s1">&#39;t&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">leaf</span> <span class="o">=</span> <span class="n">Leaf</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">leaf</span><span class="o">.</span><span class="n">parent</span> <span class="ow">is</span> <span class="n">t</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">leaf</span><span class="o">.</span><span class="n">name</span>
<span class="go">&#39;.leaf&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">leaf</span><span class="o">.</span><span class="n">long_name</span>
<span class="go">&#39;t.leaf&#39;</span>
</pre></div>
</div>
<dl class="attribute">
<dt id="gptf.core.trees.Leaf.children">
<code class="descname">children</code><a class="headerlink" href="#gptf.core.trees.Leaf.children" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the children of this object at the time of calling.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">(tuple) The current children of the object.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gptf.core.trees.Leaf.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/trees.html#Leaf.copy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.trees.Leaf.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Shallowly copies self.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="n">Leaf</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">child</span> <span class="o">=</span> <span class="n">AttributeTree</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">child</span> <span class="ow">is</span> <span class="n">l</span><span class="o">.</span><span class="n">child</span>  <span class="c1"># attributes are not children</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="gptf.core.trees.ListTree">
<em class="property">class </em><code class="descclassname">gptf.core.trees.</code><code class="descname">ListTree</code><a class="reference internal" href="_modules/gptf/core/trees.html#ListTree"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.trees.ListTree" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gptf.core.trees.Tree" title="gptf.core.trees.Tree"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.trees.Tree</span></code></a>, <code class="xref py py-class docutils literal"><span class="pre">collections.abc.MutableSequence</span></code></p>
<p>A <code class="code docutils literal"><span class="pre">Tree</span></code> that uses numeric indexes to track its children.</p>
<p class="rubric">Examples</p>
<p><code class="code docutils literal"><span class="pre">ListTree</span></code>s know their parent and their name:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">root</span> <span class="o">=</span> <span class="n">AttributeTree</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">root</span><span class="o">.</span><span class="n">fallback_name</span> <span class="o">=</span> <span class="s2">&quot;root&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">root</span><span class="o">.</span><span class="n">list</span> <span class="o">=</span> <span class="n">ListTree</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">root</span><span class="o">.</span><span class="n">list</span><span class="o">.</span><span class="n">parent</span> <span class="ow">is</span> <span class="n">root</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">root</span><span class="o">.</span><span class="n">list</span><span class="o">.</span><span class="n">long_name</span><span class="p">)</span>
<span class="go">root.list</span>
</pre></div>
</div>
<p>Children can be assigned to the list through normal sequence
assignment:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">child</span> <span class="o">=</span> <span class="n">AttributeTree</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">root</span><span class="o">.</span><span class="n">list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">child</span> <span class="ow">in</span> <span class="n">root</span><span class="o">.</span><span class="n">list</span><span class="o">.</span><span class="n">children</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="o">.</span><span class="n">list</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
<p>Attempting to add a <code class="code docutils literal"><span class="pre">Tree</span></code> to the graph twice causes it to be
surreptitiously shallow-copied:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">child</span><span class="o">.</span><span class="n">some_attribute</span> <span class="o">=</span> <span class="nb">object</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">root</span><span class="o">.</span><span class="n">list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">root</span><span class="o">.</span><span class="n">list</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">root</span><span class="o">.</span><span class="n">list</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">is</span> <span class="n">child</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">root</span><span class="o">.</span><span class="n">list</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">some_attribute</span> <span class="ow">is</span> <span class="n">child</span><span class="o">.</span><span class="n">some_attribute</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Overwriting a child with itself does nothing:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">root</span><span class="o">.</span><span class="n">list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">child</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">root</span><span class="o">.</span><span class="n">list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="n">child</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The name of the child of a <code class="code docutils literal"><span class="pre">ListTree</span></code> is its index:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">child</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="go">[0]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">child</span><span class="o">.</span><span class="n">long_name</span><span class="p">)</span>
<span class="go">root.list[0]</span>
</pre></div>
</div>
<p>Assigning a child to another tree shallow-copies it to the other tree.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">AttributeTree</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">child</span> <span class="o">=</span> <span class="n">child</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">child</span> <span class="ow">is</span> <span class="n">child</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">child</span><span class="o">.</span><span class="n">some_attribute</span> <span class="ow">is</span> <span class="n">child</span><span class="o">.</span><span class="n">some_attribute</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">child</span><span class="o">.</span><span class="n">parent</span> <span class="ow">is</span> <span class="n">root</span><span class="o">.</span><span class="n">list</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Overwriting a child doesn&#8217;t cause a dangling parent:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">root</span><span class="o">.</span><span class="n">list</span> <span class="o">=</span> <span class="n">ListTree</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">child_a</span> <span class="o">=</span> <span class="n">AttributeTree</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">child_b</span> <span class="o">=</span> <span class="n">AttributeTree</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">root</span><span class="o">.</span><span class="n">list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">child_a</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">root</span><span class="o">.</span><span class="n">list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">child_b</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">child_a</span><span class="o">.</span><span class="n">parent</span> <span class="ow">is</span> <span class="kc">None</span>
<span class="go">True</span>
</pre></div>
</div>
<dl class="attribute">
<dt id="gptf.core.trees.ListTree.children">
<code class="descname">children</code><a class="headerlink" href="#gptf.core.trees.ListTree.children" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the children of this object at the time of calling.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">(tuple) The current children of the object.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gptf.core.trees.ListTree.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/trees.html#ListTree.copy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.trees.ListTree.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Shallowly copies the object but deeply copies children.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">ListTree</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="nb">object</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">child</span> <span class="o">=</span> <span class="n">AttributeTree</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">AttributeTree</span><span class="p">())</span>
</pre></div>
</div>
<p>Shallow copy returns an entirely new tree, but non-tree
attributes are shallowly copied (as references).</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">copy</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">copy</span> <span class="ow">is</span> <span class="n">t</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">copy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">copy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">parent</span> <span class="ow">is</span> <span class="n">copy</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">copy</span><span class="o">.</span><span class="n">a</span> <span class="ow">is</span> <span class="n">t</span><span class="o">.</span><span class="n">a</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">copy</span><span class="o">.</span><span class="n">child</span> <span class="ow">is</span> <span class="n">t</span><span class="o">.</span><span class="n">child</span>  <span class="c1"># attributes are not children</span>
<span class="go">True</span>
</pre></div>
</div>
<p>This behaviour is inherited correctly:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Example</span><span class="p">(</span><span class="n">ListTree</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">pass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="n">Example</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Example</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="nb">object</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">copy</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">copy</span><span class="p">,</span> <span class="n">Example</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">copy</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Example</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">copy</span> <span class="ow">is</span> <span class="n">e</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">copy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">copy</span><span class="o">.</span><span class="n">a</span> <span class="ow">is</span> <span class="n">e</span><span class="o">.</span><span class="n">a</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="gptf.core.trees.ListTree.insert">
<code class="descname">insert</code><span class="sig-paren">(</span><em>index</em>, <em>value</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/trees.html#ListTree.insert"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.trees.ListTree.insert" title="Permalink to this definition">¶</a></dt>
<dd><p>S.insert(index, value) &#8211; insert value before index</p>
</dd></dl>

<dl class="method">
<dt id="gptf.core.trees.ListTree.name_of">
<code class="descname">name_of</code><span class="sig-paren">(</span><em>child</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/trees.html#ListTree.name_of"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.trees.ListTree.name_of" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the name of <code class="code docutils literal"><span class="pre">value</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">A name by which <code class="code docutils literal"><span class="pre">value</span></code> can be accessed from <code class="code docutils literal"><span class="pre">self</span></code>. If
<code class="code docutils literal"><span class="pre">self</span></code> is accessible by some variable <code class="code docutils literal"><span class="pre">p</span></code>, then
<code class="code docutils literal"><span class="pre">eval(&quot;p&quot;</span> <span class="pre">+</span> <span class="pre">p.name_of(value))</span></code> must return <code class="code docutils literal"><span class="pre">value</span></code>, assuming
<code class="code docutils literal"><span class="pre">p.name_of()</span></code> doesn&#8217;t raise.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(str)</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><a class="reference internal" href="#gptf.core.trees.BadParentError" title="gptf.core.trees.BadParentError"><code class="xref py py-exc docutils literal"><span class="pre">BadParentError</span></code></a> &#8211; If <code class="code docutils literal"><span class="pre">value</span></code> is not a child of <code class="code docutils literal"><span class="pre">self</span></code>.</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Example</span><span class="p">(</span><span class="n">Tree</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">_children</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">add_child</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">child</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">_children</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">child</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span>
<span class="gp">... </span>    <span class="nd">@property</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">children</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_children</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="n">copy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__new__</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
<span class="gp">... </span>        <span class="n">copy</span><span class="o">.</span><span class="n">__dict__</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">... </span>        <span class="n">copy</span><span class="o">.</span><span class="n">_children</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_children</span><span class="p">]</span>
<span class="gp">... </span>        <span class="n">copy</span><span class="o">.</span><span class="n">_set_parent</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="n">copy</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">_unregister_child</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">child</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">if</span> <span class="n">child</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_children</span><span class="p">:</span>
<span class="gp">... </span>            <span class="bp">self</span><span class="o">.</span><span class="n">_children</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
<span class="gp">... </span>            <span class="n">child</span><span class="o">.</span><span class="n">_set_parent</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>            <span class="k">raise</span> <span class="n">BadParentError</span>
</pre></div>
</div>
<p>In the default implementation, this returns <code class="code docutils literal"><span class="pre">'.children[x]'</span></code>
where <code class="code docutils literal"><span class="pre">x</span></code> is <code class="code docutils literal"><span class="pre">self.children.index(value)</span></code>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">Example</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">Example</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">name_of</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="go">&#39;.children[0]&#39;</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="gptf.core.trees.Tree">
<em class="property">class </em><code class="descclassname">gptf.core.trees.</code><code class="descname">Tree</code><a class="reference internal" href="_modules/gptf/core/trees.html#Tree"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.trees.Tree" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">collections.abc.Iterable</span></code></p>
<p>Base class for trees.</p>
<dl class="attribute">
<dt id="gptf.core.trees.Tree.children">
<code class="descname">children</code><a class="headerlink" href="#gptf.core.trees.Tree.children" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the children of this object at the time of calling.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">(tuple) The current children of the object.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gptf.core.trees.Tree.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/trees.html#Tree.copy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.trees.Tree.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Shallow-copy <code class="code docutils literal"><span class="pre">self</span></code>, shallow-copying any <code class="code docutils literal"><span class="pre">Tree</span></code> children.</p>
</dd></dl>

<dl class="attribute">
<dt id="gptf.core.trees.Tree.highest_parent">
<code class="descname">highest_parent</code><a class="headerlink" href="#gptf.core.trees.Tree.highest_parent" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the highest parent in the tree.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Example</span><span class="p">(</span><span class="n">Tree</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">_children</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">add_child</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">child</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">_children</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">child</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span>
<span class="gp">... </span>    <span class="nd">@property</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">children</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_children</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="n">copy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__new__</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
<span class="gp">... </span>        <span class="n">copy</span><span class="o">.</span><span class="n">__dict__</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">... </span>        <span class="n">copy</span><span class="o">.</span><span class="n">_children</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_children</span><span class="p">]</span>
<span class="gp">... </span>        <span class="n">copy</span><span class="o">.</span><span class="n">_set_parent</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="n">copy</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">_unregister_child</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">child</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">if</span> <span class="n">child</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_children</span><span class="p">:</span>
<span class="gp">... </span>            <span class="bp">self</span><span class="o">.</span><span class="n">_children</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
<span class="gp">... </span>            <span class="n">child</span><span class="o">.</span><span class="n">_set_parent</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>            <span class="k">raise</span> <span class="n">BadParentError</span>
</pre></div>
</div>
<p>An object at the top of the tree is its own highest parent.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">Example</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">highest_parent</span> <span class="ow">is</span> <span class="n">p</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Objects lower down in the tree recurse up the tree to find their
highest parent.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span><span class="n">Example</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span><span class="n">Example</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">highest_parent</span> <span class="ow">is</span> <span class="n">p</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="gptf.core.trees.Tree.long_name">
<code class="descname">long_name</code><a class="headerlink" href="#gptf.core.trees.Tree.long_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the long name of <code class="code docutils literal"><span class="pre">self</span></code>.</p>
<p>The long name of an object is the concatenation of the names of its
parents, starting from the highest parent.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The full path to the object in the tree.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(str)</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Example</span><span class="p">(</span><span class="n">Tree</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">_children</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">add_child</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">child</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">_children</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">child</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span>
<span class="gp">... </span>    <span class="nd">@property</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">children</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_children</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="n">copy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__new__</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
<span class="gp">... </span>        <span class="n">copy</span><span class="o">.</span><span class="n">__dict__</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">... </span>        <span class="n">copy</span><span class="o">.</span><span class="n">_children</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_children</span><span class="p">]</span>
<span class="gp">... </span>        <span class="n">copy</span><span class="o">.</span><span class="n">_set_parent</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="n">copy</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">_unregister_child</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">child</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">if</span> <span class="n">child</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_children</span><span class="p">:</span>
<span class="gp">... </span>            <span class="bp">self</span><span class="o">.</span><span class="n">_children</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
<span class="gp">... </span>            <span class="n">child</span><span class="o">.</span><span class="n">_set_parent</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>            <span class="k">raise</span> <span class="n">BadParentError</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">Example</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">Example</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span><span class="n">Example</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">long_name</span><span class="p">)</span>  <span class="c1"># we are not in __main__</span>
<span class="go">unnamed.children[0].children[0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="gptf.core.trees.Tree.name">
<code class="descname">name</code><a class="headerlink" href="#gptf.core.trees.Tree.name" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the name by which this object&#8217;s parent refers to it.</p>
<p>If there is no parent, searches <code class="code docutils literal"><span class="pre">globals()</span></code> for a unique alias. If
a unique global alias cannot be found, returns <code class="code docutils literal"><span class="pre">self.fallback_name</span></code>.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Example</span><span class="p">(</span><span class="n">Tree</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">_children</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">add_child</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">child</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">_children</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">child</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span>
<span class="gp">... </span>    <span class="nd">@property</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">children</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_children</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="n">copy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__new__</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
<span class="gp">... </span>        <span class="n">copy</span><span class="o">.</span><span class="n">__dict__</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">... </span>        <span class="n">copy</span><span class="o">.</span><span class="n">_children</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_children</span><span class="p">]</span>
<span class="gp">... </span>        <span class="n">copy</span><span class="o">.</span><span class="n">_set_parent</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="n">copy</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">_unregister_child</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">child</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">if</span> <span class="n">child</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_children</span><span class="p">:</span>
<span class="gp">... </span>            <span class="bp">self</span><span class="o">.</span><span class="n">_children</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
<span class="gp">... </span>            <span class="n">child</span><span class="o">.</span><span class="n">_set_parent</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>            <span class="k">raise</span> <span class="n">BadParentError</span>
</pre></div>
</div>
<p>Objects at the top of the tree return their name in the global
namespace, if only one such name exists.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">Example</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># doctest does not run these tests in __main__, but if it</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># did, this would return true.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="ow">not</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span> <span class="ow">or</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;p&#39;</span>
<span class="go">True</span>
</pre></div>
</div>
<p>If no unique global aliases to the root exists, <code class="code docutils literal"><span class="pre">.fallback_name</span></code>
is returned.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">p</span>  <span class="c1"># now p has two global aliases, &#39;p&#39; and &#39;q&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">p</span><span class="o">.</span><span class="n">fallback_name</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Otherwise, an object&#8217;s name is the name its parent gives it,
as return by <code class="code docutils literal"><span class="pre">child.parent.name_of(child)</span></code>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">Example</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="go">.children[0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="gptf.core.trees.Tree.name_of">
<code class="descname">name_of</code><span class="sig-paren">(</span><em>value</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/trees.html#Tree.name_of"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.trees.Tree.name_of" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the name of <code class="code docutils literal"><span class="pre">value</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">A name by which <code class="code docutils literal"><span class="pre">value</span></code> can be accessed from <code class="code docutils literal"><span class="pre">self</span></code>. If
<code class="code docutils literal"><span class="pre">self</span></code> is accessible by some variable <code class="code docutils literal"><span class="pre">p</span></code>, then
<code class="code docutils literal"><span class="pre">eval(&quot;p&quot;</span> <span class="pre">+</span> <span class="pre">p.name_of(value))</span></code> must return <code class="code docutils literal"><span class="pre">value</span></code>, assuming
<code class="code docutils literal"><span class="pre">p.name_of()</span></code> doesn&#8217;t raise.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(str)</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><a class="reference internal" href="#gptf.core.trees.BadParentError" title="gptf.core.trees.BadParentError"><code class="xref py py-exc docutils literal"><span class="pre">BadParentError</span></code></a> &#8211; If <code class="code docutils literal"><span class="pre">value</span></code> is not a child of <code class="code docutils literal"><span class="pre">self</span></code>.</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Example</span><span class="p">(</span><span class="n">Tree</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">_children</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">add_child</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">child</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">_children</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">child</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span>
<span class="gp">... </span>    <span class="nd">@property</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">children</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_children</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="n">copy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__new__</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
<span class="gp">... </span>        <span class="n">copy</span><span class="o">.</span><span class="n">__dict__</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">... </span>        <span class="n">copy</span><span class="o">.</span><span class="n">_children</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_children</span><span class="p">]</span>
<span class="gp">... </span>        <span class="n">copy</span><span class="o">.</span><span class="n">_set_parent</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="n">copy</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">_unregister_child</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">child</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">if</span> <span class="n">child</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_children</span><span class="p">:</span>
<span class="gp">... </span>            <span class="bp">self</span><span class="o">.</span><span class="n">_children</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
<span class="gp">... </span>            <span class="n">child</span><span class="o">.</span><span class="n">_set_parent</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>            <span class="k">raise</span> <span class="n">BadParentError</span>
</pre></div>
</div>
<p>In the default implementation, this returns <code class="code docutils literal"><span class="pre">'.children[x]'</span></code>
where <code class="code docutils literal"><span class="pre">x</span></code> is <code class="code docutils literal"><span class="pre">self.children.index(value)</span></code>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">Example</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">Example</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">name_of</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="go">&#39;.children[0]&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="gptf.core.trees.Tree.parent">
<code class="descname">parent</code><a class="headerlink" href="#gptf.core.trees.Tree.parent" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the direct parent.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="gptf.core.trees.TreeWithCache">
<em class="property">class </em><code class="descclassname">gptf.core.trees.</code><code class="descname">TreeWithCache</code><a class="reference internal" href="_modules/gptf/core/trees.html#TreeWithCache"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.trees.TreeWithCache" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gptf.core.trees.Tree" title="gptf.core.trees.Tree"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.trees.Tree</span></code></a></p>
<p>A <code class="code docutils literal"><span class="pre">Tree</span></code> with caches at each node. Any node can empty every cache.</p>
<dl class="attribute">
<dt id="gptf.core.trees.TreeWithCache.cache">
<code class="descname">cache</code><a class="headerlink" href="#gptf.core.trees.TreeWithCache.cache" title="Permalink to this definition">¶</a></dt>
<dd><p><em>dict</em> &#8211; A cache to put things in.</p>
</dd></dl>

<dl class="method">
<dt id="gptf.core.trees.TreeWithCache.clear_ancestor_caches">
<code class="descname">clear_ancestor_caches</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/trees.html#TreeWithCache.clear_ancestor_caches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.trees.TreeWithCache.clear_ancestor_caches" title="Permalink to this definition">¶</a></dt>
<dd><p>Clears the caches of direct ancestors.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Example</span><span class="p">(</span><span class="n">AttributeTree</span><span class="p">,</span> <span class="n">TreeWithCache</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">pass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">Example</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">child_0</span> <span class="o">=</span> <span class="n">Example</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">child_1</span> <span class="o">=</span> <span class="n">Example</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">child_0</span><span class="o">.</span><span class="n">child</span> <span class="o">=</span> <span class="n">Example</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">fill_cache</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">t</span><span class="o">.</span><span class="n">cache</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;123&#39;</span>
<span class="gp">... </span>    <span class="n">t</span><span class="o">.</span><span class="n">child_0</span><span class="o">.</span><span class="n">cache</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;456&#39;</span>
<span class="gp">... </span>    <span class="n">t</span><span class="o">.</span><span class="n">child_1</span><span class="o">.</span><span class="n">cache</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;789&#39;</span>
<span class="gp">... </span>    <span class="n">t</span><span class="o">.</span><span class="n">child_0</span><span class="o">.</span><span class="n">child</span><span class="o">.</span><span class="n">cache</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;ABC&#39;</span>
</pre></div>
</div>
<p>Clearing <code class="code docutils literal"><span class="pre">t.child_0.child</span></code>&#8216;s ancestor&#8217;s cache clears
<code class="code docutils literal"><span class="pre">t</span></code>&#8216;s cache and <code class="code docutils literal"><span class="pre">t.child_0</span></code>&#8216;s cache, but not <code class="code docutils literal"><span class="pre">t.child_1</span></code>&#8216;s or
<code class="code docutils literal"><span class="pre">t.child_0.child</span></code>&#8216;s.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fill_cache</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">child_0</span><span class="o">.</span><span class="n">child</span><span class="o">.</span><span class="n">clear_ancestor_caches</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">cache</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gt">Traceback (most recent call last):</span>
    <span class="o">...</span>
<span class="gr">KeyError</span>: <span class="n">message</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">child_0</span><span class="o">.</span><span class="n">cache</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gt">Traceback (most recent call last):</span>
    <span class="o">...</span>
<span class="gr">KeyError</span>: <span class="n">message</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">child_1</span><span class="o">.</span><span class="n">cache</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">&#39;789&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">child_0</span><span class="o">.</span><span class="n">child</span><span class="o">.</span><span class="n">cache</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">&#39;ABC&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="gptf.core.trees.TreeWithCache.clear_cache">
<code class="descname">clear_cache</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/trees.html#TreeWithCache.clear_cache"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.trees.TreeWithCache.clear_cache" title="Permalink to this definition">¶</a></dt>
<dd><p>Clears this node&#8217;s cache.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Example</span><span class="p">(</span><span class="n">AttributeTree</span><span class="p">,</span> <span class="n">TreeWithCache</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">pass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">Example</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">cache</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gt">Traceback (most recent call last):</span>
    <span class="o">...</span>
<span class="gr">KeyError</span>: <span class="n">message</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">cache</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">123</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">cache</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">123</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">clear_cache</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">cache</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gt">Traceback (most recent call last):</span>
    <span class="o">..</span>
<span class="gr">KeyError</span>: <span class="n">message</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="gptf.core.trees.TreeWithCache.clear_subtree_caches">
<code class="descname">clear_subtree_caches</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/trees.html#TreeWithCache.clear_subtree_caches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.trees.TreeWithCache.clear_subtree_caches" title="Permalink to this definition">¶</a></dt>
<dd><p>Clears the cache of this node and every node lower than it.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Example</span><span class="p">(</span><span class="n">AttributeTree</span><span class="p">,</span> <span class="n">TreeWithCache</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">pass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">Example</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">child</span> <span class="o">=</span> <span class="n">Example</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">fill_cache</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">t</span><span class="o">.</span><span class="n">cache</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">123</span>
<span class="gp">... </span>    <span class="n">t</span><span class="o">.</span><span class="n">child</span><span class="o">.</span><span class="n">cache</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">456</span>
</pre></div>
</div>
<p>Clearing a parent&#8217;s cache clears its child&#8217;s cache:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fill_cache</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">clear_subtree_caches</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">cache</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gt">Traceback (most recent call last):</span>
    <span class="o">...</span>
<span class="gr">KeyError</span>: <span class="n">message</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">child</span><span class="o">.</span><span class="n">cache</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gt">Traceback (most recent call last):</span>
    <span class="o">...</span>
<span class="gr">KeyError</span>: <span class="n">message</span>
</pre></div>
</div>
<p>Clearing a child&#8217;s cache does not clear its parent&#8217;s cache:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fill_cache</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">child</span><span class="o">.</span><span class="n">clear_subtree_caches</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">cache</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">123</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">child</span><span class="o">.</span><span class="n">cache</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gt">Traceback (most recent call last):</span>
    <span class="o">...</span>
<span class="gr">KeyError</span>: <span class="n">message</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="gptf.core.trees.TreeWithCache.clear_tree_caches">
<code class="descname">clear_tree_caches</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/trees.html#TreeWithCache.clear_tree_caches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.trees.TreeWithCache.clear_tree_caches" title="Permalink to this definition">¶</a></dt>
<dd><p>Clears every cache in the tree.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Example</span><span class="p">(</span><span class="n">AttributeTree</span><span class="p">,</span> <span class="n">TreeWithCache</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">pass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">Example</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">child</span> <span class="o">=</span> <span class="n">Example</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">fill_cache</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">t</span><span class="o">.</span><span class="n">cache</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">123</span>
<span class="gp">... </span>    <span class="n">t</span><span class="o">.</span><span class="n">child</span><span class="o">.</span><span class="n">cache</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">456</span>
</pre></div>
</div>
<p>Clearing a parent&#8217;s cache clears its child&#8217;s cache:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fill_cache</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">clear_tree_caches</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">cache</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gt">Traceback (most recent call last):</span>
    <span class="o">...</span>
<span class="gr">KeyError</span>: <span class="n">message</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">child</span><span class="o">.</span><span class="n">cache</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gt">Traceback (most recent call last):</span>
    <span class="o">...</span>
<span class="gr">KeyError</span>: <span class="n">message</span>
</pre></div>
</div>
<p>Clearing a child&#8217;s cache clears its parent&#8217;s cache:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fill_cache</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">child</span><span class="o">.</span><span class="n">clear_tree_caches</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">cache</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gt">Traceback (most recent call last):</span>
    <span class="o">...</span>
<span class="gr">KeyError</span>: <span class="n">message</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">child</span><span class="o">.</span><span class="n">cache</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gt">Traceback (most recent call last):</span>
    <span class="o">...</span>
<span class="gr">KeyError</span>: <span class="n">message</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="gptf.core.trees.TreeWithCache.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/trees.html#TreeWithCache.copy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.trees.TreeWithCache.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Copies have empty caches.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="gptf.core.trees.cache_method">
<code class="descclassname">gptf.core.trees.</code><code class="descname">cache_method</code><span class="sig-paren">(</span><em>capacity=128</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/trees.html#cache_method"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.trees.cache_method" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds caching to a method of a <code class="code docutils literal"><span class="pre">TreeWithCache</span></code>.</p>
<p>Stores an <code class="code docutils literal"><span class="pre">LRUCache</span></code> which maps from method call arguments to
return values in the instance&#8217;s cache. This keeps the caches
of each instance seperate, and allows us to clear them using
<code class="code docutils literal"><span class="pre">instance.cache_clear()</span></code>.</p>
<p>Note: if the arguments are not hashable, we skip caching and
just return the value of the method.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>capacity</strong> (<em>int</em>) &#8211; The capacity of the cache. If the size of
the cache exceeds the capacity, the least recently used
(stored / retreived) arguments will be evicted.</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-gptf.core.utils">
<span id="gptf-core-utils-module"></span><h2>gptf.core.utils module<a class="headerlink" href="#module-gptf.core.utils" title="Permalink to this headline">¶</a></h2>
<p>Provides utility functions.</p>
<dl class="class">
<dt id="gptf.core.utils.LRUCache">
<em class="property">class </em><code class="descclassname">gptf.core.utils.</code><code class="descname">LRUCache</code><span class="sig-paren">(</span><em>capacity</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/utils.html#LRUCache"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.utils.LRUCache" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">collections.abc.MutableMapping</span></code></p>
<p>A least-recently-used cache.</p>
<p>Implementation stolen from <a class="reference external" href="https://www.kunxi.org/blog/2014/05/lru-cache-in-python/">this article</a>.</p>
</dd></dl>

<dl class="function">
<dt id="gptf.core.utils.combine_fancy_tables">
<code class="descclassname">gptf.core.utils.</code><code class="descname">combine_fancy_tables</code><span class="sig-paren">(</span><em>*tables</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/utils.html#combine_fancy_tables"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.utils.combine_fancy_tables" title="Permalink to this definition">¶</a></dt>
<dd><p>Combines fancy tables into one mighty table.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>*tables</strong> (<em>Tuple[str]</em>) &#8211; The fancy tables to combine. Within each table,
all lines should be the same length.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A single fancy table, formed by concatenating the provided
tables.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">(str)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gptf.core.utils.construct_table">
<code class="descclassname">gptf.core.utils.</code><code class="descname">construct_table</code><span class="sig-paren">(</span><em>cols</em>, <em>headings</em>, <em>fmt</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/utils.html#construct_table"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.utils.construct_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs a table from the given columns and rows for display.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cols</strong> (<em>Iterable[Iterable[str]]</em>) &#8211; The columns of the table.
The columns should be of the same length.</li>
<li><strong>headings</strong> (<em>Iterable[str]</em>) &#8211; The headings for the columns.
<code class="code docutils literal"><span class="pre">len(headings)</span></code> should be the same as <code class="code docutils literal"><span class="pre">len(cols)</span></code>.</li>
<li><strong>fmt</strong> (<em>'fancy' | 'plain' | 'html'</em>) &#8211; The format for the table.
<code class="code docutils literal"><span class="pre">'fancy'</span></code> returns a table with fancy formatting using box
drawing characters.
<code class="code docutils literal"><span class="pre">'plain'</span></code> returns a table using only ascii characters.
<code class="code docutils literal"><span class="pre">'html'</span></code> returns an html table.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A string containing a table.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(str)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gptf.core.utils.flip">
<code class="descclassname">gptf.core.utils.</code><code class="descname">flip</code><span class="sig-paren">(</span><em>func</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/utils.html#flip"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.utils.flip" title="Permalink to this definition">¶</a></dt>
<dd><p>Reverses the arguments of <code class="code docutils literal"><span class="pre">func</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>func</strong> (<em>Callable[[A0, A1, ..., AN], B]</em>) &#8211; A function.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><code class="code docutils literal"><span class="pre">func</span></code>, with the order of
arguments reversed.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">(Callable[[AN, AN-1, ..., A1, A0], B])</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gptf.core.utils.is_array_like">
<code class="descclassname">gptf.core.utils.</code><code class="descname">is_array_like</code><span class="sig-paren">(</span><em>obj</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/utils.html#is_array_like"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.utils.is_array_like" title="Permalink to this definition">¶</a></dt>
<dd><p>Tests if an object is array_like.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">True if <code class="code docutils literal"><span class="pre">obj</span></code> is a number, a string, a numpy array or a
sequence.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(bool)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gptf.core.utils.isattrof">
<code class="descclassname">gptf.core.utils.</code><code class="descname">isattrof</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/utils.html#isattrof"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.utils.isattrof" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a partial application of hasattr.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>name</strong> &#8211; The name of the attribute to check for.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A function <code class="code docutils literal"><span class="pre">f(obj)</span></code> that returns
<code class="code docutils literal"><span class="pre">hasattr(object,</span> <span class="pre">name)</span></code></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">(Callable[[object], bool])</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gptf.core.utils.isclassof">
<code class="descclassname">gptf.core.utils.</code><code class="descname">isclassof</code><span class="sig-paren">(</span><em>classinfo</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/utils.html#isclassof"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.utils.isclassof" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a partial application of isinstance.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>classinfo</strong> &#8211; The classinfo argument for isinstance.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A function <code class="code docutils literal"><span class="pre">f(obj)</span></code> that returns
<code class="code docutils literal"><span class="pre">isinstance(object,</span> <span class="pre">classinfo)</span></code></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">(Callable[[object], bool])</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gptf.core.utils.prefix_lines">
<code class="descclassname">gptf.core.utils.</code><code class="descname">prefix_lines</code><span class="sig-paren">(</span><em>prefix</em>, <em>string</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/utils.html#prefix_lines"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.utils.prefix_lines" title="Permalink to this definition">¶</a></dt>
<dd><p>Prefixes each line in <code class="code docutils literal"><span class="pre">string</span></code> with <code class="code docutils literal"><span class="pre">prefix</span></code>.</p>
</dd></dl>

<dl class="function">
<dt id="gptf.core.utils.strip_ansi_escape_codes">
<code class="descclassname">gptf.core.utils.</code><code class="descname">strip_ansi_escape_codes</code><span class="sig-paren">(</span><em>string</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/utils.html#strip_ansi_escape_codes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.utils.strip_ansi_escape_codes" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="gptf.core.utils.unique">
<code class="descclassname">gptf.core.utils.</code><code class="descname">unique</code><span class="sig-paren">(</span><em>seq</em>, <em>id_fun=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/utils.html#unique"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.utils.unique" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets all the unique items in a list.</p>
</dd></dl>

</div>
<div class="section" id="module-gptf.core.wrappedtf">
<span id="gptf-core-wrappedtf-module"></span><h2>gptf.core.wrappedtf module<a class="headerlink" href="#module-gptf.core.wrappedtf" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="gptf.core.wrappedtf.NullContextWrapper">
<em class="property">class </em><code class="descclassname">gptf.core.wrappedtf.</code><code class="descname">NullContextWrapper</code><span class="sig-paren">(</span><em>wrapped</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/wrappedtf.html#NullContextWrapper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.wrappedtf.NullContextWrapper" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Wraps an object so that its context does nothing.</p>
<dl class="attribute">
<dt id="gptf.core.wrappedtf.NullContextWrapper._NullContextWrapped__wrapped">
<code class="descname">_NullContextWrapped__wrapped</code><a class="headerlink" href="#gptf.core.wrappedtf.NullContextWrapper._NullContextWrapped__wrapped" title="Permalink to this definition">¶</a></dt>
<dd><p>the wrapped context manager.</p>
</dd></dl>

<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Example</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;enter called&quot;</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="bp">self</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span><span class="p">):</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;exit called&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Wrapping a context manager causes it to do nothing.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="n">Example</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">e</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;with body&quot;</span><span class="p">)</span>
<span class="go">enter called</span>
<span class="go">with body</span>
<span class="go">exit called</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">NullContextWrapper</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="k">as</span> <span class="n">e_</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">assert</span> <span class="n">e</span> <span class="ow">is</span> <span class="n">e_</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;with body&quot;</span><span class="p">)</span>
<span class="go">with body</span>
</pre></div>
</div>
<p>You can access other attributes of the context manager
through the wrapper.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="o">.</span><span class="n">attribute</span> <span class="o">=</span> <span class="s2">&quot;horse&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">NullContextWrapper</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="o">.</span><span class="n">attribute</span>
<span class="go">&#39;horse&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="gptf.core.wrappedtf.WrappedTF">
<em class="property">class </em><code class="descclassname">gptf.core.wrappedtf.</code><code class="descname">WrappedTF</code><a class="reference internal" href="_modules/gptf/core/wrappedtf.html#WrappedTF"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.wrappedtf.WrappedTF" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#gptf.core.trees.TreeWithCache" title="gptf.core.trees.TreeWithCache"><code class="xref py py-class docutils literal"><span class="pre">gptf.core.trees.TreeWithCache</span></code></a></p>
<p>Provides facilities for keeping TensorFlow behind the scenes.</p>
<p>WARNING: <code class="code docutils literal"><span class="pre">WrappedTF</span></code> assumes that its parent, and indeed all things
higher than it in the tree, are also <code class="code docutils literal"><span class="pre">WrappedTF</span></code>. Make sure that the
root of the tree has implemented <code class="code docutils literal"><span class="pre">.get_session()</span></code>, and that
the direct parent has implemented <code class="code docutils literal"><span class="pre">.op_placement_context()</span></code>.</p>
<dl class="attribute">
<dt id="gptf.core.wrappedtf.WrappedTF.NO_DEVICE">
<code class="descname">NO_DEVICE</code><a class="headerlink" href="#gptf.core.wrappedtf.WrappedTF.NO_DEVICE" title="Permalink to this definition">¶</a></dt>
<dd><p><em>object</em> &#8211; A class-level constant, used to specify an
empty op placement context.</p>
</dd></dl>

<dl class="attribute">
<dt id="gptf.core.wrappedtf.WrappedTF.tf_device">
<code class="descname">tf_device</code><a class="headerlink" href="#gptf.core.wrappedtf.WrappedTF.tf_device" title="Permalink to this definition">¶</a></dt>
<dd><p><em>str | Callable[[tf.Operation], str] | tf.DeviceSpec | WrappedTF.NO_DEVICE | None</em> &#8211; The device context onto which this object&#8217;s ops should be pinned.
Device contexts are applied hierarchically, starting from the
highest parent. See <code class="code docutils literal"><span class="pre">.op_placement_context()</span></code>.</p>
<p>This will be passed as the sole argument to <code class="code docutils literal"><span class="pre">tf.device()</span></code>.
<code class="code docutils literal"><span class="pre">WrappedTF.NO_DEVICE</span></code> indicates that <code class="code docutils literal"><span class="pre">None</span></code> will be
passed to <code class="code docutils literal"><span class="pre">tf.device</span></code>, whereas <code class="code docutils literal"><span class="pre">None</span></code> indicates that <code class="code docutils literal"><span class="pre">tf.device()</span></code>
will not be called. Otherwise, see the documentation for
<code class="code docutils literal"><span class="pre">tf.device()</span></code>.</p>
<p>Defaults to <code class="code docutils literal"><span class="pre">None</span></code>.</p>
</dd></dl>

<dl class="attribute">
<dt id="gptf.core.wrappedtf.WrappedTF.tf_graph">
<code class="descname">tf_graph</code><a class="headerlink" href="#gptf.core.wrappedtf.WrappedTF.tf_graph" title="Permalink to this definition">¶</a></dt>
<dd><p><em>tf.Graph | None</em> &#8211; The graph to place ops in. If <code class="code docutils literal"><span class="pre">None</span></code>,
the graph an op is placed in is the lowest defined <code class="code docutils literal"><span class="pre">.tf_graph</span></code>
above this one in the tree. If all objects in the <code class="code docutils literal"><span class="pre">Tree</span></code> have
<code class="code docutils literal"><span class="pre">.tf_graph</span></code> set to <code class="code docutils literal"><span class="pre">None</span></code>, the default graph is used.
Defaults to <code class="code docutils literal"><span class="pre">None</span></code>.</p>
</dd></dl>

<dl class="attribute">
<dt id="gptf.core.wrappedtf.WrappedTF.tf_session_target">
<code class="descname">tf_session_target</code><a class="headerlink" href="#gptf.core.wrappedtf.WrappedTF.tf_session_target" title="Permalink to this definition">¶</a></dt>
<dd><p><em>str | dict | None</em> &#8211; The target under which
sessions should run. If this is <code class="code docutils literal"><span class="pre">None</span></code>, no arguments will be
passed to <code class="code docutils literal"><span class="pre">tf.session()</span></code>. If this is a dictionary, then its
contents will be used as keyword arguments for <code class="code docutils literal"><span class="pre">tf.session()</span></code>.
Else, this will be the sole argument for
<code class="code docutils literal"><span class="pre">tf.session()</span></code>. See <code class="code docutils literal"><span class="pre">.get_session()</span></code>.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">NO_DEVICE</code></dt>
<dd><p>When <code class="code docutils literal"><span class="pre">.tf_device</span></code> is set to <code class="code docutils literal"><span class="pre">.NO_DEVICE</span></code>, <code class="code docutils literal"><span class="pre">None</span></code> will be passed
to <code class="code docutils literal"><span class="pre">tf.device()</span></code></p>
</dd></dl>

<dl class="method">
<dt id="gptf.core.wrappedtf.WrappedTF.get_session">
<code class="descname">get_session</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/wrappedtf.html#WrappedTF.get_session"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.wrappedtf.WrappedTF.get_session" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets a TensorFlow session in which ops can be run.</p>
<p>Returns the default session if there is one. Else, returns a
new session using the session target of the highest parent.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The default session if there is one, else a
session matching the session target of the highest parent.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">(tf.Session)</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">gptf.core.trees</span> <span class="k">import</span> <span class="n">AttributeTree</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">AttributeWrappedTF</span><span class="p">(</span><span class="n">WrappedTF</span><span class="p">,</span> <span class="n">AttributeTree</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">pass</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">w</span> <span class="o">=</span> <span class="n">AttributeWrappedTF</span><span class="p">()</span>
</pre></div>
</div>
<p>If there is already a default session, returns that
session in a NullContextWrapper.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">tf</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span> <span class="k">as</span> <span class="n">sess</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">sess0</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">get_session</span><span class="p">()</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">sess0</span><span class="p">)</span><span class="o">.</span><span class="n">__name__</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">sess0</span><span class="o">.</span><span class="n">_NullContextWrapper__wrapped</span> <span class="ow">is</span> <span class="n">sess</span>
<span class="go">NullContextWrapper</span>
<span class="go">True</span>
</pre></div>
</div>
<p>It&#8217;s safe to use w.get_session() in a with block, even if
there is a default session. Doing so won&#8217;t call the
<code class="code docutils literal"><span class="pre">__enter__</span></code> or <code class="code docutils literal"><span class="pre">__exit__</span></code> methods of the default session.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">AnnounceSession</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">Session</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;__enter__ called&#39;</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__enter__</span><span class="p">()</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;__exit__ called&#39;</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__exit__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">AnnounceSession</span><span class="p">()</span> <span class="k">as</span> <span class="n">sess</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;before nested with&#39;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">with</span> <span class="n">w</span><span class="o">.</span><span class="n">get_session</span><span class="p">()</span> <span class="k">as</span> <span class="n">sess0</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">assert</span> <span class="n">sess</span> <span class="ow">is</span> <span class="n">sess0</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;nested with&#39;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;after nested with&#39;</span><span class="p">)</span>
<span class="go">__enter__ called</span>
<span class="go">before nested with</span>
<span class="go">nested with</span>
<span class="go">after nested with</span>
<span class="go">__exit__ called</span>
</pre></div>
</div>
<p>Else, returns a new session each time:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sess2</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">get_session</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sess2</span> <span class="ow">is</span> <span class="n">sess</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sess3</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">get_session</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sess2</span> <span class="ow">is</span> <span class="n">sess3</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sess2</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sess3</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Example</span><span class="p">(</span><span class="n">WrappedTF</span><span class="p">,</span> <span class="n">AttributeTree</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">op</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">op_placement_context</span><span class="p">():</span>
<span class="gp">... </span>            <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">depth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="n">tot</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">... </span>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="gp">... </span>            <span class="n">tot</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span>
<span class="gp">... </span>        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_session</span><span class="p">()</span> <span class="k">as</span> <span class="n">sess</span><span class="p">:</span>
<span class="gp">... </span>            <span class="n">tot</span> <span class="o">+=</span> <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">op</span><span class="p">())</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="n">tot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">Example</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># we&#39;re about to do weird things with op placement, and we</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># don&#39;t want it in the default graph where it can mess with</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># other doctests.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">tf_graph</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Graph</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">child</span> <span class="o">=</span> <span class="n">Example</span><span class="p">()</span>
</pre></div>
</div>
<p><code class="code docutils literal"><span class="pre">Example</span></code> is a simple class that provides a method, <code class="code docutils literal"><span class="pre">.depth()</span></code>,
that uses TensorFlow to calculate an object&#8217;s depth in the tree.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">child</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
<p><code class="code docutils literal"><span class="pre">Example.op()</span></code> places its op based on the hierachical device
context. If we change <code class="code docutils literal"><span class="pre">a</span></code>&#8216;s device context, we also change
<code class="code docutils literal"><span class="pre">a.child</span></code>&#8216;s.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">child</span><span class="o">.</span><span class="n">op</span><span class="p">()</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">tf_device</span> <span class="o">=</span> <span class="s1">&#39;/job:worker/task:0&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">child</span><span class="o">.</span><span class="n">op</span><span class="p">()</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
<span class="go">/job:worker/task:0</span>
</pre></div>
</div>
<p><code class="code docutils literal"><span class="pre">a.child.depth()</span></code> will now result in an error:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">child</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
    <span class="o">...</span>
<span class="gr">tensorflow.python.framework.errors.InvalidArgumentError</span>: <span class="n">...</span>
</pre></div>
</div>
<p><code class="code docutils literal"><span class="pre">a.child.op()</span></code> is now being placed as if it were in a distributed
context, and the default session knows nothing about jobs or tasks.
However, if we set <code class="code docutils literal"><span class="pre">a.session_target</span></code> appropriately,
<code class="code docutils literal"><span class="pre">a.child.get_session()</span></code> will return a session capable of
running ops created with <code class="code docutils literal"><span class="pre">a.child.op_placement_context</span></code>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">clusterdict</span> <span class="o">=</span> \
<span class="gp">... </span>    <span class="p">{</span> <span class="s1">&#39;worker&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;localhost:2222&#39;</span><span class="p">]</span>
<span class="gp">... </span>    <span class="p">,</span> <span class="s1">&#39;master&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;localhost:2223&#39;</span><span class="p">]</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spec</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">ClusterSpec</span><span class="p">(</span><span class="n">clusterdict</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">worker</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">Server</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="n">job_name</span><span class="o">=</span><span class="s1">&#39;worker&#39;</span><span class="p">,</span> <span class="n">task_index</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">worker</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">master</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">Server</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="n">job_name</span><span class="o">=</span><span class="s1">&#39;master&#39;</span><span class="p">,</span> <span class="n">task_index</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">tf_session_target</span> <span class="o">=</span> <span class="n">master</span><span class="o">.</span><span class="n">target</span>
</pre></div>
</div>
<p><code class="code docutils literal"><span class="pre">a.child.depth()</span></code> should now run smoothly.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">child</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
<p>In general, this means that as long as the session target of
the root is set correctly, anything lower in the tree that uses
<code class="code docutils literal"><span class="pre">self.get_session()</span></code> should work without fuss.</p>
</dd></dl>

<dl class="method">
<dt id="gptf.core.wrappedtf.WrappedTF.on_session_birth">
<code class="descname">on_session_birth</code><span class="sig-paren">(</span><em>session</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/wrappedtf.html#WrappedTF.on_session_birth"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.wrappedtf.WrappedTF.on_session_birth" title="Permalink to this definition">¶</a></dt>
<dd><p>Called just after a session is created.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>session</strong> (<em>tf.Session</em>) &#8211; The created session.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gptf.core.wrappedtf.WrappedTF.on_session_death">
<code class="descname">on_session_death</code><span class="sig-paren">(</span><em>session</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/wrappedtf.html#WrappedTF.on_session_death"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.wrappedtf.WrappedTF.on_session_death" title="Permalink to this definition">¶</a></dt>
<dd><p>Called just before a session is closed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>session</strong> (<em>tf.Session</em>) &#8211; The dying session.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="gptf.core.wrappedtf.WrappedTF.op_placement_context">
<code class="descname">op_placement_context</code><span class="sig-paren">(</span><em>name_scope=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/wrappedtf.html#WrappedTF.op_placement_context"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.wrappedtf.WrappedTF.op_placement_context" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies op placement rules based on the object hierarchy.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">gptf.core.trees</span> <span class="k">import</span> <span class="n">AttributeTree</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Example</span><span class="p">(</span><span class="n">WrappedTF</span><span class="p">,</span> <span class="n">AttributeTree</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">tf_graph</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Graph</span><span class="p">()</span>
</pre></div>
</div>
<p>Choose the op placement context by assigning to <code class="code docutils literal"><span class="pre">.tf_device</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="p">[</span><span class="n">Example</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">tf_device</span> <span class="o">=</span> <span class="s1">&#39;/job:worker&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">.</span><span class="n">tf_device</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">DeviceSpec</span><span class="p">(</span><span class="n">device_type</span><span class="o">=</span><span class="s1">&#39;GPU&#39;</span><span class="p">,</span> <span class="n">device_index</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">tf_device</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">tf_device</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">NO_DEVICE</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="o">.</span><span class="n">tf_device</span> <span class="o">=</span> <span class="s1">&#39;/job:spoon&#39;</span>
</pre></div>
</div>
<p>Device contexts are combined, starting from the context of the
root of the tree. <code class="code docutils literal"><span class="pre">c.tf_device</span></code> is <code class="code docutils literal"><span class="pre">None</span></code>, so it uses the context
of its parent.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">child</span> <span class="o">=</span> <span class="n">c</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">a</span><span class="o">.</span><span class="n">op_placement_context</span><span class="p">():</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
<span class="go">/job:worker</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">c</span><span class="o">.</span><span class="n">op_placement_context</span><span class="p">():</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
<span class="go">/job:worker</span>
</pre></div>
</div>
<p><code class="code docutils literal"><span class="pre">d.tf_device</span></code> is <code class="code docutils literal"><span class="pre">WrappedTF.NO_DEVICE</span></code>, so it resets the device
context.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">child</span> <span class="o">=</span> <span class="n">d</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">d</span><span class="o">.</span><span class="n">op_placement_context</span><span class="p">():</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
</pre></div>
</div>
<p>Other device contexts combine the way you would expect them to.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">child</span> <span class="o">=</span> <span class="n">b</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">.</span><span class="n">child</span> <span class="o">=</span> <span class="n">e</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">b</span><span class="o">.</span><span class="n">op_placement_context</span><span class="p">():</span>
<span class="gp">... </span>    <span class="c1"># get job from a</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
<span class="go">/job:worker/device:GPU:0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">e</span><span class="o">.</span><span class="n">op_placement_context</span><span class="p">():</span>
<span class="gp">... </span>    <span class="c1"># get device from b, overwrite job from a</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
<span class="go">/job:spoon/device:GPU:0</span>
</pre></div>
</div>
<p>The root node of the tree may define a <code class="code docutils literal"><span class="pre">.tf_graph</span></code>. Child ops will
be placed in the <code class="code docutils literal"><span class="pre">.tf_graph</span></code> of their highest parent.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">tf_graph</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Graph</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">.</span><span class="n">tf_graph</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Graph</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">a</span><span class="o">.</span><span class="n">op_placement_context</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">graph</span> <span class="ow">is</span> <span class="n">a</span><span class="o">.</span><span class="n">tf_graph</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">b</span><span class="o">.</span><span class="n">op_placement_context</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">graph</span> <span class="ow">is</span> <span class="n">a</span><span class="o">.</span><span class="n">tf_graph</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">e</span><span class="o">.</span><span class="n">op_placement_context</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">graph</span> <span class="ow">is</span> <span class="n">a</span><span class="o">.</span><span class="n">tf_graph</span>
<span class="go">True</span>
</pre></div>
</div>
<p>In addition, a name scope is opened that matches the object
hierachy:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">a</span><span class="o">.</span><span class="n">op_placement_context</span><span class="p">():</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="go">unnamed/Const...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">b</span><span class="o">.</span><span class="n">op_placement_context</span><span class="p">():</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="go">unnamed.child/Const...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">e</span><span class="o">.</span><span class="n">op_placement_context</span><span class="p">():</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="go">unnamed.child.child/Const...</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">tf_device</code></dt>
<dd><p>The device context onto which this object&#8217;s ops should be pinned.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">tf_graph</code></dt>
<dd><p>The graph to place ops in.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">tf_session_target</code></dt>
<dd><p>The target under which sessions should be run.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="gptf.core.wrappedtf.WrappedTFSession">
<em class="property">class </em><code class="descclassname">gptf.core.wrappedtf.</code><code class="descname">WrappedTFSession</code><span class="sig-paren">(</span><em>target=''</em>, <em>graph=None</em>, <em>config=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/wrappedtf.html#WrappedTFSession"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.wrappedtf.WrappedTFSession" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">tensorflow.python.client.session.Session</span></code></p>
<dl class="method">
<dt id="gptf.core.wrappedtf.WrappedTFSession.close">
<code class="descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#gptf.core.wrappedtf.WrappedTFSession.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Closes this session.</p>
<p>Calling this method frees all resources associated with the session.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><code class="xref py py-exc docutils literal"><span class="pre">tf.errors.OpError</span></code> &#8211; Or one of its subclasses if an error occurs while
closing the TensorFlow session.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="gptf.core.wrappedtf.tf_method">
<code class="descclassname">gptf.core.wrappedtf.</code><code class="descname">tf_method</code><span class="sig-paren">(</span><em>name_scope=True</em>, <em>rename_output=True</em>, <em>cache=True</em>, <em>cache_limit=128</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gptf/core/wrappedtf.html#tf_method"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#gptf.core.wrappedtf.tf_method" title="Permalink to this definition">¶</a></dt>
<dd><p>Decorator version of <code class="code docutils literal"><span class="pre">WrappedTF.op_placement_context</span></code>.</p>
<p>Applies <code class="code docutils literal"><span class="pre">instance.op_placement_context(name_scope=False)</span></code>
to <code class="code docutils literal"><span class="pre">instance.method(...)</span></code></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>name_scope</strong> (<em>bool</em>) &#8211; If <code class="code docutils literal"><span class="pre">True</span></code>, wraps the function in an
appropriate <code class="code docutils literal"><span class="pre">tf.name_scope()</span></code>.</li>
<li><strong>cache</strong> (<em>bool</em>) &#8211; If <code class="code docutils literal"><span class="pre">True</span></code>, applies caching to the function.
Multiple calls with the same arguments will return
the same result. See examples.</li>
<li><strong>cache_limit</strong> (<em>int</em>) &#8211; The limit for the cache.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>In the following example, <code class="code docutils literal"><span class="pre">Example.method_a</span></code> is equivalent
to <code class="code docutils literal"><span class="pre">Example.method_b</span></code>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">gptf.core.trees</span> <span class="k">import</span> <span class="n">AttributeTree</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Example</span><span class="p">(</span><span class="n">WrappedTF</span><span class="p">,</span> <span class="n">AttributeTree</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">method_a</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">op_placement_context</span><span class="p">(</span><span class="n">name_scope</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="gp">... </span>            <span class="n">scope</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">long_name</span> <span class="o">+</span> <span class="s1">&#39;.method_a/&#39;</span>
<span class="gp">... </span>            <span class="k">with</span> <span class="n">tf</span><span class="o">.</span><span class="n">name_scope</span><span class="p">(</span><span class="n">scope</span><span class="p">):</span>
<span class="gp">... </span>                <span class="n">result</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="gp">... </span>                <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>  <span class="c1">#scope[:-1])</span>
<span class="gp">... </span>    <span class="nd">@tf_method</span><span class="p">()</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">method_b</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
<p>Devices are set properly in both methods:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="n">Example</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="o">.</span><span class="n">tf_graph</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Graph</span><span class="p">()</span>  <span class="c1"># don&#39;t break other doctests</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="o">.</span><span class="n">tf_device</span> <span class="o">=</span> <span class="s1">&#39;/job:worker/task:0&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">method_a</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
<span class="go">/job:worker/task:0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">method_b</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">.</span><span class="n">device</span> <span class="o">==</span> <span class="n">a</span><span class="o">.</span><span class="n">device</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The returned tensor(s) are given the name of the name scope.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="go">unnamed.method_a/0:0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="go">unnamed.method_b/0:0</span>
</pre></div>
</div>
<p>Multiple method calls produce unique names.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">method_b</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="go">unnamed.method_b/0_1:0</span>
</pre></div>
</div>
<p>If a method returns a sequence of tensors, they are named
<code class="code docutils literal"><span class="pre">&lt;scope&gt;/0</span></code>, <code class="code docutils literal"><span class="pre">&lt;scope&gt;/1</span></code>, etc.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">DoubleReturnExample</span><span class="p">(</span><span class="n">WrappedTF</span><span class="p">,</span> <span class="n">AttributeTree</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nd">@tf_method</span><span class="p">(</span><span class="n">cache</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">method</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obj</span> <span class="o">=</span> <span class="n">DoubleReturnExample</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">method</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="go">unnamed.method/0:0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="go">unnamed.method/1:0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">method</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="go">unnamed.method/0_1:0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="go">unnamed.method/1_1:0</span>
</pre></div>
</div>
<p>Calls to other tensorflow methods do not cause nested name scopes.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">NestedExample</span><span class="p">(</span><span class="n">WrappedTF</span><span class="p">,</span> <span class="n">AttributeTree</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">child</span><span class="p">):</span>
<span class="gp">... </span>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">child</span> <span class="o">=</span> <span class="n">child</span>
<span class="gp">... </span>    <span class="nd">@tf_method</span><span class="p">()</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<span class="gp">... </span>        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">child</span><span class="o">.</span><span class="n">method_b</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">NestedExample</span><span class="p">(</span><span class="n">Example</span><span class="p">())</span><span class="o">.</span><span class="n">method</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">unnamed.child.method_b/0:0</span>
</pre></div>
</div>
<p>Else, no attempt is made to rename the output.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">NumpyReturnExample</span><span class="p">(</span><span class="n">WrappedTF</span><span class="p">,</span> <span class="n">AttributeTree</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nd">@tf_method</span><span class="p">()</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">method</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_session</span><span class="p">()</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">NumpyReturnExample</span><span class="p">()</span><span class="o">.</span><span class="n">method</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
<p>If caching is enabled, then multiple calls with the same
arguments will result in the same return value.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tensor</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">method_b</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tensor</span> <span class="ow">is</span> <span class="n">e</span><span class="o">.</span><span class="n">method_b</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>This means that ops are not added to the graph multiple times
for identical method calls, which is a good thing.</p>
<p>If the cache is cleared (perhaps due to a device context
change), the method cache is also cleared, and new tensors
will be returned.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">e</span><span class="o">.</span><span class="n">clear_cache</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tensor</span> <span class="ow">is</span> <span class="n">e</span><span class="o">.</span><span class="n">method_b</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-gptf.core">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-gptf.core" title="Permalink to this headline">¶</a></h2>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">gptf.core package</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-gptf.core.densities">gptf.core.densities module</a></li>
<li><a class="reference internal" href="#module-gptf.core.kernels">gptf.core.kernels module</a></li>
<li><a class="reference internal" href="#module-gptf.core.likelihoods">gptf.core.likelihoods module</a></li>
<li><a class="reference internal" href="#module-gptf.core.meanfunctions">gptf.core.meanfunctions module</a></li>
<li><a class="reference internal" href="#module-gptf.core.models">gptf.core.models module</a></li>
<li><a class="reference internal" href="#module-gptf.core.params">gptf.core.params module</a></li>
<li><a class="reference internal" href="#module-gptf.core.tfhacks">gptf.core.tfhacks module</a></li>
<li><a class="reference internal" href="#module-gptf.core.transforms">gptf.core.transforms module</a></li>
<li><a class="reference internal" href="#module-gptf.core.trees">gptf.core.trees module</a></li>
<li><a class="reference internal" href="#module-gptf.core.utils">gptf.core.utils module</a></li>
<li><a class="reference internal" href="#module-gptf.core.wrappedtf">gptf.core.wrappedtf module</a></li>
<li><a class="reference internal" href="#module-gptf.core">Module contents</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/gptf.core.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2016, Blaine Rogers.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.4.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.9</a>
      
      |
      <a href="_sources/gptf.core.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>